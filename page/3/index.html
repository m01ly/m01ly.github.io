<!DOCTYPE html><html lang="zh-Hans"><head><!--[if IE]><style>body{display:none;}</style><script>alert('IE浏览器下无法展示效果，请更换浏览器！');var headNode=document.getElementsByTagName('head')[0];var refresh=document.createElement('meta');refresh.setAttribute('http-equiv','Refresh');refresh.setAttribute('Content','0; url=http://outdatedbrowser.com/');headNode.appendChild(refresh);</script><![endif]--><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="author" content="m01ly"><meta name="baidu-site-verification" content="yvSXOjM1ag"><meta name="google-site-verification" content="riwnp5QCq6dRKbhBa3d3aDZrfGLQVhMFN9d4fMGYuoU"><meta name="description" content="description123456"><meta property="og:type" content="website"><meta property="og:title" content="Hexo"><meta property="og:url" content="https://m01ly.github.io/page/3/index.html"><meta property="og:site_name" content="Hexo"><meta property="og:description" content="description123456"><meta property="og:locale"><meta property="article:author" content="m01ly"><meta property="article:tag" content="description123456"><meta name="twitter:card" content="summary"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="shortcut icon" href="/favicon.ico"><link href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css" rel="stylesheet"><link rel="stylesheet" href="/css/style.css"><title>Hexo</title><script src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"><script src="//cdn.bootcss.com/aos/2.2.0/aos.js"></script><script>var yiliaConfig={fancybox:!0,isHome:!0,isPost:!1,isArchive:!1,isTag:!1,isCategory:!1,fancybox_js:"//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js",search:!0}</script><script>yiliaConfig.jquery_ui=[!1]</script><script>yiliaConfig.rootUrl="/"</script><meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/rss+xml">
<link rel="stylesheet" href="/css/prism-a11y-dark.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div id="container"><div class="left-col"><div class="intrude-less"><header id="header" class="inner"><a href="/" class="profilepic"><img src="/img/avatar.jpg"></a><hgroup><h1 class="header-author"><a href="/">m01ly</a></h1></hgroup><p class="header-subtitle">人生在世，全靠命</p><form id="search-form"><input type="text" id="local-search-input" name="q" placeholder="search..." class="search form-control" autocomplete="off" autocorrect="off" searchonload="false"> <i class="fa fa-times" onclick="resetSearch()"></i></form><div id="local-search-result"></div><p class="no-result">No results found <i class="fa fa-spinner fa-pulse"></i></p><div id="switch-btn" class="switch-btn"><div class="icon"><div class="icon-ctn"><div class="icon-wrap icon-house" data-idx="0"><div class="birdhouse"></div><div class="birdhouse_holes"></div></div><div class="icon-wrap icon-ribbon hide" data-idx="1"><div class="ribbon"></div></div><div class="icon-wrap icon-link hide" data-idx="2"><div class="loopback_l"></div><div class="loopback_r"></div></div><div class="icon-wrap icon-me hide" data-idx="3"><div class="user"></div><div class="shoulder"></div></div></div></div><div class="tips-box hide"><div class="tips-arrow"></div><ul class="tips-inner"><li>菜单</li><li>标签</li><li>友情链接</li><li>目标</li></ul></div></div><div id="switch-area" class="switch-area"><div class="switch-wrap"><section class="switch-part switch-part1"><nav class="header-menu"><ul><li><a href="/">主页</a></li><li><a href="/archives/">所有文章</a></li><li><a href="/tags/">标签云</a></li><li><a href="/about/">简历</a></li></ul></nav><nav class="header-nav"><ul class="social"><a class="fa GitHub" target="_blank" rel="noopener" href="https://github.com/m01ly" title="GitHub"></a> <a class="fa RSS" href="/atom.xml" title="RSS"></a> <a class="fa 网易云音乐" target="_blank" rel="noopener" href="https://music.163.com/" title="网易云音乐"></a></ul><ul class="social"><div class="donateIcon-position"><p style="display:block"><a class="donateIcon" href="javascript:void(0)" onmouseout='var qr=document.getElementById("donate");qr.style.display="none"' onmouseenter='var qr=document.getElementById("donate");qr.style.display="block"'>赏</a></p><div id="donate"><img id="multipay" src="/img/multipay.png" width="250px" alt="m01ly Multipay"><div class="triangle"></div></div></div></ul></nav></section><section class="switch-part switch-part2"><div class="widget tagcloud" id="js-tagcloud"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/TLS/" rel="tag">TLS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AA%E4%BA%BA%E7%AC%94%E8%AE%B0/" rel="tag">个人笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/" rel="tag">安装教程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="tag">密码学</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" rel="tag">渗透测试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/" rel="tag">漏洞扫描</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8/" rel="tag">移动安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%B6%E5%9C%BAwriteup/" rel="tag">靶场writeup</a></li></ul></div></section><section class="switch-part switch-part3"><div id="js-friends"><a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://github.com/TechCatsLab">TechCatsLab</a> <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://yangchenglong11.github.io">YangChengLong</a> <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://jsharkc.github.io">LiuJiaChang</a> <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="http://blog.yusank.space">YusanKurban</a> <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://blog.lizebang.top">Lizebang</a> <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://github.com/sunanxiang">SunAnXiang</a> <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://github.com/DoubleWoodH">LinHao</a> <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://blog.littlechao.top">ShiChao</a> <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://github.com/Txiaozhe">TangXiaoJi</a> <a class="main-nav-link switch-friends-link" target="_blank" rel="noopener" href="https://github.com/LLLeon">JiaChenHui</a></div></section><section class="switch-part switch-part4"><div id="js-aboutme">不悲不喜，不卑不亢，努力成为一个更好的程序猿！</div></section></div></div></header></div></div><div class="hide-left-col" title="隐藏侧栏"><i class="fa fa-angle-double-left"></i></div><div class="mid-col"><nav id="mobile-nav"><div class="overlay"><div class="slider-trigger"></div><h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">m01ly</a></h1></div><div class="intrude-less"><header id="header" class="inner"><a href="/" class="profilepic"><img src="/img/avatar.jpg"></a><hgroup><h1 class="header-author"><a href="/" title="回到主页">m01ly</a></h1></hgroup><p class="header-subtitle">人生在世，全靠命</p><nav class="header-menu"><ul><li><a href="/">主页</a></li><li><a href="/archives/">所有文章</a></li><li><a href="/tags/">标签云</a></li><li><a href="/about/">简历</a></li><div class="clearfix"></div></ul></nav><nav class="header-nav"><ul class="social"><a class="fa GitHub" target="_blank" href="https://github.com/m01ly" title="GitHub"></a> <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a> <a class="fa 网易云音乐" target="_blank" href="https://music.163.com/" title="网易云音乐"></a></ul></nav></header></div><link class="menu-list" tags="标签" friends="友情链接" about="目标"></nav><div class="body-wrap"><article id="post-blockcipher-operation-mode" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2020/08/31/blockcipher-operation-mode/" class="article-date"><time class="published" datetime="2020-08-31T08:50:11.000Z" itemprop="datePublished">2020-08-31 发布</time> <time class="updated" datetime="2020-09-03T13:12:11.798Z" itemprop="dateUpdated">2020-09-03 更新</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2020/08/31/blockcipher-operation-mode/">分组密码--工作模式</a></h1></header><div class="article-entry" itemprop="articleBody"><p>转载wiki</p><h2 id="1-前期知识"><a href="#1-前期知识" class="headerlink" title="1 前期知识"></a>1 前期知识</h2><p>分组密码算法</p><h2 id="2-工作模式"><a href="#2-工作模式" class="headerlink" title="2 工作模式"></a>2 工作模式</h2><p>我们知道分组密码属于对称密码算法，但是每次只能处理特定长度的一块数据的算法，每块都是一个分组，分组的比特数就称为分组长度。因此针对加密的内容超过分组密码的分组长度时，该如何安全加密呢？这时候就需要工作模式来解决这个问题， 分组密码工作模式描述了如何重复加密比较长的多个数据块，工作模式中会用到加密算法，加密算法只是工作模式中的一环节，这里要区分开。</p><p>常见的分组加密算法有: DES、3DES、AES、IDEA 。</p><p><strong>常见分组密码算法分组长度和密钥长度如下表:</strong></p><table><thead><tr><th>密码算法</th><th>分组长度</th><th>密钥长度</th></tr></thead><tbody><tr><td>DES</td><td>64 bit/8 byte</td><td>64(56+8) bit/8 byte</td></tr><tr><td>3DES</td><td>64 bit/8 byte</td><td>64/64*2/64 * 3 bit</td></tr><tr><td>AES</td><td>128 bit/16 byte</td><td>128/192/256 bit</td></tr></tbody></table><p>经典的工作模式有以下5种。</p><p><img src="/2020/08/31/blockcipher-operation-mode/1598927024511.png" alt="1598927024511"></p><p><img src="https://img-blog.csdnimg.cn/20200412155237387.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3hpYW9xaWFvbGl1c2h1aUND,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p><h3 id="2-1-电子密码本（ECB）"><a href="#2-1-电子密码本（ECB）" class="headerlink" title="2.1 电子密码本（ECB）"></a>2.1 电子密码本（ECB）</h3><p>最简单的加密模式即为<strong>电子密码本</strong>（Electronic codebook，ECB）模式。需要加密的消息按照块密码的块大小被分为数个块，并对每个块进行独立加密。</p><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/File:Ecb_encryption.png"><img src="https://upload.wikimedia.org/wikipedia/commons/c/c4/Ecb_encryption.png" alt="Ecb encryption.png"></a></p><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/File:Ecb_decryption.png"><img src="https://upload.wikimedia.org/wikipedia/commons/6/66/Ecb_decryption.png" alt="Ecb decryption.png"></a></p><p>本方法的缺点在于同样的明文块会被加密成相同的密文块；因此，它不能很好的隐藏数据模式。在某些场合，这种方法不能提供严格的数据保密性，因此并不推荐用于密码协议中。下面的例子显示了ECB在密文中显示明文的模式的程度：该图像的一个位图版本（左图）通过ECB模式可能会被加密成中图，而非ECB模式通常会将其加密成右图。</p><table><thead><tr><th><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/File:Tux.jpg"><img src="https://upload.wikimedia.org/wikipedia/commons/5/56/Tux.jpg" alt="Tux.jpg"></a></th><th><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/File:Tux_ecb.jpg"><img src="https://upload.wikimedia.org/wikipedia/commons/f/f0/Tux_ecb.jpg" alt="Tux ecb.jpg"></a></th><th><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/File:Tux_secure.jpg"><img src="https://upload.wikimedia.org/wikipedia/commons/a/a0/Tux_secure.jpg" alt="Tux secure.jpg"></a></th></tr></thead><tbody><tr><td>原图</td><td>使用ECB模式加密</td><td>提供了伪随机性的非ECB模式</td></tr></tbody></table><p>右图是使用CBC，CTR或任何其它的更安全的模式加密左图可能产生的结果——与随机噪声无异。注意右图看起来的随机性并不能表示图像已经被安全的加密；许多不安全的加密法也可能产生这种“随机的”输出。</p><p>ECB模式也会导致使用它的协议不能提供数据完整性保护，易受到重放攻击的影响，因此每个块是以完全相同的方式解密的。例如，“梦幻之星在线：蓝色脉冲”在线电子游戏使用ECB模式的Blowfish密码。在密钥交换系统被破解而产生更简单的破解方式前，作弊者重复通过发送加密的“杀死怪物”消息包以非法的快速增加经验值。</p><h3 id="2-2-密码块链接（CBC）"><a href="#2-2-密码块链接（CBC）" class="headerlink" title="2.2 密码块链接（CBC）"></a>2.2 密码块链接（CBC）</h3><p>1976年，IBM发明了<strong>密码分组链接</strong>（CBC，Cipher-block chaining）模式。在CBC模式中，每个明文块先与前一个密文块进行异或后，再进行加密。在这种方法中，每个密文块都依赖于它前面的所有明文块。同时，为了保证每条消息的唯一性，在第一个块中需要使用初始化向量。</p><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/File:Cbc_encryption.png"><img src="https://upload.wikimedia.org/wikipedia/commons/d/d3/Cbc_encryption.png" alt="Cbc encryption.png"></a></p><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/File:Cbc_decryption.png"><img src="https://upload.wikimedia.org/wikipedia/commons/6/66/Cbc_decryption.png" alt="Cbc decryption.png"></a></p><p>若第一个块的下标为1，则CBC模式的加密过程为</p><p><img src="/2020/08/31/blockcipher-operation-mode/1598926624504.png" alt="1598926624504"></p><p>而其解密过程则为</p><p><img src="/2020/08/31/blockcipher-operation-mode/1598926632436.png" alt="1598926632436"></p><p>CBC是最为常用的工作模式。它的主要缺点在于<strong>加密过程是串行</strong>的，无法被并行化，而且消息必须被填充到块大小的整数倍。解决后一个问题的一种方法是利用密文窃取。</p><p>注意在加密时，明文中的微小改变会导致其后的全部密文块发生改变，而在解密时，从两个邻接的密文块中即可得到一个明文块。因此，<strong>解密过程可以被并行化</strong>，而解密时，密文中一位的改变只会导致其对应的明文块完全改变和下一个明文块中对应位发生改变，不会影响到其它明文的内容。</p><h3 id="2-3-填充密码块链接（PCBC）"><a href="#2-3-填充密码块链接（PCBC）" class="headerlink" title="2.3 填充密码块链接（PCBC）"></a>2.3 填充密码块链接（PCBC）</h3><p><strong>填充密码块链接</strong>（<strong>PCBC</strong>，Propagating cipher-block chaining）或称为<strong>明文密码块链接</strong>（Plaintext cipher-block chaining），是一种可以使密文中的微小更改在解密时导致明文大部分错误的模式，并在加密的时候也具有同样的特性。</p><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/File:Pcbc_encryption.png"><img src="https://upload.wikimedia.org/wikipedia/commons/0/08/Pcbc_encryption.png" alt="Pcbc encryption.png"></a></p><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/File:Pcbc_decryption.png"><img src="https://upload.wikimedia.org/wikipedia/commons/2/23/Pcbc_decryption.png" alt="Pcbc decryption.png"></a></p><p>加密和解密算法如下：</p><p><img src="/2020/08/31/blockcipher-operation-mode/1598926657325.png" alt="1598926657325"></p><p>PCBC主要用于Kerberos v4和WASTE中，而在其它场合的应用较少。对于使用PCBC加密的消息，互换两个邻接的密文块不会对后续块的解密造成影响。正因为这个特性，Kerberos v5没有使用PCBC。</p><h3 id="2-4-密文反馈（CFB）"><a href="#2-4-密文反馈（CFB）" class="headerlink" title="2.4 密文反馈（CFB）"></a>2.4 密文反馈（CFB）</h3><p><strong>密文反馈</strong>（CFB，Cipher feedback）模式类似于CBC，可以将块密码变为自同步的<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%B5%81%E5%AF%86%E7%A0%81">流密码</a>；工作过程亦非常相似，CFB的解密过程几乎就是颠倒的CBC的加密过程：</p><p><img src="/2020/08/31/blockcipher-operation-mode/1598926692468.png" alt="1598926692468"></p><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/File:Cfb_encryption.png"><img src="https://upload.wikimedia.org/wikipedia/commons/f/fd/Cfb_encryption.png" alt="Cfb encryption.png"></a></p><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/File:Cfb_decryption.png"><img src="https://upload.wikimedia.org/wikipedia/commons/7/75/Cfb_decryption.png" alt="Cfb decryption.png"></a></p><p>上述公式是描述的是最简单的CFB，在这种模式下，它的自同步特性仅仅与CBC相同，即若密文的一整块发生错误，CBC和CFB都仍能解密大部分数据，而仅有一位数据错误。若需要在仅有了一位或一字节错误的情况下也让模式具有自同步性，必须每次只加密一位或一字节。可以将移位寄存器作为块密码的输入，以利用CFB的自同步性。</p><p>为了利用CFB制作一种自同步的，可以处理任意位情况错误的流密码，需要使用一个与块的大小相同的移位寄存器，并用IV将寄存器初始化。然后，将寄存器内容使用块密码加密，然后将结果的最高<em>x</em>位与明文的<em>x</em>进行异或，以产生密文的<em>x</em>位。下一步将生成的<em>x</em>位密文移入寄存器中，并对下面的<em>x</em>位明文重复这一过程。解密过程与加密过程相似，以IV开始，对寄存器加密，将结果的高<em>x</em>与密文异或，产生<em>x</em>位明文，再将密文的下面<em>x</em>位移入寄存器。</p><p>下式中Si是移位寄存器的第<em>i</em>个状态，a &lt;&lt; x是指将<em>a</em>移位<em>x</em>位，head(a, x)是指<em>a</em>的高<em>x</em>位，<em>n</em>则是指IV的位数。</p><p><img src="/2020/08/31/blockcipher-operation-mode/1598926716035.png" alt="1598926716035"></p><p>若密文的<em>x</em>位发生错误，则密码在移位寄存器恢复与加密时的状态相同之前，输出不正确的结果，而当寄存器状态恢复后，密码即可以重新同步，恢复正常输出，因此最多只有一块数据发生错误。</p><p>与CBC相似，明文的改变会影响接下来所有的密文，因此加密过程不能并行化；而同样的，与CBC类似，解密过程是可以并行化的。在解密时，密文中一位数据的改变仅会影响两个明文块：对应明文块中的一位数据与下一块中全部的数据，而之后的数据将恢复正常。</p><p>CFB拥有一些CBC所不具备的特性，这些特性与OFB和CTR的流模式相似：只需要使用块密码进行加密操作，且消息无需进行填充（虽然密文窃取也允许数据不进行填充）。</p><h3 id="2-5-输出反馈（OFB）"><a href="#2-5-输出反馈（OFB）" class="headerlink" title="2.5 输出反馈（OFB）"></a>2.5 输出反馈（OFB）</h3><p><strong>输出反馈</strong>模式（Output feedback, OFB）可以将块密码变成同步的流密码。它产生密钥流的块，然后将其与明文块进行异或，得到密文。与其它流密码一样，密文中一个位的翻转会使明文中同样位置的位也产生翻转。这种特性使得许多错误校正码，例如奇偶校验位，即使在加密前计算，而在加密后进行校验也可以得出正确结果。</p><p>由于XOR操作的对称性，加密和解密操作是完全相同的：</p><p><img src="/2020/08/31/blockcipher-operation-mode/1598926747469.png" alt="1598926747469"></p><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/File:Ofb_encryption.png"><img src="https://upload.wikimedia.org/wikipedia/commons/a/a9/Ofb_encryption.png" alt="Ofb encryption.png"></a></p><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/File:Ofb_decryption.png"><img src="https://upload.wikimedia.org/wikipedia/commons/8/82/Ofb_decryption.png" alt="Ofb decryption.png"></a></p><p>每个使用OFB的输出块与其前面所有的输出块相关，因此不能并行化处理。然而，由于明文和密文只在最终的异或过程中使用，因此可以事先对IV进行加密，最后并行的将明文或密文进行并行的异或处理。</p><p>可以利用输入全0的CBC模式产生OFB模式的密钥流。这种方法十分实用，因为可以利用快速的CBC硬件实现来加速OFB模式的加密过程。</p><h3 id="2-6计数器模式（CTR）"><a href="#2-6计数器模式（CTR）" class="headerlink" title="2.6计数器模式（CTR）"></a>2.6计数器模式（CTR）</h3><p>与OFB相似，CTR将块密码变为流密码。它通过递增一个加密计数器以产生连续的密钥流，其中，计数器可以是任意保证长时间不产生重复输出的函数，但使用一个普通的计数器是最简单和最常见的做法。使用简单的、定义好的输入函数是有争议的：批评者认为它“有意的将密码系统暴露在已知的、系统的输入会造成不必要的风险”。目前，CTR已经被广泛的使用了，由输入函数造成的问题被认为是使用的块密码的缺陷，而非CTR模式本身的弱点。无论如何，有一些特别的攻击方法，例如基于使用简单计数器作为输入的硬件差错攻击。</p><p>CTR模式的特征类似于OFB，但它允许在解密时进行随机存取。由于加密和解密过程均可以进行并行处理，CTR适合运用于多处理器的硬件上。</p><p>注意图中的“nonce”与其它图中的IV（初始化向量）相同。IV、随机数和计数器均可以通过连接，相加或异或使得相同明文产生不同的密文。</p><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/File:Ctr_encryption.png"><img src="https://upload.wikimedia.org/wikipedia/commons/3/3f/Ctr_encryption.png" alt="Ctr encryption.png"></a></p><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/File:Ctr_decryption.png"><img src="https://upload.wikimedia.org/wikipedia/commons/3/34/Ctr_decryption.png" alt="Ctr decryption.png"></a></p><p>参考文献：</p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/xiaoqiaoliushuiCC/article/details/105470567">https://blog.csdn.net/xiaoqiaoliushuiCC/article/details/105470567</a></p><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F">https://zh.wikipedia.org/wiki/%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F</a></p><link href="//src.wangriyu.wang/lib/Aplayer/APlayer.min.css" rel="stylesheet"><script src="//src.wangriyu.wang/lib/Aplayer/APlayer.min.js"></script><div id="aplayer"></div><script src="/js/player.js"></script></div><div class="article-info article-info-index"><div class="article-count"><div class="article-tag tagcloud"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="tag">密码学</a></li></ul></div><span class="post-count">总字数2.5k</span> <span class="post-count">预计阅读8分钟</span></div><div class="clearfix"></div></div></div></article><article id="post-hexo-guide" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2020/08/26/hexo-guide/" class="article-date"><time class="published" datetime="2020-08-26T09:33:07.000Z" itemprop="datePublished">2020-08-26 发布</time> <time class="updated" datetime="2021-02-19T03:16:49.836Z" itemprop="dateUpdated">2021-02-19 更新</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2020/08/26/hexo-guide/">Hexo踩坑</a></h1></header><div class="article-entry" itemprop="articleBody"><h1 id="Hexo自建博客"><a href="#Hexo自建博客" class="headerlink" title="Hexo自建博客"></a>Hexo自建博客</h1><h2 id="0-引言"><a href="#0-引言" class="headerlink" title="0 引言"></a>0 引言</h2><p><a target="_blank" rel="noopener" href="https://www.dazhuanlan.com/2019/12/18/5df99e24d6d27/">https://www.dazhuanlan.com/2019/12/18/5df99e24d6d27/</a></p><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/7f06d10f2e3e">https://www.jianshu.com/p/7f06d10f2e3e</a></p><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/db02d775aed0">https://www.jianshu.com/p/db02d775aed0</a></p><h1 id="1-插入图片"><a href="#1-插入图片" class="headerlink" title="1 插入图片"></a>1 插入图片</h1><h2 id="1-1-配置文件"><a href="#1-1-配置文件" class="headerlink" title="1.1  配置文件"></a>1.1 配置文件</h2><blockquote><p>根目录配置_config.yml里面的post_asset_folder:false这个选项设置为true。Hexo 提供了一种更方便管理 Asset 的设定：post_asset_folder</p><pre><code>post_asset_folder: true</code></pre></blockquote><h2 id="1-2-安装图片插件"><a href="#1-2-安装图片插件" class="headerlink" title="1.2 安装图片插件"></a>1.2 安装图片插件</h2><p>先卸载 hexo-asset-image: npm uninstall hexo-asset-image</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> https://github.com/CodeFalling/hexo-asset-image --save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2020/08/26/hexo-guide/1603260802378.png" alt="1603260802378"></p><p>图片居中</p><pre><code>&lt;style&gt;
img &#123;
  position:relative;
  width:60%;
  left:15%;/*left为（img父元素元素的width - img元素自己的width)÷2*/
&#125;
&lt;/style&gt;</code></pre><h1 id="2-建立-about等页面"><a href="#2-建立-about等页面" class="headerlink" title="2  建立 about等页面"></a>2 建立 about等页面</h1><h1 id="3-使用标签和分类"><a href="#3-使用标签和分类" class="headerlink" title="3 使用标签和分类"></a>3 使用标签和分类</h1><p><strong>注：文章标签可以添加多个，分类却只能有一个，设置多个只有第一个生效。</strong></p><h2 id="3-1-标签"><a href="#3-1-标签" class="headerlink" title="3.1 标签"></a>3.1 标签</h2><p>在Hexo博客本地根目录右键选择<code>Git Bash</code>（前提是已安装好<code>Git</code>和<code>Node.js</code>,可参照<a target="_blank" rel="noopener" href="https://sogrey.github.io/article/%E5%A6%82%E4%BD%95%E5%9C%A8Github-Pages%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E7%8B%AC%E7%AB%8B%E4%B8%BB%E9%A1%B5%EF%BC%9F/">如何在Github Pages搭建个人独立主页？</a>）,输入命令：</p><pre><code>hexo new page tags</code></pre><p>回车，提示：</p><pre><code>INFO  Created: ...\source\tags\index.md</code></pre><p>就创建完成了。在<code>source\</code>目录下会多出一个<code>tags</code>文件夹，里面有一个<code>index.md</code>文件，打开该文件输入如下：</p><pre><code>---
title: 标签云
date: 2017-01-10 22:54:00
type: &quot;tags&quot;
comments: true
---</code></pre><p>其中：<code>title</code>和<code>date</code>是标题和创建时间，<code>type</code>表示类型，值<code>tags</code>表示这是个标签云页面，<code>comments</code>是是否允许评论，<code>true</code>表示允许评论。</p><p>这样标签云页面已经创建好了，部署试一下：</p><h2 id="3-2-分类"><a href="#3-2-分类" class="headerlink" title="3.2 分类"></a>3.2 分类</h2><h3 id="3-2-1-站点配置"><a href="#3-2-1-站点配置" class="headerlink" title="3.2.1 站点配置"></a>3.2.1 站点配置</h3><p>在站点根目录下的<code>_config.yml</code>里有这么一段：</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># Directory</span>
source_dir: <span class="token function">source</span>
public_dir: public
tag_dir: tags
archive_dir: archives
category_dir: categories
code_dir: downloads/code
i18n_dir: :lang
skip_render:<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>其中：<code>category_dir: categories</code>就是分配分类目录了，没有的可以按这样配置，下面就是创建了。</p><h3 id="3-2-2-创建分类"><a href="#3-2-2-创建分类" class="headerlink" title="3.2.2 创建分类"></a>3.2.2 创建分类</h3><p>跟创建<code>云标签</code>一样：</p><pre class="line-numbers language-bash"><code class="language-bash">hexo new page categories<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>在<code>source</code>目录下生成一个<code>categories\index.md</code>文件，编辑它：</p><pre class="line-numbers language-bash"><code class="language-bash">---
date: 2017-01-12 02:23:17
title: categories
type: <span class="token string">"categories"</span>
comments: <span class="token boolean">false</span>
---<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在上一篇说道<code>type</code>值为<code>tags</code>是标签云，这里是分类<code>categories</code>。就这么简单不用再做其他输入。</p><p><img src="/2020/08/26/hexo-guide/1599186880480.png" alt="1599186880480"></p><h1 id="4-评论系统"><a href="#4-评论系统" class="headerlink" title="4 评论系统"></a>4 评论系统</h1><p>主题目前支持 <code>Disqus</code>，多说[倒闭了]及友言[倒闭了]评论，把 <code>#on: true</code> 改为 <code>on: true</code> 即启用对应评论系统。</p><h3 id="动态加载评论模块"><a href="#动态加载评论模块" class="headerlink" title="动态加载评论模块"></a>动态加载评论模块</h3><pre><code>preload_comment: true## true: 评论区跟随页面一起加载## false: 当点击评论条等区域时再加载评论模块</code></pre><h3 id="评论数显示"><a href="#评论数显示" class="headerlink" title="评论数显示"></a>评论数显示</h3><p>选择是否在主页文章标题旁显示评论数。</p><pre><code>show_count: false</code></pre><blockquote><p>备注：这里面<code>Disqus</code>是国外的第三方评论插件，如果没有翻墙的话，是无法显示的。并且在使用该第三方评论插件的时候，需要先注册才能用。</p></blockquote><p><strong>（1）申请ClientID和ClientSecrets</strong></p><p>注册一个 Github OAuth application: <a target="_blank" rel="noopener" href="https://github.com/settings/applications/new">https://github.com/settings/applications/new</a></p><p>记下 <code>clientID</code> 和 <code>clientSecret</code></p><p><img src="/2020/08/26/hexo-guide/1613641845681.png" alt="1613641845681"></p><p><img src="/2020/08/26/hexo-guide/1613701655740.png" alt="1613701655740"></p><p><img src="/2020/08/26/hexo-guide/1613645427696.png" alt="1613645427696"></p><p>Client ID</p><pre><code>41a199ade404435645c4</code></pre><p>1de34fbb95212de986a29fea6d6f22bb57b2d473</p><p><strong>2、在主题配置文件 _config.yml 中添加</strong></p><p>当然，还有其他很多参数，有兴趣的话可以 <a target="_blank" rel="noopener" href="https://github.com/gitalk/gitalk#options">点这里</a>。</p><pre class="line-numbers language-yaml"><code class="language-yaml"><span class="token key atrule">gitalk</span><span class="token punctuation">:</span>
  <span class="token key atrule">on</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">clientID</span><span class="token punctuation">:</span> <span class="token string">'xxxxxx'</span>
  <span class="token key atrule">clientSecret</span><span class="token punctuation">:</span> <span class="token string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>
  <span class="token key atrule">repo</span><span class="token punctuation">:</span> 'm01ly.github.io'//存储你评论 issue 的 Github 仓库名（建议直接用 GitHub Page 的仓库名）
  <span class="token key atrule">owner</span><span class="token punctuation">:</span> <span class="token string">'m01ly'</span>
  <span class="token key atrule">admin</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'m01ly'</span><span class="token punctuation">]</span>//这个仓库的管理员，可以有多个，用数组表示，一般写自己<span class="token punctuation">,</span>
  <span class="token key atrule">id</span><span class="token punctuation">:</span> 'window.location.pathname'//页面的唯一标识，gitalk 会根据这个标识自动创建的issue的标签<span class="token punctuation">,</span>我们使用页面的相对路径作为标识<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a target="_blank" rel="noopener" href="http://github.shadowwu.club/2017/12/19/Gittalk%E7%9A%84%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%B5%8B%E8%AF%95/">http://github.shadowwu.club/2017/12/19/Gittalk%E7%9A%84%E4%BB%8B%E7%BB%8D%E5%8F%8A%E6%B5%8B%E8%AF%95/</a></p><h1 id="4-使用"><a href="#4-使用" class="headerlink" title="4 使用"></a>4 使用</h1><p>官方指南 <a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/tag-plugins">https://hexo.io/zh-cn/docs/tag-plugins</a></p><p>hexo 命令：<a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903777321877511">https://juejin.cn/post/6844903777321877511</a></p><p>yelee主题使用指南: <a target="_blank" rel="noopener" href="http://moxfive.xyz/yelee/">http://moxfive.xyz/yelee/</a></p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/xjm850552586/article/details/84101345">https://blog.csdn.net/xjm850552586/article/details/84101345</a></p><pre class="line-numbers language-bash"><code class="language-bash">$ hexo n <span class="token string">"博客名称"</span>  <span class="token operator">=</span><span class="token operator">></span> hexo new <span class="token string">"博客名称"</span>   <span class="token comment" spellcheck="true">#这两个都是创建新文章，前者是简写模式</span>
$ hexo clean <span class="token comment" spellcheck="true">#清空本地导出的博客</span>
$ hexo g  <span class="token operator">=</span><span class="token operator">></span> hexo generate  <span class="token comment" spellcheck="true">#生成</span>
$ hexo s  <span class="token operator">=</span><span class="token operator">></span> hexo server  <span class="token comment" spellcheck="true">#本地服务器浏览</span>
$ hexo d  <span class="token operator">=</span><span class="token operator">></span> hexo deploy  <span class="token comment" spellcheck="true">#部署</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash"><code class="language-bash">$ hexo server   <span class="token comment" spellcheck="true">#Hexo 会监视文件变动并自动更新，无须重启服务器。</span>
$ hexo server -s   <span class="token comment" spellcheck="true">#静态模式</span>
$ hexo server -p 5000   <span class="token comment" spellcheck="true">#更改端口</span>
$ hexo server -i 192.168.1.1   <span class="token comment" spellcheck="true">#自定义IP</span>
$ hexo clean   <span class="token comment" spellcheck="true">#清除缓存，网页正常情况下可以忽略此条命令</span>
$ hexo g   <span class="token comment" spellcheck="true">#生成静态网页</span>
$ hexo d   <span class="token comment" spellcheck="true">#开始部署</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在根目录下blog/Hexo下右击，点击“git bash here”，然后进行文章的发布管理等。</p><p><img src="/2020/08/26/hexo-guide/1613635158320.png" alt="1613635158320"></p><p><a href="https://m01ly.github.io/archives/">https://m01ly.github.io/archives/</a></p><h1 id="5-注意事项"><a href="#5-注意事项" class="headerlink" title="5 注意事项"></a>5 注意事项</h1><p>md文件命名最好英文</p><p>用yelee主题的博客：</p><p><a target="_blank" rel="noopener" href="https://www.gokuweb.com/web/39c1ec60.html">https://www.gokuweb.com/web/39c1ec60.html</a></p><p><a target="_blank" rel="noopener" href="https://sogrey.top/article/">https://sogrey.top/article/</a></p><p>[<a target="_blank" rel="noopener" href="https://durant35.github.io/2016/09/16/hexo_Theme%20Yelee%20Migrant%20Note/#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%89%88%E6%9D%83%E4%BF%A1%E6%81%AF]">https://durant35.github.io/2016/09/16/hexo_Theme%20Yelee%20Migrant%20Note/#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%89%88%E6%9D%83%E4%BF%A1%E6%81%AF]</a>(<a target="_blank" rel="noopener" href="https://durant35.github.io/2016/09/16/hexo_Theme">https://durant35.github.io/2016/09/16/hexo_Theme</a> Yelee Migrant Note/#自定义版权信息) 好的文章推荐–待安装</p><p><a target="_blank" rel="noopener" href="https://os_heartstill.gitee.io/chih-ping/2019/05/10/Hexo%E7%9A%84Yelee%E4%B8%BB%E9%A2%98%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/">https://os_heartstill.gitee.io/chih-ping/2019/05/10/Hexo%E7%9A%84Yelee%E4%B8%BB%E9%A2%98%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/</a></p><p>6 常见报错</p><p>hexo s报错如下：</p><pre class="line-numbers language-bash"><code class="language-bash">$ hexo g
INFO  Validating config
INFO  Start processing
FATAL <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;</span>
  err: TypeError <span class="token punctuation">[</span>ERR_INVALID_URL<span class="token punctuation">]</span>: Invalid URL: http://www.linuxidc.com<span class="token punctuation">]</span><span class="token comment" spellcheck="true">#</span>
      at onParseError <span class="token punctuation">(</span>internal/url.js:256:9<span class="token punctuation">)</span>
      at new URL <span class="token punctuation">(</span>internal/url.js:332:5<span class="token punctuation">)</span>
      at encodeURL <span class="token punctuation">(</span>C:\blog\Hexo\node_modules\hexo-util\lib\encode_url.js:8:20<span class="token punctuation">)</span>
      at Renderer.link <span class="token punctuation">(</span>C:\blog\Hexo\node_modules\hexo-renderer-marked\lib\renderer.js:56:27<span class="token punctuation">)</span>
      at Parser.parseInline <span class="token punctuation">(</span>C:\blog\Hexo\node_modules\marked\src\Parser.js:211:27<span class="token punctuation">)</span>
      at Parser.parse <span class="token punctuation">(</span>C:\blog\Hexo\node_modules\marked\src\Parser.js:162:47<span class="token punctuation">)</span>
      at Function.parse <span class="token punctuation">(</span>C:\blog\Hexo\node_modules\marked\src\Parser.js:27:19<span class="token punctuation">)</span>
      at marked <span class="token punctuation">(</span>C:\blog\Hexo\node_modules\marked\src\marked.js:110:19<span class="token punctuation">)</span>
      at Hexo.module.exports <span class="token punctuation">(</span>C:\blog\Hexo\node_modules\hexo-renderer-marked\lib\renderer.js:138:10<span class="token punctuation">)</span>
      at Hexo.tryCatcher <span class="token punctuation">(</span>C:\blog\Hexo\node_modules\bluebird\js\release\util.js:16:23<span class="token punctuation">)</span>
      at Hexo.<span class="token operator">&lt;</span>anonymous<span class="token operator">></span> <span class="token punctuation">(</span>C:\blog\Hexo\node_modules\bluebird\js\release\method.js:15:34<span class="token punctuation">)</span>
      at C:\blog\Hexo\node_modules\hexo\lib\hexo\render.js:75:22
      at tryCatcher <span class="token punctuation">(</span>C:\blog\Hexo\node_modules\bluebird\js\release\util.js:16:23<span class="token punctuation">)</span>
      at Promise._settlePromiseFromHandler <span class="token punctuation">(</span>C:\blog\Hexo\node_modules\bluebird\js\release\promise.js:547:31<span class="token punctuation">)</span>
      at Promise._settlePromise <span class="token punctuation">(</span>C:\blog\Hexo\node_modules\bluebird\js\release\promise.js:604:18<span class="token punctuation">)</span>
      at Promise._settlePromiseCtx <span class="token punctuation">(</span>C:\blog\Hexo\node_modules\bluebird\js\release\promise.js:641:10<span class="token punctuation">)</span>
      at _drainQueueStep <span class="token punctuation">(</span>C:\blog\Hexo\node_modules\bluebird\js\release\async.js:97:12<span class="token punctuation">)</span>
      at _drainQueue <span class="token punctuation">(</span>C:\blog\Hexo\node_modules\bluebird\js\release\async.js:86:9<span class="token punctuation">)</span>
      at Async._drainQueues <span class="token punctuation">(</span>C:\blog\Hexo\node_modules\bluebird\js\release\async.js:102:5<span class="token punctuation">)</span>
      at Immediate.Async.drainQueues <span class="token punctuation">[</span>as _onImmediate<span class="token punctuation">]</span> <span class="token punctuation">(</span>C:\blog\Hexo\node_modules\bluebird\js\release\async.js:15:14<span class="token punctuation">)</span>
      at processImmediate <span class="token punctuation">(</span>internal/timers.js:456:21<span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;</span>
    input: <span class="token string">'http://www.linuxidc.com]#'</span>,
    code: <span class="token string">'ERR_INVALID_URL'</span>
  <span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#125;</span>
<span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#125; Something's wrong. Maybe you can find the solution here: %s https://hexo.io/docs/troubleshooting.html</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2020/08/26/hexo-guide/1613635511527.png" alt="1613635511527"></p><link href="//src.wangriyu.wang/lib/Aplayer/APlayer.min.css" rel="stylesheet"><script src="//src.wangriyu.wang/lib/Aplayer/APlayer.min.js"></script><div id="aplayer"></div><script src="/js/player.js"></script></div><div class="article-info article-info-index"><div class="article-count"><span class="post-count">总字数1.5k</span> <span class="post-count">预计阅读7分钟</span></div><div class="clearfix"></div></div></div></article><article id="post-scan-awvs-nessus" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2020/08/26/scan-awvs-nessus/" class="article-date"><time class="published" datetime="2020-08-26T09:33:07.000Z" itemprop="datePublished">2020-08-26 发布</time> <time class="updated" datetime="2021-02-18T07:45:36.845Z" itemprop="dateUpdated">2021-02-18 更新</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2020/08/26/scan-awvs-nessus/">AWVS和Nessus镜像安装</a></h1></header><div class="article-entry" itemprop="articleBody"><p>文章来自：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzI5MDE0MjQ1NQ==&mid=2247498179&idx=2&sn=fa6f117c420bc52306508fe81af3b4d3&chksm=ec26d85bdb51514d6def0629e0c71ed5506b1939a9f69b30ff47d977fab8cc96dc15af16fb1c&mpshare=1&scene=23&srcid=1031d22NMZJcOV53f1sF2DPA&sharer_sharetime=1604139889173&sharer_shareid=ff83fe2fe7db7fcd8a1fcbc183d841c4#rd">漏洞扫描—Awvs&amp;Nessus(Docker版V3.0)–雷石安全</a>,雷石实验室维护的AWVS和Nessus镜像，可以去<a target="_blank" rel="noopener" href="https://hub.docker.com/r/leishianquan/awvs-nessus/tags?page=1&ordering=last_updated">docker hub</a>上查看最新版本</p><h1 id="1-安装"><a href="#1-安装" class="headerlink" title="1 安装"></a>1 安装</h1><p>pull 拉取下载镜像</p><pre class="line-numbers language-bash"><code class="language-bash">docker pull leishianquan/awvs-nessus:v03<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>启动</p><pre class="line-numbers language-bash"><code class="language-bash">docker run -it -d -p 13443:3443 -p 8834:8834 leishianquan/awvs-nessus:v03<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>需要注意的是访问Nessus需要进入容器启动Nessus 服务：</p><p>查看容器</p><pre class="line-numbers language-bash"><code class="language-bash">Docker <span class="token function">ps</span> –a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>启动容器</p><pre class="line-numbers language-bash"><code class="language-bash">Docker start 容器id<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>进入容器</p><pre class="line-numbers language-bash"><code class="language-bash">Docker <span class="token function">exec</span> -it 容器id <span class="token function">bash</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>启动nessus服务</p><pre class="line-numbers language-bash"><code class="language-bash">/etc/init.d/nessusd start<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ0ibeH92QHbQD44DXRNGic4ict95lS3S8njU849xaucOJJfGf815PCewlFrdQQKSyo9lDNSEdVGUfnibEw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="img"></p><p>破解awvs：</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">cp</span> /home/license_info.json /home/acunetix/.acunetix/data/license/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="2-使用"><a href="#2-使用" class="headerlink" title="2 使用"></a>2 使用</h1><p><strong>Nessus:</strong></p><p><a target="_blank" rel="noopener" href="https://127.0.0.1:8834/#/">https://127.0.0.1:8834/#/</a></p><p>nessus username:leishi</p><p>nessus password:leishianquan</p><p><strong>Awvs</strong>：</p><p><a target="_blank" rel="noopener" href="https://127.0.0.1:13443/">https://127.0.0.1:13443/</a></p><p>awvs13 username: <a href="mailto:&#108;&#x65;&#105;&#115;&#104;&#105;&#x40;&#x6c;&#101;&#x69;&#x73;&#104;&#x69;&#x2e;&#99;&#x6f;&#x6d;">&#108;&#x65;&#105;&#115;&#104;&#105;&#x40;&#x6c;&#101;&#x69;&#x73;&#104;&#x69;&#x2e;&#99;&#x6f;&#x6d;</a></p><p>awvs13 password: Leishi123</p><h1 id="3-注意事项"><a href="#3-注意事项" class="headerlink" title="3 注意事项"></a>3 注意事项</h1><p>这里需要注意，这个docker镜像有点小bug:AWVS证书用了一会后容易失效，出现如下图所示。这里我采取的笨方法是一直cp证书，代码如下：</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token keyword">echo</span> <span class="token string">" while true ;do cp /home/license_info.json /home/acunetix/.acunetix/data/license/; sleep 1; done; "</span> <span class="token operator">></span> t.sh
<span class="token function">chmod</span> 777 t.sh
<span class="token function">nohup</span> ./t.sh <span class="token operator">&amp;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/2020/08/26/scan-awvs-nessus/1604372586478.png" alt="1604372586478"></p><link href="//src.wangriyu.wang/lib/Aplayer/APlayer.min.css" rel="stylesheet"><script src="//src.wangriyu.wang/lib/Aplayer/APlayer.min.js"></script><div id="aplayer"></div><script src="/js/player.js"></script></div><div class="article-info article-info-index"><div class="article-count"><div class="article-tag tagcloud"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/" rel="tag">漏洞扫描</a></li></ul></div><span class="post-count">总字数270</span> <span class="post-count">预计阅读1分钟</span></div><div class="clearfix"></div></div></div></article><article id="post-scan-zap" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2020/08/26/scan-zap/" class="article-date"><time class="published" datetime="2020-08-26T09:33:07.000Z" itemprop="datePublished">2020-08-26 发布</time> <time class="updated" datetime="2021-02-18T07:45:23.695Z" itemprop="dateUpdated">2021-02-18 更新</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2020/08/26/scan-zap/">ZAP的安装和使用</a></h1></header><div class="article-entry" itemprop="articleBody"><p>官网<a target="_blank" rel="noopener" href="https://www.zaproxy.org/">https://www.zaproxy.org/</a></p><p>较好的教程：<a target="_blank" rel="noopener" href="https://www.wangan.com/docs/802">https://www.wangan.com/docs/802</a></p><p>官网可以下载软件，也可安装docker版本的</p><h1 id="0-前提"><a href="#0-前提" class="headerlink" title="0 前提"></a>0 前提</h1><p>需要java8的环境，查看java版本命令如下：</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token variable">$java</span> -version
<span class="token variable">$which</span> java
<span class="token variable">$whereis</span> java<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>如果装了java 7,8 ，当前java 为java7，只需要切换版本即可，即重新设置环境变量</p><p>(2)修改环境变量</p><p>$vi /etc/profile</p><p>设置如下：</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">export</span> JAVA_HOME<span class="token operator">=</span>/opt/jdk1.8.0_60
<span class="token function">export</span> CLASSPATH<span class="token operator">=</span>.:<span class="token variable">$JAVA_HOME</span>/lib/dt.jar:<span class="token variable">$JAVA_HOME</span>/lib/tools.jar
<span class="token function">export</span> PATH<span class="token operator">=</span><span class="token variable">$JAVA_HOME</span>/bin:<span class="token variable">$PATH</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>(3)环境变量生效</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token variable">$source</span> /etc/profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h1 id="1-docker安装ZAP"><a href="#1-docker安装ZAP" class="headerlink" title="1  docker安装ZAP"></a>1 docker安装ZAP</h1><p>进入官网<a target="_blank" rel="noopener" href="https://www.zaproxy.org/download/">下载页面</a>，往下拉可以看到docker下载地址，这里我们选择stable，稳定版本，然后按照官网的<a target="_blank" rel="noopener" href="https://www.zaproxy.org/docs/docker/about/">guide</a>逐步按照即可。</p><p><img src="/2020/08/26/scan-zap/1604399364254.png" alt="1604399364254"></p><p>(1) 拉取镜像</p><pre class="line-numbers language-bash"><code class="language-bash">docker pull owasp/zap2docker-stable:latest<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2020/08/26/scan-zap/1604399706466.png" alt="1604399706466"></p><p>（2）启动</p><pre class="line-numbers language-bash"><code class="language-bash">docker run -u zap -p 8080:8080 -p 8090:8090 -i owasp/zap2docker-stable zap-webswing.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>注意一定是<a target="_blank" rel="noopener" href="http://10.27.22.92:8080/zap/%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%98%AFhttp://10.27.22.92:8080%E4%BC%9A%E5%87%BA%E7%8E%B0%E8%BE%93%E5%85%A5%E7%94%A8%E6%88%B7%E5%90%8D%E5%AF%86%E7%A0%81%E3%80%82%E5%BC%80%E5%A7%8B%E5%87%BA%E7%8E%B0%E6%98%AF%E5%B0%8F%E5%B1%8F%E5%B9%95%EF%BC%8C%E7%82%B9%E5%87%BB%E5%85%A8%E5%B1%8F%E5%8D%B3%E5%8F%AF%E3%80%82">http://10.27.22.92:8080/zap/，如果是http://10.27.22.92:8080会出现输入用户名密码。开始出现是小屏幕，点击全屏即可。</a></p><p><img src="/2020/08/26/scan-zap/1604409202576.png" alt="1604409202576"></p><h1 id="2-直接安装"><a href="#2-直接安装" class="headerlink" title="2 直接安装"></a>2 直接安装</h1><p>适用于可以有界面的终端</p><pre><code>[root@m01ly ~]# wget https://github.com/zaproxy/zaproxy/releases/download/v2.9.0/ZAP_2_9_0_unix.sh</code></pre><p><img src="/2020/08/26/scan-zap/1604405494656.png" alt="1604405494656"></p><p>（2）安装</p><pre><code>[root@m01ly ~]# chmod 777 ZAP_2_9_0_unix.sh
[root@m01ly ~]# ./ZAP_2_9_0_unix.sh</code></pre><p>弹出界面：</p><p><img src="/2020/08/26/scan-zap/1604405604464.png" alt="1604405604464"></p><p><img src="/2020/08/26/scan-zap/1604405660783.png" alt="1604405660783"></p><p>默认安装路径位于/usr/local/zaproxy中，同时在用户目录下存在一个文件，位置为/home/admin/.ZAP，里面存放了软件的配置文件(config.xml)、脚本文件（community-scripts)、插件文件（plugin）、策略配置文件（policies）、远程调用会话保存目录（session）、本地启动文件会话（sessions）等重要文件；<strong>注意每次软件关闭时候，就会保存配置</strong>，所以配置文件的内容是最后一次软件关闭前的配置</p><p><img src="/2020/08/26/scan-zap/1604405876783.png" alt="1604405876783"></p><p>执行zap.sh</p><pre><code>[root@m01ly zaproxy]# ./zap.sh</code></pre><p>在虚拟机之外弹出了ZAP，说实话第一次安装有点吓一跳。</p><p><img src="/2020/08/26/scan-zap/1604406130388.png" alt="1604406130388"></p><p>这里注意如果是堡垒机去安装，则不适合这种安装方式，会出现如图所示的错误，最好选择docker版本的。</p><p><img src="/2020/08/26/scan-zap/1604407388145.png" alt="1604407388145"></p><pre><code>./zap.sh -daemon</code></pre><p>虽然启动成功， 但却无法在linux上启动后直接打开zap程序</p><h1 id="3-特性"><a href="#3-特性" class="headerlink" title="3 特性"></a>3 特性</h1><p>缺点：报告格式仅仅支持html,xml不支持csv,excel。</p><p>优点：集扫描，拦截（bp的功能），使用于个人渗透测试。</p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/528e6ffd6d29">ZAP使用教程</a></p><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/haohao111/p/11769727.html">安装教程</a></p><link href="//src.wangriyu.wang/lib/Aplayer/APlayer.min.css" rel="stylesheet"><script src="//src.wangriyu.wang/lib/Aplayer/APlayer.min.js"></script><div id="aplayer"></div><script src="/js/player.js"></script></div><div class="article-info article-info-index"><div class="article-count"><div class="article-tag tagcloud"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F/" rel="tag">漏洞扫描</a></li></ul></div><span class="post-count">总字数580</span> <span class="post-count">预计阅读2分钟</span></div><div class="clearfix"></div></div></div></article><article id="post-pt-tiquan" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2020/08/26/pt-tiquan/" class="article-date"><time class="published" datetime="2020-08-26T08:34:27.000Z" itemprop="datePublished">2020-08-26 发布</time> <time class="updated" datetime="2021-02-18T07:06:09.792Z" itemprop="dateUpdated">2021-02-18 更新</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2020/08/26/pt-tiquan/">提权</a></h1></header><div class="article-entry" itemprop="articleBody"><h2><a href="#" class="headerlink"></a></h2><pre><code>wget https://github.com/mzet-/linux-exploit-suggester
chmod 777 les.sh
./les.sh</code></pre><p><img src="/2020/08/26/pt-tiquan/1604483327437.png" alt="1604483327437"></p><pre><code>
Available information:

Kernel version: 3.10.0
Architecture: x86_64
Distribution: RHEL
Distribution version: 18.04
Additional checks (CONFIG_*, sysctl entries, custom Bash commands): performed
Package listing: N/A

Searching among:

74 kernel space exploits
0 user space exploits

Possible Exploits:

[+] [CVE-2016-5195] dirtycow

   Details: https://github.com/dirtycow/dirtycow.github.io/wiki/VulnerabilityDetails
   Exposure: probable
   Tags: debian=7|8,RHEL=5&#123;kernel:2.6.(18|24|33)-*&#125;,RHEL=6&#123;kernel:2.6.32-*|3.(0|2|6|8|10).*|2.6.33.9-rt31&#125;,RHEL=7&#123;kernel:3.10.0-*|4.2.0-0.21.el7&#125;,ubuntu=16.04|14.04|12.04
   Download URL: https://www.exploit-db.com/download/40611
   Comments: For RHEL/CentOS see exact vulnerable versions here: https://access.redhat.com/sites/default/files/rh-cve-2016-5195_5.sh

[+] [CVE-2016-5195] dirtycow 2

   Details: https://github.com/dirtycow/dirtycow.github.io/wiki/VulnerabilityDetails
   Exposure: probable
   Tags: debian=7|8,RHEL=5|6|7,ubuntu=14.04|12.04,ubuntu=10.04&#123;kernel:2.6.32-21-generic&#125;,ubuntu=16.04&#123;kernel:4.4.0-21-generic&#125;
   Download URL: https://www.exploit-db.com/download/40839
   ext-url: https://www.exploit-db.com/download/40847
   Comments: For RHEL/CentOS see exact vulnerable versions here: https://access.redhat.com/sites/default/files/rh-cve-2016-5195_5.sh

[+] [CVE-2019-15666] XFRM_UAF

   Details: https://duasynt.com/blog/ubuntu-centos-redhat-privesc
   Exposure: less probable
   Download URL: 
   Comments: CONFIG_USER_NS needs to be enabled; CONFIG_XFRM needs to be enabled

[+] [CVE-2017-7308] af_packet

   Details: https://googleprojectzero.blogspot.com/2017/05/exploiting-linux-kernel-via-packet.html
   Exposure: less probable
   Tags: ubuntu=16.04&#123;kernel:4.8.0-(34|36|39|41|42|44|45)-generic&#125;
   Download URL: https://raw.githubusercontent.com/xairy/kernel-exploits/master/CVE-2017-7308/poc.c
   ext-url: https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2017-7308/poc.c
   Comments: CAP_NET_RAW cap or CONFIG_USER_NS=y needed. Modified version at &#39;ext-url&#39; adds support for additional kernels

[+] [CVE-2017-6074] dccp

   Details: http://www.openwall.com/lists/oss-security/2017/02/22/3
   Exposure: less probable
   Tags: ubuntu=(14.04|16.04)&#123;kernel:4.4.0-62-generic&#125;
   Download URL: https://www.exploit-db.com/download/41458
   Comments: Requires Kernel be built with CONFIG_IP_DCCP enabled. Includes partial SMEP/SMAP bypass

[+] [CVE-2017-1000253] PIE_stack_corruption

   Details: https://www.qualys.com/2017/09/26/linux-pie-cve-2017-1000253/cve-2017-1000253.txt
   Exposure: less probable
   Tags: RHEL=6,RHEL=7&#123;kernel:3.10.0-514.21.2|3.10.0-514.26.1&#125;
   Download URL: https://www.qualys.com/2017/09/26/linux-pie-cve-2017-1000253/cve-2017-1000253.c

[+] [CVE-2016-2384] usb-midi

   Details: https://xairy.github.io/blog/2016/cve-2016-2384
   Exposure: less probable
   Tags: ubuntu=14.04,fedora=22
   Download URL: https://raw.githubusercontent.com/xairy/kernel-exploits/master/CVE-2016-2384/poc.c
   Comments: Requires ability to plug in a malicious USB device and to execute a malicious binary as a non-privileged user

[+] [CVE-2015-9322] BadIRET

   Details: http://labs.bromium.com/2015/02/02/exploiting-badiret-vulnerability-cve-2014-9322-linux-kernel-privilege-escalation/
   Exposure: less probable
   Tags: RHEL&lt;=7,fedora=20
   Download URL: http://site.pi3.com.pl/exp/p_cve-2014-9322.tar.gz

[+] [CVE-2015-8660] overlayfs (ovl_setattr)

   Details: http://www.halfdog.net/Security/2015/UserNamespaceOverlayfsSetuidWriteExec/
   Exposure: less probable
   Tags: ubuntu=(14.04|15.10)&#123;kernel:4.2.0-(18|19|20|21|22)-generic&#125;
   Download URL: https://www.exploit-db.com/download/39166

[+] [CVE-2015-8660] overlayfs (ovl_setattr)

   Details: http://www.halfdog.net/Security/2015/UserNamespaceOverlayfsSetuidWriteExec/
   Exposure: less probable
   Download URL: https://www.exploit-db.com/download/39230

[+] [CVE-2014-5207] fuse_suid

   Details: https://www.exploit-db.com/exploits/34923/
   Exposure: less probable
   Download URL: https://www.exploit-db.com/download/34923

[+] [CVE-2014-4014] inode_capable

   Details: http://www.openwall.com/lists/oss-security/2014/06/10/4
   Exposure: less probable
   Tags: ubuntu=12.04
   Download URL: https://www.exploit-db.com/download/33824

[+] [CVE-2014-0196] rawmodePTY

   Details: http://blog.includesecurity.com/2014/06/exploit-walkthrough-cve-2014-0196-pty-kernel-race-condition.html
   Exposure: less probable
   Download URL: https://www.exploit-db.com/download/33516

[+] [CVE-2014-0038] timeoutpwn

   Details: http://blog.includesecurity.com/2014/03/exploit-CVE-2014-0038-x32-recvmmsg-kernel-vulnerablity.html
   Exposure: less probable
   Tags: ubuntu=13.10
   Download URL: https://www.exploit-db.com/download/31346
   Comments: CONFIG_X86_X32 needs to be enabled

[+] [CVE-2014-0038] timeoutpwn 2

   Details: http://blog.includesecurity.com/2014/03/exploit-CVE-2014-0038-x32-recvmmsg-kernel-vulnerablity.html
   Exposure: less probable
   Tags: ubuntu=(13.04|13.10)&#123;kernel:3.(8|11).0-(12|15|19)-generic&#125;
   Download URL: https://www.exploit-db.com/download/31347
   Comments: CONFIG_X86_X32 needs to be enabled

[+] [CVE-2016-0728] keyring

   Details: http://perception-point.io/2016/01/14/analysis-and-exploitation-of-a-linux-kernel-vulnerability-cve-2016-0728/
   Exposure: less probable
   Download URL: https://www.exploit-db.com/download/40003
   Comments: Exploit takes about ~30 minutes to run. Exploit is not reliable, see: https://cyseclabs.com/blog/cve-2016-0728-poc-not-working</code></pre><h1 id="2-漏洞利用"><a href="#2-漏洞利用" class="headerlink" title="2 漏洞利用"></a>2 漏洞利用</h1><ul><li><p>Windows平台提权漏洞集合：<a target="_blank" rel="noopener" href="https://github.com/SecWiki/windows-kernel-exploits">https://github.com/SecWiki/windows-kernel-exploits</a></p></li><li><p>Linux平台提权漏洞集合：<a target="_blank" rel="noopener" href="https://github.com/SecWiki/linux-kernel-exploits">https://github.com/SecWiki/linux-kernel-exploits</a></p></li></ul><p>2.1 脏牛利用</p><pre><code>$ gcc -pthread dirtyc0w.c -o dirtyc0w
$ ./dirtyc0w foo m00000000000000000</code></pre><p><img src="/2020/08/26/pt-tiquan/1604484107935.png" alt="1604484107935"></p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/prettyX/article/details/103923947">https://blog.csdn.net/prettyX/article/details/103923947</a></p><pre><code>gcc -pthread dirtyroot.c -o dirtyroot</code></pre><link href="//src.wangriyu.wang/lib/Aplayer/APlayer.min.css" rel="stylesheet"><script src="//src.wangriyu.wang/lib/Aplayer/APlayer.min.js"></script><div id="aplayer"></div><script src="/js/player.js"></script></div><div class="article-info article-info-index"><div class="article-count"><div class="article-tag tagcloud"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" rel="tag">渗透测试</a></li></ul></div><span class="post-count">总字数961</span> <span class="post-count">预计阅读5分钟</span></div><div class="clearfix"></div></div></div></article><article id="post-htps-tools" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2020/08/26/htps-tools/" class="article-date"><time class="published" datetime="2020-08-26T08:34:27.000Z" itemprop="datePublished">2020-08-26 发布</time> <time class="updated" datetime="2021-02-18T07:06:00.004Z" itemprop="dateUpdated">2021-02-18 更新</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2020/08/26/htps-tools/">TLS安全检测小工具</a></h1></header><div class="article-entry" itemprop="articleBody"><h2 id="1-工具汇总"><a href="#1-工具汇总" class="headerlink" title="1 工具汇总"></a>1 工具汇总</h2><p><strong>ssllabs</strong><br>强烈推荐这个网站,简洁直观,非常好<br><a target="_blank" rel="noopener" href="https://www.ssllabs.com/">https://www.ssllabs.com/</a></p><p><strong>htbridge</strong><br>这个网站检测全面,SSL检测项目更新最快<br><a target="_blank" rel="noopener" href="https://www.htbridge.com/ssl/">https://www.htbridge.com/ssl/</a></p><p><strong>myssl</strong><br>这个网站是中国特供,国内访问速度最快,并提供对各大国产浏览器的SSL检测<br><a target="_blank" rel="noopener" href="https://myssl.com/">https://myssl.com</a></p><p><strong>testssl</strong></p><p>非常全的工具 <a target="_blank" rel="noopener" href="https://testssl.sh/">https://testssl.sh/</a></p><h2 id="2-sslscan"><a href="#2-sslscan" class="headerlink" title="2  sslscan"></a>2 sslscan</h2><ul><li>是否支持TLS Fallback SCSV</li><li>是否支持压缩</li><li>是否有心脏滴血漏洞（heartbleed）</li><li>支持的密码套件（及服务器优选的preferred, 红色表示不安全算法，黄色代表中等强度的算法 ）</li><li>证书信息</li></ul><h3 id="2-1-安装"><a href="#2-1-安装" class="headerlink" title="2.1 安装"></a>2.1 安装</h3><p>（1）下载源码</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@localname ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># git clone https://github.com/rbsec/sslscan</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>（2）进入目录</p><pre class="line-numbers language-bash"><code class="language-bash">   <span class="token punctuation">[</span>root@localname~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># cd sslscan</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>（3）编译安装</p><pre class="line-numbers language-bash"><code class="language-bash">   <span class="token punctuation">[</span>root@localname sslscan<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># make static</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>（4）查看是否编译成功</p><pre class="line-numbers language-bash"><code class="language-bash">   <span class="token punctuation">[</span>root@localhost sslscan<span class="token punctuation">]</span><span class="token comment" spellcheck="true">#./sslscan -version</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2020/08/26/htps-tools/1597831322514.png" alt="1597831322514"></p><h3 id="2-2-使用"><a href="#2-2-使用" class="headerlink" title="2.2 使用"></a>2.2 使用</h3><p>[root@localhost sslscan]# ./sslscan –tlsall <a target="_blank" rel="noopener" href="http://www.baidu.com:443/">www.baidu.com:443</a></p><p>​ OR</p><p>[root@localhost sslscan]# ./sslscan –tlsall 192.168.5.200 —-假如192.168.5.200是你的服务器IP</p><p>​ PS：上述两个命令的前提是能够ping通。</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@localname sslscan<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># ./sslscan --tlsall www.baidu.com:443</span>
Version: 2.0.0-static
OpenSSL 1.1.1h-dev  xx XXX xxxx
Connected to 180.97.34.96
Testing SSL server www.baidu.com on port 443 using SNI name www.baidu.com
  SSL/TLS Protocols:
TLSv1.0   enabled
TLSv1.1   enabled
TLSv1.2   enabled
TLSv1.3   disabled

  TLS Fallback SCSV:
Server supports TLS Fallback SCSV

  TLS renegotiation:
Secure session renegotiation supported

  TLS Compression:
Compression disabled

  Heartbleed:
TLSv1.2 not vulnerable to heartbleed
TLSv1.1 not vulnerable to heartbleed
TLSv1.0 not vulnerable to heartbleed

  Supported Server Cipher<span class="token punctuation">(</span>s<span class="token punctuation">)</span>:
Preferred TLSv1.2  128 bits  ECDHE-RSA-AES128-GCM-SHA256   Curve P-256 DHE 256
Accepted  TLSv1.2  128 bits  ECDHE-RSA-RC4-SHA             Curve P-256 DHE 256
Accepted  TLSv1.2  128 bits  ECDHE-RSA-AES128-SHA          Curve P-256 DHE 256
Accepted  TLSv1.2  256 bits  ECDHE-RSA-AES256-SHA          Curve P-256 DHE 256
Accepted  TLSv1.2  128 bits  AES128-SHA                   
Accepted  TLSv1.2  256 bits  AES256-SHA                   
Accepted  TLSv1.2  128 bits  RC4-SHA                      
Preferred TLSv1.1  128 bits  ECDHE-RSA-RC4-SHA             Curve P-256 DHE 256
Accepted  TLSv1.1  128 bits  ECDHE-RSA-AES128-SHA          Curve P-256 DHE 256
Accepted  TLSv1.1  256 bits  ECDHE-RSA-AES256-SHA          Curve P-256 DHE 256
Accepted  TLSv1.1  128 bits  AES128-SHA                   
Accepted  TLSv1.1  256 bits  AES256-SHA                   
Accepted  TLSv1.1  128 bits  RC4-SHA                      
Preferred TLSv1.0  128 bits  ECDHE-RSA-RC4-SHA             Curve P-256 DHE 256
Accepted  TLSv1.0  128 bits  ECDHE-RSA-AES128-SHA          Curve P-256 DHE 256
Accepted  TLSv1.0  256 bits  ECDHE-RSA-AES256-SHA          Curve P-256 DHE 256
Accepted  TLSv1.0  128 bits  AES128-SHA                   
Accepted  TLSv1.0  256 bits  AES256-SHA                   
Accepted  TLSv1.0  128 bits  RC4-SHA                      

  Server Key Exchange Group<span class="token punctuation">(</span>s<span class="token punctuation">)</span>:
TLSv1.2  128 bits  secp256r1 <span class="token punctuation">(</span>NIST P-256<span class="token punctuation">)</span>

  Server Signature Algorithm<span class="token punctuation">(</span>s<span class="token punctuation">)</span>:
TLSv1.2  Server accepts all signature algorithms.

  SSL Certificate:
Signature Algorithm: sha256WithRSAEncryption
RSA Key Strength:    2048

Subject:  baidu.com
Altnames: DNS:baidu.com, DNS:baifubao.com, DNS:www.baidu.cn, DNS:www.baidu.com.cn, DNS:mct.y.nuomi.com, DNS:apollo.auto, DNS:dwz.cn, DNS:*.baidu.com, DNS:*.baifubao.com, DNS:*.baidustatic.com, DNS:*.bdstatic.com, DNS:*.bdimg.com, DNS:*.hao123.com, DNS:*.nuomi.com, DNS:*.chuanke.com, DNS:*.trustgo.com, DNS:*.bce.baidu.com, DNS:*.eyun.baidu.com, DNS:*.map.baidu.com, DNS:*.mbd.baidu.com, DNS:*.fanyi.baidu.com, DNS:*.baidubce.com, DNS:*.mipcdn.com, DNS:*.news.baidu.com, DNS:*.baidupcs.com, DNS:*.aipage.com, DNS:*.aipage.cn, DNS:*.bcehost.com, DNS:*.safe.baidu.com, DNS:*.im.baidu.com, DNS:*.baiducontent.com, DNS:*.dlnel.com, DNS:*.dlnel.org, DNS:*.dueros.baidu.com, DNS:*.su.baidu.com, DNS:*.91.com, DNS:*.hao123.baidu.com, DNS:*.apollo.auto, DNS:*.xueshu.baidu.com, DNS:*.bj.baidubce.com, DNS:*.gz.baidubce.com, DNS:*.smartapps.cn, DNS:*.bdtjrcv.com, DNS:*.hao222.com, DNS:*.haokan.com, DNS:*.pae.baidu.com, DNS:*.vd.bdstatic.com, DNS:click.hm.baidu.com, DNS:log.hm.baidu.com, DNS:cm.pos.baidu.com, DNS:wn.pos.baidu.com, DNS:update.pan.baidu.com
Issuer:   GlobalSign Organization Validation CA - SHA256 - G2

Not valid before: Apr  2 07:04:58 2020 GMT
Not valid after:  Jul 26 05:31:02 2021 GMT<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-3-sslscan原理"><a href="#2-3-sslscan原理" class="headerlink" title="2.3 sslscan原理"></a>2.3 sslscan原理</h3><p>① sslscan通过创建多个https的连接来试探服务器支持的加密方式；</p><p>② 当使用https连接到服务器的时候，会交换双方所支持的加密方式，之后选择双发都能支持的方式进行通信；</p><p>​ 如果https服务器配置不当，就会存在MITM攻击，攻击者就可以通过客户端支持的弱加密算法来欺骗服务器；</p><p>​ 假如使用的是SSLV2的56位DES，当攻击者拦截并使用了这种加密流量过后，可能在很短时间之内就能够破解加密密钥。</p><h3 id="2-4-功能"><a href="#2-4-功能" class="headerlink" title="2.4 功能"></a>2.4 功能</h3><p>① sslscan能够检测heartbleed，这是一个openssl的漏洞；</p><p>​ heartbleed漏洞存在于OpenSSL TSL中，它由一个缓冲区导致，允许从内存中读取数据；实际上，Heartbleed 可以在任何未装补丁的支持 TLS 的 OpenSSL （1.0.1 到 1.0.1f 之间）服务器上利用；它从服务器内存中读取 64 KB 的纯文本数据，这能够重复执行，服务器上不会留下任何踪迹或日志。 这意味着攻击者可以从服务器读取纯文本信息，包括服务器的的私钥或者加密方式，会话 Cookie 或 HTTPS 请求会包含用户的密码或其它敏感信息。</p><h2 id="3-nmap"><a href="#3-nmap" class="headerlink" title="3 nmap"></a>3 nmap</h2><p><a target="_blank" rel="noopener" href="https://jumpnowtek.com/security/Using-nmap-to-check-certs-and-supported-algos.html">https://jumpnowtek.com/security/Using-nmap-to-check-certs-and-supported-algos.html</a></p><p>查看证书</p><p>支持的密码套件</p><p>检测漏洞：心脏滴血 Poodle drown 等漏洞</p><h3 id="3-1-安装"><a href="#3-1-安装" class="headerlink" title="3.1 安装"></a>3.1 安装</h3><pre class="line-numbers language-bash"><code class="language-bash">yum <span class="token function">install</span> nmap    <span class="token comment" spellcheck="true">#输入y安装</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="3-2-使用"><a href="#3-2-使用" class="headerlink" title="3.2 使用"></a>3.2 使用</h3><p>（1）查看证书nmap –script ssl-cert -p 443 baidu.com</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@localname ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># nmap --script ssl-cert -p 443 baidu.com</span>
Starting Nmap 6.40 <span class="token punctuation">(</span> http://nmap.org <span class="token punctuation">)</span> at 2020-08-20 16:22 CST
Nmap scan report <span class="token keyword">for</span> baidu.com <span class="token punctuation">(</span>39.156.69.79<span class="token punctuation">)</span>
Host is up <span class="token punctuation">(</span>0.0085s latency<span class="token punctuation">)</span>.
Other addresses <span class="token keyword">for</span> baidu.com <span class="token punctuation">(</span>not scanned<span class="token punctuation">)</span>: 220.181.38.148
PORT    STATE SERVICE
443/tcp <span class="token function">open</span>  https
<span class="token operator">|</span> ssl-cert: Subject: commonName<span class="token operator">=</span>www.baidu.cn/organizationName<span class="token operator">=</span>BeiJing Baidu Netcom Science Technology Co., Ltd/stateOrProvinceName<span class="token operator">=</span>Beijing/countryName<span class="token operator">=</span>CN
<span class="token operator">|</span> Issuer: commonName<span class="token operator">=</span>DigiCert SHA2 Secure Server CA/organizationName<span class="token operator">=</span>DigiCert Inc/countryName<span class="token operator">=</span>US
<span class="token operator">|</span> Public Key type: rsa
<span class="token operator">|</span> Public Key bits: 2048
<span class="token operator">|</span> Not valid before: 2020-02-27T00:00:00+00:00
<span class="token operator">|</span> Not valid after:  2021-02-26T12:00:00+00:00
<span class="token operator">|</span> MD5:   d0cf b084 759f 231b 9b22 c197 6bd5 d271
<span class="token operator">|</span>_SHA-1: e357 f6c5 b7d3 7464 8055 89c9 3797 c98d 9d38 2497

Nmap done: 1 IP address <span class="token punctuation">(</span>1 host up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> 0.60 seconds
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>（2）查看支持的TLS密码套件nmap –script ssl-enum-ciphers -p 443 baidu.com</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@localname ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># nmap --script ssl-enum-ciphers -p 443 baidu.com</span>

Starting Nmap 6.40 <span class="token punctuation">(</span> http://nmap.org <span class="token punctuation">)</span> at 2020-08-20 16:23 CST
Nmap scan report <span class="token keyword">for</span> baidu.com <span class="token punctuation">(</span>220.181.38.148<span class="token punctuation">)</span>
Host is up <span class="token punctuation">(</span>0.0093s latency<span class="token punctuation">)</span>.
Other addresses <span class="token keyword">for</span> baidu.com <span class="token punctuation">(</span>not scanned<span class="token punctuation">)</span>: 39.156.69.79
PORT    STATE SERVICE
443/tcp <span class="token function">open</span>  https
<span class="token operator">|</span> ssl-enum-ciphers: 
<span class="token operator">|</span>   SSLv3: 
<span class="token operator">|</span>     ciphers: 
<span class="token operator">|</span>       TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA - strong
<span class="token operator">|</span>       TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA - strong
<span class="token operator">|</span>       TLS_ECDHE_RSA_WITH_RC4_128_SHA - strong
<span class="token operator">|</span>       TLS_RSA_WITH_AES_128_CBC_SHA - strong
<span class="token operator">|</span>       TLS_RSA_WITH_AES_256_CBC_SHA - strong
<span class="token operator">|</span>       TLS_RSA_WITH_RC4_128_SHA - strong
<span class="token operator">|</span>     compressors: 
<span class="token operator">|</span>       NULL
<span class="token operator">|</span>   TLSv1.0: 
<span class="token operator">|</span>     ciphers: 
<span class="token operator">|</span>       TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA - strong
<span class="token operator">|</span>       TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA - strong
<span class="token operator">|</span>       TLS_ECDHE_RSA_WITH_RC4_128_SHA - strong
<span class="token operator">|</span>       TLS_RSA_WITH_AES_128_CBC_SHA - strong
<span class="token operator">|</span>       TLS_RSA_WITH_AES_256_CBC_SHA - strong
<span class="token operator">|</span>       TLS_RSA_WITH_RC4_128_SHA - strong
<span class="token operator">|</span>     compressors: 
<span class="token operator">|</span>       NULL
<span class="token operator">|</span>   TLSv1.1: 
<span class="token operator">|</span>     ciphers: 
<span class="token operator">|</span>       TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA - strong
<span class="token operator">|</span>       TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA - strong
<span class="token operator">|</span>       TLS_ECDHE_RSA_WITH_RC4_128_SHA - strong
<span class="token operator">|</span>       TLS_RSA_WITH_AES_128_CBC_SHA - strong
<span class="token operator">|</span>       TLS_RSA_WITH_AES_256_CBC_SHA - strong
<span class="token operator">|</span>       TLS_RSA_WITH_RC4_128_SHA - strong
<span class="token operator">|</span>     compressors: 
<span class="token operator">|</span>       NULL
<span class="token operator">|</span>   TLSv1.2: 
<span class="token operator">|</span>     ciphers: 
<span class="token operator">|</span>       TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA - strong
<span class="token operator">|</span>       TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 - strong
<span class="token operator">|</span>       TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 - strong
<span class="token operator">|</span>       TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA - strong
<span class="token operator">|</span>       TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 - strong
<span class="token operator">|</span>       TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 - strong
<span class="token operator">|</span>       TLS_ECDHE_RSA_WITH_RC4_128_SHA - strong
<span class="token operator">|</span>       TLS_RSA_WITH_AES_128_CBC_SHA - strong
<span class="token operator">|</span>       TLS_RSA_WITH_AES_128_CBC_SHA256 - strong
<span class="token operator">|</span>       TLS_RSA_WITH_AES_128_GCM_SHA256 - strong
<span class="token operator">|</span>       TLS_RSA_WITH_AES_256_CBC_SHA - strong
<span class="token operator">|</span>       TLS_RSA_WITH_AES_256_CBC_SHA256 - strong
<span class="token operator">|</span>       TLS_RSA_WITH_AES_256_GCM_SHA384 - strong
<span class="token operator">|</span>       TLS_RSA_WITH_RC4_128_SHA - strong
<span class="token operator">|</span>     compressors: 
<span class="token operator">|</span>       NULL
<span class="token operator">|</span>_  least strength: strong

Nmap done: 1 IP address <span class="token punctuation">(</span>1 host up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> 2.23 seconds<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>(3) More</p><p>您还可以使用Nmap脚本查找众所周知的ssl和tls漏洞</p><ul><li><a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/scripts/ssl-ccs-injection.html">ssl-ccs-injection</a>：允许MITM攻击的连接设置错误（<a target="_blank" rel="noopener" href="http://ccsinjection.lepidum.co.jp/">ccs-injection-vuln</a>，<a target="_blank" rel="noopener" href="https://www.tripwire.com/state-of-security/vulnerability-management/openssl-ccs-injection-primer/">ccs-injection-primer</a>）</li><li><a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/scripts/ssl-cert-intaddr.html">ssl-cert-intaddr</a>：内部IP地址泄漏</li><li><a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/scripts/ssl-date.html">ssl-date</a>：远程服务器时间泄漏</li><li><a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/scripts/ssl-dh-params.html">ssl-dh-params</a>：使用弱<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange">Diffie-Hellman</a>参数</li><li><a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/scripts/ssl-heartbleed.html">ssl-heartbleed</a>：易受OpenSSL <a target="_blank" rel="noopener" href="https://www.us-cert.gov/ncas/alerts/TA14-098A">Heartbleed </a><a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/scripts/ssl-heartbleed.html">攻击</a></li><li><a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/scripts/ssl-known-key.html">ssl-known-key</a>：服务器正在使用已知的错误证书</li><li><a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/scripts/ssl-poodle.html">ssl-poodle</a>：服务器允许易受攻击的SSLv3 CBC密码（<a target="_blank" rel="noopener" href="https://www.us-cert.gov/ncas/alerts/TA14-290A">POODLE</a>）</li><li><a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/scripts/sslv2.html">sslv2</a>：服务器允许使用过时的SSLv2密码</li><li><a target="_blank" rel="noopener" href="https://nmap.org/nsedoc/scripts/sslv2-drown.html">sslv2-drown</a>：服务器允许与<a target="_blank" rel="noopener" href="https://www.us-cert.gov/ncas/current-activity/2016/03/01/SSLv2-DROWN-Attack">DROWN</a>攻击相关的SSLv2密码</li></ul><h2 id="4-testssl"><a href="#4-testssl" class="headerlink" title="4 testssl"></a>4 testssl</h2><p>testssl.sh是我们首选的测试工具，它涵盖了TLS和SSL评估所需的所有测试所需工具，并定期更新。</p><h3 id="4-1-安装"><a href="#4-1-安装" class="headerlink" title="4.1 安装"></a>4.1 安装</h3><pre><code>git clone https://github.com/drwetter/testssl.sh.git</code></pre><h3 id="4-2-testssl-sh示例"><a href="#4-2-testssl-sh示例" class="headerlink" title="4.2 testssl.sh示例"></a>4.2 testssl.sh示例</h3><p>有许多可以用于testssl.sh的测试选项，您应该使用的选项将在很大程度上取决于您的测试要求。以下是部分有关testssl.sh命令行选项的示例。运行./testssl.sh可以看到所有选项。详情见 <a target="_blank" rel="noopener" href="https://testssl.sh/">https://testssl.sh/</a></p><pre><code>[root@m01ly ~]#  cd testssl.sh
[root@m01ly testssl.sh]# ./testssl.sh -e www.baidu.com</code></pre><h4 id="4-2-1-测试单个主机上的所有内容并输出到控制台"><a href="#4-2-1-测试单个主机上的所有内容并输出到控制台" class="headerlink" title="4.2.1 测试单个主机上的所有内容并输出到控制台"></a>4.2.1 测试单个主机上的所有内容并输出到控制台</h4><pre><code>./testssl.sh -e -E -f -p -y -Y -S -P -c -H -U TARGET-HOST</code></pre><h4 id="4-2-2-测试单个主机上的所有内容并输出到HTML"><a href="#4-2-2-测试单个主机上的所有内容并输出到HTML" class="headerlink" title="4.2.2 测试单个主机上的所有内容并输出到HTML"></a>4.2.2 测试单个主机上的所有内容并输出到HTML</h4><pre><code>./testssl.sh -e -E -f -p -y -Y -S -P -c -H -U TARGET-HOST | aha&gt; OUTPUT-FILE.html</code></pre><h4 id="4-2-3测试子网上的所有主机并输出到HTML"><a href="#4-2-3测试子网上的所有主机并输出到HTML" class="headerlink" title="4.2.3测试子网上的所有主机并输出到HTML"></a>4.2.3测试子网上的所有主机并输出到HTML</h4><pre><code>./testssl.sh -e -E -f -p -y -Y -S -P -c -H -U 192.168.1.0/24 | aha&gt; OUTPUT-FILE.html</code></pre><p>与上述相同，但只列举每个服务器支持的密码类型：</p><pre><code>./testssl.sh -E 192.168.1.0/24 | aha&gt; OUTPUT-FILE.html</code></pre><p>还有很多功能。</p><h2 id="5-SSLyze"><a href="#5-SSLyze" class="headerlink" title="5 SSLyze"></a>5 SSLyze</h2><h3 id="5-1-安装"><a href="#5-1-安装" class="headerlink" title="5.1 安装"></a>5.1 安装</h3><pre class="line-numbers language-bash"><code class="language-bash">$ pip <span class="token function">install</span> --upgrade setuptools
$ pip <span class="token function">install</span> --upgrade sslyze<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="5-2-使用"><a href="#5-2-使用" class="headerlink" title="5.2 使用"></a>5.2 使用</h3><pre class="line-numbers language-bash"><code class="language-bash">$ python -m sslyze --regular www.yahoo.com:443 www.google.com<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash"><code class="language-bash"> SCAN RESULTS FOR WWW.YAHOO.COM:443 - 202.165.107.50
 ---------------------------------------------------
 * Deflate Compression:
                                          OK - Compression disabled
 * SSLV3 Cipher Suites:
      Server rejected all cipher suites.
 * TLSV1 Cipher Suites:
       Forward Secrecy                    OK - Supported
       RC4                                OK - Not Supported
     Preferred:
        TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA              ECDH-256 bits  128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
     Accepted:
        TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA                ECDH-256 bits  256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA              ECDH-256 bits  256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_RSA_WITH_AES_256_CBC_SHA                      -              256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA              ECDH-256 bits  128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA                ECDH-256 bits  128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_RSA_WITH_AES_128_CBC_SHA                      -              128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 

 * Session Renegotiation:
       Client-initiated Renegotiation:    OK - Rejected
       Secure Renegotiation:              OK - Supported

 * OpenSSL CCS Injection:
                                          OK - Not vulnerable to OpenSSL CCS injection

 * SSLV2 Cipher Suites:
      Server rejected all cipher suites.

 * Certificate Information:
     Content
       SHA1 Fingerprint:                  3672d010de4097e1d06898229df2821a1b49a2a1
       Common Name:                       *.www.yahoo.com
       Issuer:                            DigiCert SHA2 High Assurance Server CA
       Serial Number:                     9093429354078714021559623999443547105
       Not Before:                        2020-05-11 00:00:00
       Not After:                         2020-11-07 12:00:00
       Signature Algorithm:               sha256
       Public Key Algorithm:              EllipticCurve
       Key Size:                          256
       Curve:                             secp256r1
       DNS Subject Alternative Names:     <span class="token punctuation">[</span>u<span class="token string">'yahoo.com'</span>, u<span class="token string">'*.yahoo.com'</span>, u<span class="token string">'*.www.yahoo.com'</span>, u<span class="token string">'mbp.yimg.com'</span>, u<span class="token string">'*.media.yahoo.com'</span>, u<span class="token string">'brb.yahoo.net'</span>, u<span class="token string">'*.att.yahoo.com'</span>, u<span class="token string">'s.yimg.com'</span>, u<span class="token string">'*.amp.yimg.com'</span>, u<span class="token string">'fr-ca.rogers.yahoo.com'</span>, u<span class="token string">'tw.rd.yahoo.com'</span>, u<span class="token string">'ddl.fp.yahoo.com'</span>, u<span class="token string">'ca.rogers.yahoo.com'</span>, u<span class="token string">'ca.my.yahoo.com'</span>, u<span class="token string">'add.my.yahoo.com'</span>, u<span class="token string">'*.global.vespa.oath.cloud'</span>, u<span class="token string">'hk.rd.yahoo.com'</span><span class="token punctuation">]</span>

     Trust
       Hostname Validation:               OK - Certificate matches www.yahoo.com
       Android CA Store <span class="token punctuation">(</span>8.1.0_r9<span class="token punctuation">)</span>:       OK - Certificate is trusted
       iOS CA Store <span class="token punctuation">(</span>11<span class="token punctuation">)</span>:                 OK - Certificate is trusted
       Java CA Store <span class="token punctuation">(</span>jre-10.0.2<span class="token punctuation">)</span>:        OK - Certificate is trusted
       macOS CA Store <span class="token punctuation">(</span>High Sierra<span class="token punctuation">)</span>:      OK - Certificate is trusted
       Mozilla CA Store <span class="token punctuation">(</span>2018-04-12<span class="token punctuation">)</span>:     OK - Certificate is trusted
       Windows CA Store <span class="token punctuation">(</span>2018-06-30<span class="token punctuation">)</span>:     OK - Certificate is trusted
       Symantec 2018 Deprecation:         OK - Not a Symantec-issued certificate
       Received Chain:                    *.www.yahoo.com --<span class="token operator">></span> DigiCert SHA2 High Assurance Server CA
       Verified Chain:                    *.www.yahoo.com --<span class="token operator">></span> DigiCert SHA2 High Assurance Server CA --<span class="token operator">></span> DigiCert High Assurance EV Root CA
       Received Chain Contains Anchor:    OK - Anchor certificate not sent
       Received Chain Order:              OK - Order is valid
       Verified Chain contains SHA1:      OK - No SHA1-signed certificate <span class="token keyword">in</span> the verified certificate chain

     Extensions
       OCSP Must-Staple:                  NOT SUPPORTED - Extension not found
       Certificate Transparency:          WARNING - Only 2 SCTs included but Google recommends 3 or <span class="token function">more</span>

     OCSP Stapling
       OCSP Response Status:              successful
       Validation w/ Mozilla Store:       OK - Response is trusted
       Responder Id:                      5168FF90AF0207753CCCD9656462A212B859723B
       Cert Status:                       good
       Cert Serial Number:                06D754AE96D28371A4DEF60AC211B3E1
       This Update:                       Aug 19 15:03:00 2020 GMT
       Next Update:                       Aug 26 14:18:00 2020 GMT

 * Resumption Support:
      With Session IDs:                  NOT SUPPORTED <span class="token punctuation">(</span>0 successful, 5 failed, 0 errors, 5 total attempts<span class="token punctuation">)</span>.
      With TLS Tickets:                  OK - Supported

 * TLSV1_1 Cipher Suites:
       Forward Secrecy                    OK - Supported
       RC4                                OK - Not Supported

     Preferred:
        TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA              ECDH-256 bits  128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
     Accepted:
        TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA                ECDH-256 bits  256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA              ECDH-256 bits  256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_RSA_WITH_AES_256_CBC_SHA                      -              256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA              ECDH-256 bits  128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA                ECDH-256 bits  128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_RSA_WITH_AES_128_CBC_SHA                      -              128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 

 * TLSV1_3 Cipher Suites:
      Server rejected all cipher suites.

 * OpenSSL Heartbleed:
                                          OK - Not vulnerable to Heartbleed

 * Downgrade Attacks:
       TLS_FALLBACK_SCSV:                 OK - Supported

 * ROBOT Attack:
                                          OK - Not vulnerable

 * TLSV1_2 Cipher Suites:
       Forward Secrecy                    OK - Supported
       RC4                                OK - Not Supported

     Preferred:
        TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256           ECDH-256 bits  128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
     Accepted:
        RSA_WITH_AES_256_CCM_8                            -              256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256       -              256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384           ECDH-256 bits  256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        RSA_WITH_AES_256_CCM                              -              256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA                ECDH-256 bits  256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_RSA_WITH_AES_256_CBC_SHA256                   -              256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384             ECDH-256 bits  256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        ECDHE_ECDSA_WITH_AES_256_CCM                      -              256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384           ECDH-256 bits  256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA              ECDH-256 bits  256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384             ECDH-256 bits  256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256     -              256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        ECDHE_ECDSA_WITH_AES_256_CCM_8                    -              256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_RSA_WITH_AES_256_CBC_SHA                      -              256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_RSA_WITH_AES_256_GCM_SHA384                   -              256 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA              ECDH-256 bits  128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        RSA_WITH_AES_128_CCM_8                            -              128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA                ECDH-256 bits  128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        ECDHE_ECDSA_WITH_AES_128_CCM                      -              128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        RSA_WITH_AES_128_CCM                              -              128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        ECDHE_ECDSA_WITH_AES_128_CCM_8                    -              128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256             ECDH-256 bits  128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_RSA_WITH_AES_128_CBC_SHA                      -              128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_RSA_WITH_AES_128_CBC_SHA256                   -              128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256           ECDH-256 bits  128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_RSA_WITH_AES_128_GCM_SHA256                   -              128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256             ECDH-256 bits  128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 
        TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256           ECDH-256 bits  128 bits      HTTP 302 Found - https://hk.yahoo.com/?p<span class="token operator">=</span>us                 

 SCAN COMPLETED IN 7.29 S<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="6-TLSSLed"><a href="#6-TLSSLed" class="headerlink" title="6 TLSSLed"></a>6 TLSSLed</h2><p>该工具是基于sslscan的脚本工具，使用非常简单。用户可以一次性执行所有检测任务，并且会生成详细的日志文件。它可以检测支持的协议类型、空密码和弱密码以及强密码等功能。</p><pre><code>[root@localhost ~]# yum install tlssled
[root@localhost ~]# tlssled [ip/domain] 443</code></pre><pre class="line-numbers language-bash"><code class="language-bash"><span class="token punctuation">[</span>root@localname ~<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># tlssled www.baidu.com 443</span>
------------------------------------------------------
 TLSSLed - <span class="token punctuation">(</span>1.3<span class="token punctuation">)</span> based on sslscan and openssl
                 by Raul Siles <span class="token punctuation">(</span>www.taddong.com<span class="token punctuation">)</span>
------------------------------------------------------
    openssl version: OpenSSL 1.1.1g  21 Apr 2020
    sslscan version 1.10.2 
------------------------------------------------------
    Date: 20200821-110138
------------------------------------------------------

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Analyzing SSL/TLS on www.baidu.com:443 <span class="token punctuation">..</span>.
    <span class="token punctuation">[</span>.<span class="token punctuation">]</span> Output directory: TLSSLed_1.3_www.baidu.com_443_20200821-110138 <span class="token punctuation">..</span>.

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Checking <span class="token keyword">if</span> the target <span class="token function">service</span> speaks SSL/TLS<span class="token punctuation">..</span>.
    <span class="token punctuation">[</span>.<span class="token punctuation">]</span> The target <span class="token function">service</span> www.baidu.com:443 seems to speak SSL/TLS<span class="token punctuation">..</span>.

    <span class="token punctuation">[</span>.<span class="token punctuation">]</span> Using SSL/TLS protocol version: 
        <span class="token punctuation">(</span>empty means I'm using the default openssl protocol version<span class="token punctuation">(</span>s<span class="token punctuation">))</span>

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Running sslscan on www.baidu.com:443 <span class="token punctuation">..</span>.

    <span class="token punctuation">[</span>-<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> SSLv2 <span class="token punctuation">..</span>.

    <span class="token punctuation">[</span>-<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> the NULL cipher <span class="token punctuation">..</span>.

    <span class="token punctuation">[</span>-<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> weak ciphers <span class="token punctuation">(</span>based on key length - 40 or 56 bits<span class="token punctuation">)</span> <span class="token punctuation">..</span>.

    <span class="token punctuation">[</span>+<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> strong ciphers <span class="token punctuation">(</span>based on AES<span class="token punctuation">)</span> <span class="token punctuation">..</span>.
    Accepted  TLSv1  256 bits  ECDHE-RSA-AES256-SHA
    Accepted  TLSv1  256 bits  AES256-SHA
    Accepted  TLSv1  128 bits  ECDHE-RSA-AES128-SHA
    Accepted  TLSv1  128 bits  AES128-SHA
    Accepted  TLS11  256 bits  ECDHE-RSA-AES256-SHA
    Accepted  TLS11  256 bits  AES256-SHA
    Accepted  TLS11  128 bits  ECDHE-RSA-AES128-SHA
    Accepted  TLS11  128 bits  AES128-SHA
    Accepted  TLS12  256 bits  ECDHE-RSA-AES256-SHA
    Accepted  TLS12  256 bits  AES256-SHA
    Accepted  TLS12  128 bits  ECDHE-RSA-AES128-GCM-SHA256
    Accepted  TLS12  128 bits  ECDHE-RSA-AES128-SHA
    Accepted  TLS12  128 bits  AES128-SHA

    <span class="token punctuation">[</span>-<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> MD5 signed certificate <span class="token punctuation">..</span>.

    <span class="token punctuation">[</span>.<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> the certificate public key length <span class="token punctuation">..</span>.

    <span class="token punctuation">[</span>.<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> the certificate subject <span class="token punctuation">..</span>.

    <span class="token punctuation">[</span>.<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> the certificate CA issuer <span class="token punctuation">..</span>.

    <span class="token punctuation">[</span>.<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> the certificate validity period <span class="token punctuation">..</span>.
    Today: Fri Aug 21 03:02:05 UTC 2020

    <span class="token punctuation">[</span>.<span class="token punctuation">]</span> Checking preferred server ciphers <span class="token punctuation">..</span>.


<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> SSL/TLS renegotiation MitM vuln. <span class="token punctuation">(</span>CVE-2009-3555<span class="token punctuation">)</span> <span class="token punctuation">..</span>.

    <span class="token punctuation">[</span>+<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> secure renegotiation support <span class="token punctuation">(</span>RFC 5746<span class="token punctuation">)</span> <span class="token punctuation">..</span>.
    Secure Renegotiation IS supported

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> SSL/TLS renegotiation DoS vuln. <span class="token punctuation">(</span>CVE-2011-1473<span class="token punctuation">)</span> <span class="token punctuation">..</span>.

    <span class="token punctuation">[</span>.<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> client initiated <span class="token punctuation">(</span>CI<span class="token punctuation">)</span> SSL/TLS renegotiation <span class="token punctuation">(</span>secure<span class="token punctuation">)</span><span class="token punctuation">..</span>.
    <span class="token punctuation">(</span>CI<span class="token punctuation">)</span> SSL/TLS renegotiation IS NOT enabled <span class="token punctuation">(</span>no renegotiation<span class="token punctuation">)</span>

    <span class="token punctuation">[</span>.<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> client initiated <span class="token punctuation">(</span>CI<span class="token punctuation">)</span> SSL/TLS renegotiation <span class="token punctuation">(</span>insecure<span class="token punctuation">)</span><span class="token punctuation">..</span>.
    <span class="token punctuation">(</span>CI<span class="token punctuation">)</span> SSL/TLS renegotiation IS NOT enabled <span class="token punctuation">(</span>no renegotiation<span class="token punctuation">)</span>

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> client authentication using digital certificates <span class="token punctuation">..</span>.

    SSL/TLS client certificate authentication IS NOT required

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> TLS v1.1 and v1.2 <span class="token punctuation">(</span>CVE-2011-3389 vuln. aka BEAST<span class="token punctuation">)</span> <span class="token punctuation">..</span>.

    <span class="token punctuation">[</span>-<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> SSLv3 and TLSv1 support <span class="token punctuation">..</span>.
    Accepted  SSLv3  112 bits  RC4-SHA
    Accepted  TLSv1  256 bits  ECDHE-RSA-AES256-SHA
    Accepted  TLSv1  256 bits  AES256-SHA
    Accepted  TLSv1  128 bits  ECDHE-RSA-AES128-SHA
    Accepted  TLSv1  128 bits  AES128-SHA
    Accepted  TLSv1  112 bits  ECDHE-RSA-RC4-SHA
    Accepted  TLSv1  112 bits  RC4-SHA

    <span class="token punctuation">[</span>+<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> RC4 <span class="token keyword">in</span> the prefered cipher<span class="token punctuation">(</span>s<span class="token punctuation">)</span> list <span class="token punctuation">..</span>.

    <span class="token punctuation">[</span>.<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> TLS v1.1 support <span class="token punctuation">..</span>.
    TLS v1.1 IS supported

    <span class="token punctuation">[</span>.<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> TLS v1.2 support <span class="token punctuation">..</span>.
    TLS v1.2 IS supported

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> HTTPS <span class="token punctuation">(</span>SSL/TLS<span class="token punctuation">)</span> security headers using HTTP/1.0 <span class="token punctuation">..</span>.
    <span class="token punctuation">[</span>+<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> HTTP Strict-Transport-Security <span class="token punctuation">(</span>HSTS<span class="token punctuation">)</span> header <span class="token punctuation">..</span>.
    <span class="token punctuation">[</span>+<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> cookies with the secure flag <span class="token punctuation">..</span>.
    <span class="token punctuation">[</span>-<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> cookies without the secure flag <span class="token punctuation">..</span>.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> HTTPS <span class="token punctuation">(</span>SSL/TLS<span class="token punctuation">)</span> security headers using HTTP/1.1 <span class="token operator">&amp;</span> Host <span class="token punctuation">..</span>.
    <span class="token punctuation">[</span>+<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> HTTP Strict-Transport-Security <span class="token punctuation">(</span>HSTS<span class="token punctuation">)</span> header <span class="token punctuation">..</span>.
    <span class="token punctuation">[</span>+<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> cookies with the secure flag <span class="token punctuation">..</span>.
    <span class="token punctuation">[</span>-<span class="token punctuation">]</span> Testing <span class="token keyword">for</span> cookies without the secure flag <span class="token punctuation">..</span>.
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> New files created:
    <span class="token punctuation">[</span>.<span class="token punctuation">]</span> Output directory: TLSSLed_1.3_www.baidu.com_443_20200821-110138 <span class="token punctuation">..</span>.
openssl_HEAD_1.0_www.baidu.com_443_20200821-110138.err    openssl_HEAD_www.baidu.com_443_20200821-110138.log        openssl_RENEG_www.baidu.com_443_20200821-110138.err
openssl_HEAD_1.0_www.baidu.com_443_20200821-110138.log    openssl_RENEG_LEGACY_www.baidu.com_443_20200821-110138.err  openssl_RENEG_www.baidu.com_443_20200821-110138.log
openssl_HEAD_www.baidu.com_443_20200821-110138.err    openssl_RENEG_LEGACY_www.baidu.com_443_20200821-110138.log  sslscan_www.baidu.com_443_20200821-110138.log
<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="7-openssl"><a href="#7-openssl" class="headerlink" title="7 openssl"></a>7 openssl</h2><pre><code> openssl s_client -connect www.baidu.com:443　　【s_client:作为一个客户端 -connect：连接 +服务器域名:端口】 </code></pre><p><img src="/2020/08/26/htps-tools/1598432415793.png" alt="1598432415793"></p><p><img src="/2020/08/26/htps-tools/1596439698251.png" alt="1596439698251"></p><h2 id="REF"><a href="#REF" class="headerlink" title="REF"></a>REF</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42696904/article/details/85267927?utm_medium=distribute.pc_relevant.none-task-blog-baidulandingword-1&amp;spm=1001.2101.3001.4242">https://blog.csdn.net/qq_42696904/article/details/85267927?utm_medium=distribute.pc_relevant.none-task-blog-baidulandingword-1&amp;spm=1001.2101.3001.4242</a></p><p><a target="_blank" rel="noopener" href="https://github.com/nabla-c0d3/sslyze">https://github.com/nabla-c0d3/sslyze</a></p><p><a target="_blank" rel="noopener" href="https://nabla-c0d3.github.io/sslyze/documentation/">https://nabla-c0d3.github.io/sslyze/documentation/</a></p><p><a target="_blank" rel="noopener" href="https://www.freebuf.com/sectool/99151.html">https://www.freebuf.com/sectool/99151.html</a></p><p><a target="_blank" rel="noopener" href="https://www.infinisign.com/faq/tls-ssl-security-testing">https://www.infinisign.com/faq/tls-ssl-security-testing</a></p><p><a target="_blank" rel="noopener" href="https://testssl.sh/">https://testssl.sh/</a></p><link href="//src.wangriyu.wang/lib/Aplayer/APlayer.min.css" rel="stylesheet"><script src="//src.wangriyu.wang/lib/Aplayer/APlayer.min.js"></script><div id="aplayer"></div><script src="/js/player.js"></script></div><div class="article-info article-info-index"><div class="article-count"><div class="article-tag tagcloud"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TLS/" rel="tag">TLS</a></li></ul></div><span class="post-count">总字数3.8k</span> <span class="post-count">预计阅读21分钟</span></div><div class="clearfix"></div></div></div></article><article id="post-htps-build" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2020/08/26/htps-build/" class="article-date"><time class="published" datetime="2020-08-26T08:29:43.000Z" itemprop="datePublished">2020-08-26 发布</time> <time class="updated" datetime="2020-09-03T13:12:56.628Z" itemprop="dateUpdated">2020-09-03 更新</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2020/08/26/htps-build/">搭建https网站</a></h1></header><div class="article-entry" itemprop="articleBody"><p>环境：centos 7</p><p>nginx 版本：1.19.1</p><h2 id="1-安装nginx"><a href="#1-安装nginx" class="headerlink" title="1 安装nginx"></a>1 安装nginx</h2><p>按照 <a target="_blank" rel="noopener" href="https://www.runoob.com/linux/nginx-install-setup.html">https://www.runoob.com/linux/nginx-install-setup.html</a> 教程安装即可，记得安装最新版。</p><pre><code>wget http://nginx.org/download/nginx-1.19.1.tar.gz</code></pre><p>nginx安装目录配置 nginx.conf 如下：/usr/local/webserver/nginx/conf</p><h2 id="2-自签名证书"><a href="#2-自签名证书" class="headerlink" title="2 自签名证书"></a>2 自签名证书</h2><h3 id="2-1-CA根证书的生成步骤"><a href="#2-1-CA根证书的生成步骤" class="headerlink" title="2.1 CA根证书的生成步骤"></a>2.1 CA根证书的生成步骤</h3><p>新建一个文件夹ssl</p><pre><code>mkdir ssl
cd ssl</code></pre><h4 id="2-1-1-生成私钥"><a href="#2-1-1-生成私钥" class="headerlink" title="2.1.1 生成私钥"></a>2.1.1 <strong>生成私钥</strong></h4><p>生成CA私钥（.key）–&gt;生成CA证书请求（.csr）–&gt;自签名得到根证书（.crt）（CA给自已颁发的证书）。</p><pre class="line-numbers language-csharp"><code class="language-csharp"><span class="token preprocessor property"># Generate CA private key </span>
openssl genrsa <span class="token operator">-</span><span class="token keyword">out</span> ca<span class="token punctuation">.</span>key <span class="token number">2048</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/2020/08/26/htps-build/1597046435726.png" alt="1597046435726"></p><h4 id="2-1-2-生成证书请求文件"><a href="#2-1-2-生成证书请求文件" class="headerlink" title="2.1.2   生成证书请求文件"></a>2.1.2 <strong>生成证书请求文件</strong></h4><p>这个过程会要求输入很多信息如国家、城市、组织信息等，其中 <code>Common Name (eg, your name or your server&#39;s hostname)</code> 是 <strong>必填项</strong> ，可以是域名或者 IP，其他都可以回车跳过，但是这样的话在签名证书时候会报错，下一章详述，不过自签名证书不影响。</p><pre><code># Generate CSR 
openssl req -new -key ca.key -out ca.csr</code></pre><p><img src="/2020/08/26/htps-build/1597046507003.png" alt="1597046507003"></p><h4 id="2-1-3-生成自签名证书"><a href="#2-1-3-生成自签名证书" class="headerlink" title="2.1.3    生成自签名证书"></a>2.1.3 <strong>生成自签名证书</strong></h4><pre><code># Generate Self Signed certificate（CA 根证书）
openssl x509 -req -days 365 -in ca.csr -signkey ca.key -out ca.crt</code></pre><p><img src="/2020/08/26/htps-build/1597046586371.png" alt="1597046586371"></p><h3 id="2-2-用户证书的生成步骤"><a href="#2-2-用户证书的生成步骤" class="headerlink" title="2.2 用户证书的生成步骤"></a>2.2 用户证书的生成步骤</h3><h4 id="2-2-1-生成私钥"><a href="#2-2-1-生成私钥" class="headerlink" title="2.2.1. 生成私钥"></a><strong>2.2.1. 生成私钥</strong></h4><p>生成私钥（.key）–&gt;生成证书请求（.csr）–&gt;用CA根证书签名得到证书（.crt）</p><p>服务器端用户证书：</p><pre class="line-numbers language-html"><code class="language-html"># private key
$openssl genrsa -des3 -out server.key 1024 <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/2020/08/26/htps-build/1597046728463.png" alt="1597046728463"></p><h4 id="2-2-2-生成证书请求"><a href="#2-2-2-生成证书请求" class="headerlink" title="2.2.2 生成证书请求"></a>2.2.2 生成证书请求</h4><pre><code># generate csr
$openssl req -new -key server.key -out server.csr</code></pre><p><img src="/2020/08/26/htps-build/1597046781761.png" alt="1597046781761"></p><h4 id="2-2-3-生成证书（根证书对用户的证书请求签名，最终生成用户证书）"><a href="#2-2-3-生成证书（根证书对用户的证书请求签名，最终生成用户证书）" class="headerlink" title="2.2.3  生成证书（根证书对用户的证书请求签名，最终生成用户证书）"></a>2.2.3 <strong>生成证书（根证书对用户的证书请求签名，最终生成用户证书）</strong></h4><p>使用 <code>x509</code> 工具生成证书，因为它默认不使用 <code>openssl.cnf</code></p><pre><code># generate certificate
$openssl x509 -req -in server.csr -CA ca.crt \
 -CAkey ca.key -out server.crt -CAcreateserial</code></pre><p><img src="/2020/08/26/htps-build/1597046922337.png" alt="1597046922337"></p><h4 id="2-2-4-验证证书有效性"><a href="#2-2-4-验证证书有效性" class="headerlink" title="2.2.4  验证证书有效性"></a>2.2.4 验证证书有效性</h4><pre><code>openssl verify -CAfile ca.crt server.crt</code></pre><p><img src="/2020/08/26/htps-build/1597047002938.png" alt="1597047002938"></p><h4 id="2-2-5-导出证书"><a href="#2-2-5-导出证书" class="headerlink" title="2.2.5 导出证书"></a>2.2.5 导出证书</h4><pre><code>cat server.crt server.key &gt; server.pem</code></pre><p><img src="/2020/08/26/htps-build/1597047735585.png" alt="1597047735585"></p><h2 id="3-配置nginx"><a href="#3-配置nginx" class="headerlink" title="3 配置nginx"></a>3 配置nginx</h2><p>将openssl生成的证书文件复制到nginx的目录下：</p><pre><code>[root@localname ~]#  cp -r ssl  /usr/local/webserver/nginx/conf/ssl</code></pre><h4 id="3-1-1-配置nginx-conf文件"><a href="#3-1-1-配置nginx-conf文件" class="headerlink" title="3.1.1 配置nginx.conf文件"></a>3.1.1 配置nginx.conf文件</h4><p>配置/usr/local/webserver/nginx/conf目录下的nginx.conf文件</p><pre><code>vim  /usr/local/webserver/nginx/conf/nginx.conf</code></pre><p>修改文件如下：</p><p><img src="/2020/08/26/htps-build/1597047296881.png" alt="1597047296881"></p><pre><code>server
  &#123;
    listen 443;#监听端口
    server_name 192.168.10.136;#域名
    index index.html index.htm index.php;
    root /usr/local/webserver/nginx/html;#站点目录
   #注意这些路径是相对于/etc/nginx/nginx.conf文件位置
    ssl on;
    ssl_certificate ssl/server.crt;
    ssl_certificate_key ssl/server.key;
    ssl_session_timeout 5m;
    ssl_protocols TLSv1 TLSv1.1 TLSv1.2; #按照这个协议配置
    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;#按照这个套件配置
    ssl_prefer_server_ciphers on;


    location ~ .*\.(php|php5)?$
    &#123;
      #fastcgi_pass unix:/tmp/php-cgi.sock;
      fastcgi_pass 127.0.0.1:9000;
      fastcgi_index index.php;
      include fastcgi.conf;
    &#125;
    location ~ .*\.(gif|jpg|jpeg|png|bmp|swf|ico)$
    &#123;
      expires 30d;
  # access_log off;
    &#125;
    location ~ .*\.(js|css)?$
    &#123;
      expires 15d;
   # access_log off;
    &#125;
    access_log off;
  &#125;</code></pre><h4 id="3-1-2-测试-停止-重启nginx服务"><a href="#3-1-2-测试-停止-重启nginx服务" class="headerlink" title="3.1.2  测试 /停止/重启nginx服务"></a>3.1.2 测试 /停止/重启nginx服务</h4><p>编译/usr/local/webserver/nginx/sbin/nginx -t</p><p><img src="/2020/08/26/htps-build/1597044719436.png" alt="1597044719436"></p><p>重启 nginx：/usr/local/webserver/nginx/sbin/nginx -s stop</p><p>启动：/usr/local/webserver/nginx/sbin/nginx</p><p>浏览器输入（本机ip地址）：<a target="_blank" rel="noopener" href="https://192.168.10.136/">https://192.168.10.136/</a></p><p><img src="/2020/08/26/htps-build/1597044598226.png" alt="1597044598226"></p><p><img src="/2020/08/26/htps-build/1597044868039.png" alt="1597044868039"></p><p>这时候发现浏览器提示不安全的链接,这个时候将根证书ca.crt导入浏览器,重启,发现提示消失了.</p><h2 id="4-nginx日常操作命令"><a href="#4-nginx日常操作命令" class="headerlink" title="4 nginx日常操作命令"></a>4 nginx日常操作命令</h2><p>nginx -t 测试配置文件<br>nginx -s reload 修改配置后重载生效<br>nginx -s reopen 重新打开日志文件<br>nginx -s stop 快速停止<br>nginx -s quit</p><p>查看nginx进程<br>ps -ef | grep nginx</p><h2 id="REF"><a href="#REF" class="headerlink" title="REF"></a>REF</h2><p><a target="_blank" rel="noopener" href="https://www.gokuweb.com/operation/d95eae05.html">https://www.gokuweb.com/operation/d95eae05.html</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/liuchunming033/article/details/48470575">https://blog.csdn.net/liuchunming033/article/details/48470575</a></p><p><a target="_blank" rel="noopener" href="https://juejin.im/post/6844903729632641031">https://juejin.im/post/6844903729632641031</a></p><link href="//src.wangriyu.wang/lib/Aplayer/APlayer.min.css" rel="stylesheet"><script src="//src.wangriyu.wang/lib/Aplayer/APlayer.min.js"></script><div id="aplayer"></div><script src="/js/player.js"></script></div><div class="article-info article-info-index"><div class="article-count"><div class="article-tag tagcloud"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TLS/" rel="tag">TLS</a></li></ul></div><span class="post-count">总字数847</span> <span class="post-count">预计阅读3分钟</span></div><div class="clearfix"></div></div></div></article><article id="post-apple" class="article article-type-post" itemscope itemprop="blogPost"><div class="article-meta"><a href="/2020/08/26/apple/" class="article-date"><time class="published" datetime="2020-08-26T07:38:15.000Z" itemprop="datePublished">2020-08-26 发布</time> <time class="updated" datetime="2021-02-03T09:20:18.427Z" itemprop="dateUpdated">2021-02-03 更新</time></a></div><div class="article-inner"><input type="hidden" class="isFancy"><header class="article-header"><h1 itemprop="name"><a class="article-title" href="/2020/08/26/apple/">竟然有人能把https/TLS1.2协议讲的这么详细</a></h1></header><div class="article-entry" itemprop="articleBody"><h2 id="1-https"><a href="#1-https" class="headerlink" title="1  https"></a>1 https</h2><p><strong>SSL</strong>(Secure Sockets Layer) 安全套接层，是一种安全协议，经历了 SSL 1.0、2.0、3.0 版本后发展成了标准安全协议 - <strong>TLS</strong>(Transport Layer Security) 传输层安全性协议。TLS 有 1.0 (RFC 2246)、1.1(RFC 4346)、1.2(RFC 5246)、1.3(RFC 8446) 版本。</p><img src="/2020/08/26/apple/1597202957092.png" alt="1597202957092" style="zoom:50%"><h3 id="1-1-安全协议必备元素"><a href="#1-1-安全协议必备元素" class="headerlink" title="1.1 安全协议必备元素"></a>1.1 安全协议必备元素</h3><p>在一个不安全的信道传输，我们需要保证三点:</p><p>(1)一是保证数据来源可靠性(身份认证)及在通信过程中数据的完整性（防篡改和防伪造），有数字签名和HMAC两种做法。数字签名是用私钥对报文进行签名生成数字签名，然后公钥对数字签名进行验证，常见的有SM2，RSA等；HMAC是通信两边用同一个密钥，运行常见的哈希函数MD5，SHA-1等进行哈希运算生成字符串，然后两边生成的字符串进行比较。具体细节，请参见XXXXXXXXX。</p><p>(2)另外一种是保证数据机密性，即对数据进行加密传输，加密算法分为对称算法和非对称算法，非对称算法有两个密钥，公钥加密，私钥解密，安全性较高，但加解密速度较慢，例如RSA加密算法；对称算法只有一个密钥，对称算法又分流加密（CR4等）和分组密码算法（AES，3DES等），流加密速度更快，相比于非对称加密，对称算法加解密速度较快，安全性较低。</p><p>(3)防重放:加入新鲜因子,随机数等.</p><img src="/2020/08/26/apple/1597634074757.png" alt="1597634074757" style="zoom:67%"><p>因此通常一个安全协议的设计需要满足基础三点，保证数据完整性（防篡改）和机密性，综合效率及安全性分析，通常的做法是将对称算法与非对称算法结合使用，即利用非对称算法协商出一个会话密钥，然后会话密钥作为对称算法的密钥进行加密，HMAC运行。</p><h3 id="1-2-TSL-协议体系结构"><a href="#1-2-TSL-协议体系结构" class="headerlink" title="1.2 TSL 协议体系结构"></a>1.2 TSL 协议体系结构</h3><img src="/2020/08/26/apple/1597635119718.png" alt="1597635119718" style="zoom:80%"><p>TLS的体系结构中包含两个协议子层，其中底层是SSL记录协议层（SSL Record Protocol Layer）；高层是SSL握手协议层（SSL HandShake Protocol Layer）。</p><p>TLS协议主要分为两层：</p><p>(1) TLS记录协议层的作用是为高层协议提供基本的安全服务。TLS记录协议针对HTTP协议进行了特别的设计，使得超文本的传输协议HTTP能够在TLS运行。纪录封装各种高层协议，具体实施压缩解压缩、加密解密、计算和校验MAC等与安全有关的操作。</p><p>(2) TLS握手协议层包括握手协议（HandShake Protocol）、密码参数修改协议（Change Cipher Spec Protocol）和告警协议（Alert Protocol）。握手层的这些协议用于管理信息的交换，允许应用协议传送数据之间相互验证，协商加密算法和生成密钥等。</p><p>其中最重要的是记录协议和握手协议：</p><p>(1) TLS记录协议：它建立在可靠的传输（如TCP）之上，为高层协议提供数据封装、压缩、加密等基本功能。</p><p>(2) TLS握手协议：它建立在TLS记录协议之上，用于在实际的数据传输开始之前，通讯双方进行身份认证、协商加密算法、交换加密密钥等。</p><p>如下图所示,可以看到TLS握手层是建立在TLS记录层之上的。</p><p><img src="/2020/08/26/apple/1597635346378.png" alt="1597635346378"></p><h3 id="1-3-TLS密码套件结构"><a href="#1-3-TLS密码套件结构" class="headerlink" title="1.3 TLS密码套件结构"></a>1.3 TLS密码套件结构</h3><p><img src="/2020/08/26/apple/1597654968578.png" alt="1597654968578"></p><p>密码套件是客户端与服务器约定交互过程中需要的密码算法系列，如上图所示，以TLS开头，</p><p>（1）第一个参数为密钥交换算法，即协商预主密钥pre-master key所用的算法，主要有两类。分别是</p><p>（a）基于Diffie-Hellman交换算法的：ECDHE，DHE，DH，ECDH</p><p>DH密钥交换原理如下图,图中的k即为pre-master key:</p><img src="/2020/08/26/apple/1597651450749.png" alt="1597651450749" style="zoom:67%"><p>DH和ECDH主要不同在于基于的困难问题稍有不同，DH是基于离散对数困难问题，而ECDH是基于椭圆曲线上的离散对数问题；任何基于离散对数上的都可以换算到椭圆曲线上。椭圆曲线上密钥长度只需要较短的即可达到基础域中较长的安全性，例如160比特的椭圆曲线密钥和1024比特的RSA密钥的安全性相当。越小的密钥在速度、效率、带宽、存储上有着许多优势 。</p><p>对于DHE与DH的主要不同在于后面有个E，E代表了“临时”，即在握手流程中，作为服务器端，ECDH少了一步计算Pb的过程，Pb用证书中的公钥代替，而证书对应的私钥就是Xb。由此可见，使用ECDH密钥交换算法，服务器必须采用ECC证书；服务器不发送server key exchange报文，因为发送certificate报文时，证书本身就包含了Pb信息。</p><p>（b）基于RSA的密钥交换算法：客户端利用RSA公钥加密pre-master key，服务器端私钥解密出预主密钥</p><img src="/2020/08/26/apple/1597651364544.png" alt="1597651364544" style="zoom:67%"><p>综上几种密钥交换算法比较如下表所示:</p><table><thead><tr><th></th><th>ECDHE</th><th>ECDH</th><th>DHE</th><th>DH</th><th>RSA</th></tr></thead><tbody><tr><td>server key exchange</td><td>Y</td><td>N（证书中的公钥Pb）</td><td>Y</td><td>N（证书中的公钥及Pb）</td><td>N</td></tr><tr><td>前向安全性</td><td>Y</td><td>N</td><td>Y</td><td>N</td><td>N</td></tr></tbody></table><p>（2）第二部分为身份认证算法，即数字签名算法，这里根据密码套件不同，代表的含义也不同。</p><p>（a）密钥交换算法为ECDHE情况下，签名算法指的是 serverkeyexchange被签名的算法，只有2种ECDSA和RSA，具体是哪种完全取决于证书的公钥类型（ECC RSA）。如果你的证书是ECC公钥，那么服务器不可能选择ECDHE_RSA这种套件。</p><p>（b）ECDH的情况下，签名算法 指的是 证书自身的被签名算法。 如果服务器部署的是RSA签名算法的证书，那么必须使用ECDH_RSA套件；反之亦然。</p><p>（3）第三部分AES_128_GCM，主要为加密算法，一般是加密算法+加密强度（128位/256位）+工作模式（CBC/GCM），用于后面加密传输所用的算法，保证数据传输过程中的机密性。</p><p>（4） 第四部分SHA256为哈希算法，用于HMAC和PRF，保证数据在传输过程中的完整性。</p><h2 id="2-https协议总框架"><a href="#2-https协议总框架" class="headerlink" title="2 https协议总框架"></a>2 https协议总框架</h2><p>如下图为https协议总框架,首先</p><p>非对称协商会话密钥，然后用会话密钥加密传输。</p><img src="/2020/08/26/apple/1597630781001.png" alt="1597630781001" style="zoom:67%"><p>下面以具体wireshark抓包具体报文进行解说。（密码套件TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256为例）拦截<a target="_blank" rel="noopener" href="http://www.google.com的https连接报文.其中2.1到2.6为握手层协议,2.7为记录协议/">www.google.com的https连接报文。其中2.1到2.6为握手层协议,2.7为记录协议</a>.</p><h3 id="2-1-Client-hello"><a href="#2-1-Client-hello" class="headerlink" title="2.1 Client hello"></a>2.1 Client hello</h3><p>这条消息是客户端向服务器端发送连接请求。</p><p><img src="/2020/08/26/apple/1597635473766.png" alt="1597635473766"></p><p>Version: 协议版本（protocol version）指示客户端支持的最佳协议版本</p><p>Random: 一个 32 字节数据，28 字节是随机生成的 (图中的 Random Bytes)；剩余的 4 字节包含额外的信息，与客户端时钟有关 (图中使用的是 GMT Unix Time)。在握手时，客户端和服务器都会提供随机数，客户端的暂记作 random_C (用于后续的密钥的生成)。这种随机性对每次握手都是独一无二的，在身份验证中起着举足轻重的作用。它可以防止 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E9%87%8D%E6%94%BE%E6%94%BB%E5%87%BB">重放攻击</a>，并确认初始数据交换的完整性。</p><p>Session ID: 在第一次连接时，会话 ID（session ID）字段是空的，这表示客户端并不希望恢复某个已存在的会话。典型的会话 ID 包含 32 字节随机生成的数据，一般由服务端生成通过 ServerHello 返回给客户端。</p><p>Cipher Suites: 密码套件（cipher suite）块是由客户端支持的所有密码套件组成的列表，该列表是按优先级顺序排列的.</p><pre><code>Cipher Suites (19 suites)
    Cipher Suite: TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384 (0xc02c)
    Cipher Suite: TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 (0xc02b)
    Cipher Suite: TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 (0xc030)
    Cipher Suite: TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 (0xc02f)
    Cipher Suite: TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 (0xc024)
    Cipher Suite: TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 (0xc023)
    Cipher Suite: TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 (0xc028)
    Cipher Suite: TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 (0xc027)
    Cipher Suite: TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA (0xc00a)
    Cipher Suite: TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA (0xc009)
    Cipher Suite: TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA (0xc014)
    Cipher Suite: TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA (0xc013)
    Cipher Suite: TLS_RSA_WITH_AES_256_GCM_SHA384 (0x009d)
    Cipher Suite: TLS_RSA_WITH_AES_128_GCM_SHA256 (0x009c)
    Cipher Suite: TLS_RSA_WITH_AES_256_CBC_SHA256 (0x003d)
    Cipher Suite: TLS_RSA_WITH_AES_128_CBC_SHA256 (0x003c)
    Cipher Suite: TLS_RSA_WITH_AES_256_CBC_SHA (0x0035)
    Cipher Suite: TLS_RSA_WITH_AES_128_CBC_SHA (0x002f)
    Cipher Suite: TLS_RSA_WITH_3DES_EDE_CBC_SHA (0x000a)</code></pre><p>Compression: 客户端可以提交一个或多个支持压缩的方法。默认的压缩方法是 null，代表没有压缩</p><p>Extensions: 扩展（extension）块由任意数量的扩展组成。这些扩展会携带额外数据</p><h3 id="2-2-Server-hello"><a href="#2-2-Server-hello" class="headerlink" title="2.2 Server hello"></a>2.2 Server hello</h3><p>这条消息是服务器对client hello的响应。</p><p><img src="/2020/08/26/apple/1597635614246.png" alt="1597635614246"></p><p>这个消息的结构与 ClientHello 类似，只是每个字段只包含一个选项，其中包含服务端的 random_S 参数 (用于后续的密钥协商)。服务器无需支持客户端支持的最佳版本。如果服务器不支持与客户端相同的版本，可以提供某个其他版本以期待客户端能够接受。</p><p>图中的 <code>Cipher Suite</code> 是后续密钥协商和身份验证要用的加密套件TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256，此处选择的密钥交换与签名算法是 ECDHE_RSA，对称加密算法是 AES-128，后面会讲到这个</p><p>还有一点默认情况下 TLS 压缩都是关闭的，因为 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/CRIME">CRIME</a> 攻击会利用 TLS 压缩恢复加密认证 cookie，实现会话劫持，而且一般配置 gzip 等内容压缩后再压缩 TLS 分片效益不大又额外占用资源，所以一般都关闭 TLS 压缩</p><h3 id="2-3-Certificate"><a href="#2-3-Certificate" class="headerlink" title="2.3 Certificate"></a>2.3 Certificate</h3><p>典型的 Certificate 消息用于携带服务器 X.509 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%BF%A1%E4%BB%BB%E9%8F%88">证书链</a>。 服务器必须保证它发送的证书与选择的算法套件一致。</p><p><img src="/2020/08/26/apple/1597645649605.png" alt="1597645649605"></p><h4 id="2-3-1-证书内容"><a href="#2-3-1-证书内容" class="headerlink" title="2.3.1 证书内容"></a>2.3.1 证书内容</h4><p>注意证书链的顺序，最下层证书在前（用户证书在前，上级证书在后）。发送的证书是二进制格式，并非base64之后的格式。有个技巧，在wireshark右键<strong>“导出分组字节流”</strong>功能，然后保存证书,后缀为der，是可以变成一个正常证书的（二进制格式）。</p><img src="/2020/08/26/apple/1597648718865.png" alt="1597648718865" style="zoom:150%"><p>下面对证书内容进行分析：</p><p>图中从右到左分别是1级根证书为Google Trust Services，二级中间证书为GTS CA，三级证书为google-analytics；从上到下为每个证书中的详细信息。</p><p>首先需要特别说明证书中的重点内容是什么？</p><p>（1）版本：Version，V3。对应的是X.509 V3标准</p><p>（2）序列号：证书颁发者唯一序列号</p><p>（3）签名算法：<strong>注意！证书中的签名算法指的是上级证书运行的签名算法，生成数字签名的；而不是</strong></p><p><strong>本级证书拥有的签名算法。</strong>例如，3级证书中的签名算法为sha256RSA，应该与2级证书的公钥RSA是一致的。</p><p>（４）签名哈希算法：同样是上级证书签名时用的哈希算法。</p><p>（５）公钥及公钥参数:<strong>注意本即证书的公钥，该公钥不是用于验证2级证书生成的数字签名的.**该公钥是用于后面</strong>server key exchange的;具体用法如下:</p><p>(a)对于ECDHE和DHE密钥交换算法,服务器端需要server key exchange,发送用于DH的公钥Pb及对公钥的数字签名(防止公钥在通信过程被篡改),那服务器证书的公钥就是用来验证该签名的;</p><p>(b)对于不需要server key exchange的DH,ECDH密钥交换算法,服务器证书中的公钥就是DH密钥交换的Pb;</p><p>(c) 对于不需要server key exchange的RSA密钥交换算法:服务器证书中的公钥是用于加密第三个随机数预主密钥pre-master key的.</p><h4 id="2-3-2-证书验证过程"><a href="#2-3-2-证书验证过程" class="headerlink" title="2.3.2 证书验证过程"></a>2.3.2 证书验证过程</h4><p>证书链验证过程如下:(简易图)</p><p>首先利用一级证书中的RSA公钥验证二级证书,再用二级证书中的RSA公钥验证三级证书,即服务器证书;服务器证书中的ECC公钥,公钥参数ECDSA用于密钥交换,具体功能在2.3.1已阐述;</p><p><img src="/2020/08/26/apple/1597651071958.png" alt="1597651071958"></p><h3 id="2-4-第三个随机数的密钥协商"><a href="#2-4-第三个随机数的密钥协商" class="headerlink" title="2.4  第三个随机数的密钥协商"></a>2.4 第三个随机数的密钥协商</h3><p>不同的密码套件,也会有不一样的密钥协商算法具体1.3节已分析;该次交互选择的密码交互算法为ECDHE_ECDSA;</p><h4 id="2-4-1-Server-key-exchange"><a href="#2-4-1-Server-key-exchange" class="headerlink" title="2.4.1 Server key exchange"></a>2.4.1 Server key exchange</h4><p>从下面可以看到报文信息如下:</p><p>(1)公钥Pubkey:服务器端发送Pb(对应的私钥为b),以及DH用到的相关参数,比如选择的椭圆曲线等</p><p>(2)数字签名Signature:服务器利用私钥b运行ECDSA签名算法生成的数字签名,保证公钥来源的可靠性和完整性,客户端收到该签名后,用之前收到的服务器证书中的ECC公钥进行签名验证.</p><p><img src="/2020/08/26/apple/1597651555493.png" alt="1597651555493"></p><h4 id="2-4-2-Client-key-exchange"><a href="#2-4-2-Client-key-exchange" class="headerlink" title="2.4.2 Client key exchange"></a>2.4.2 Client key exchange</h4><p>客户端发送公钥Pa</p><p><img src="/2020/08/26/apple/1597652043883.png" alt="1597652043883"></p><p>然后双方根据Diffie-Hellman算法分别计算出pre-master key;具体计算过程在1.3已写.</p><h3 id="2-5-Finished-Encrypted-Handshake-Message"><a href="#2-5-Finished-Encrypted-Handshake-Message" class="headerlink" title="2.5 Finished (Encrypted Handshake Message)"></a>2.5 Finished (Encrypted Handshake Message)</h3><p>这个报文的目的就是告诉对端自己在整个握手过程中收到了什么数据，发送了什么数据。来保证中间没人篡改报文。客户端和服务器端都会分别发送.</p><p>其次，这个报文作用就是确认密钥的正确性。因为Encrypted handshake message是使用对称密钥进行加密的第一个报文，如果这个报文加解密校验成功，那么就说明对称密钥是正确的。</p><p>计算方法也比较简单，将之前<strong>所有</strong>的握手数据（包括接受、发送），计算md运算，然后计算prf，然后就是使用协商好的对称密钥进行加密了。 ( 从client hello开始，到目前准备发送“Encrypted handshake message”前，自己所有收到和发送的handshake类型的握手数据。 )</p><p><img src="/2020/08/26/apple/1597653653860.png" alt="1597653653860"></p><h3 id="2-6-密钥产生"><a href="#2-6-密钥产生" class="headerlink" title="2.6 密钥产生"></a>2.6 密钥产生</h3><p><img src="/2020/08/26/apple/1597652305214.png" alt="1597652305214"></p><p>如上图所示,此时客户端,服务器端都已经获取全部的计算协商密钥需要的信息: 两个明文随机数 CR 和 SR与自己计算产生的 Pre-master，然后得到主密钥master.为了保证信息的完整性和机密性，TSL需要有六个密钥：四个密钥和两个IV。为了信息的可信性，客户端需要一个密钥（HMAC），为了加密要有一个密钥，为了分组加密要一个IV，服务也是如此。</p><pre><code>master= PRF(Pre_master, &quot;master secret&quot;, CR + SR)</code></pre><h4 id="2-6-1-生成主密钥Master-key"><a href="#2-6-1-生成主密钥Master-key" class="headerlink" title="2.6.1 生成主密钥Master key"></a>2.6.1 生成主密钥Master key</h4><p>主密钥Master key的生成如下,图中的MD5算法是在密码套件中指定的;根据三个参数预备主密钥PM,服务器端随机数SR,客户端随机数CR,经过不断的迭代,最终生成48字节的主密钥master key.</p><p><img src="/2020/08/26/apple/1598427741876.png" alt="1598427741876"></p><h4 id="2-6-2-生成密钥材料"><a href="#2-6-2-生成密钥材料" class="headerlink" title="2.6.2 生成密钥材料"></a>2.6.2 生成密钥材料</h4><p>密钥材料需要以下6个,具体生成过程如下图所示.</p><p>(1)客户端MAC密钥 :Auth .Key</p><p>(2)服务器端MAC密钥 :Auth .Key</p><p>(3) 客户端加密密钥及IV:Enc.key</p><p>(4) 服务器端加密密钥及IV:Enc.key,IV</p><p>(5) 客户端分组密码需要的IV</p><p>(6) 服务器端分组密码需要的IV</p><p><img src="/2020/08/26/apple/1598427757814.png" alt="1598427757814"></p><p><img src="/2020/08/26/apple/1598427767706.png" alt="1598427767706"></p><h3 id="2-7-记录协议"><a href="#2-7-记录协议" class="headerlink" title="2.7  记录协议"></a>2.7 记录协议</h3><p>记录协议负责在传输连接上交换的所有底层消息，并且可以配置加密。每一条 TLS 记录以一个短标头开始。标头包含记录内容的类型 (或子协议)、协议版本和长度。原始消息经过分段 (或者合并)、压缩、添加认证码、加密转为 TLS 记录的数据部分。 如下图所示.对应用数据进行分段,对分段信息先压缩,在加上对压缩进行的MAC,然后对压缩信息+MAC进行加密,最后加记录头,形成报文,发送.</p><p><img src="/2020/08/26/apple/1597653267305.png" alt="1597653267305"></p><p>报文如下:</p><p><img src="/2020/08/26/apple/1597653406484.png" alt="1597653406484"></p><h2 id="3-https-安全性分析"><a href="#3-https-安全性分析" class="headerlink" title="3 https 安全性分析"></a>3 https 安全性分析</h2><h3 id="3-1-TLS版本的选择"><a href="#3-1-TLS版本的选择" class="headerlink" title="3.1 TLS版本的选择"></a>3.1 TLS版本的选择</h3><p>目前在SSL/TLS家族中主要有7个协议: SSL v2, SSL v3, TLS v1.0, TLS v1.1, TLS v1.2和TLSv1.3。</p><p>1 SSL v2, SSL v3, TLS v1.0 , TLS v1.1协议均有明确的安全缺陷</p><ol><li><p>SSL v2: DROWN攻击</p></li><li><p>SSL v3: POODLE攻击</p></li><li><p>TLS v1.0: BEAST和POODLE攻击</p></li><li><p>TLS v1.1 密码套件较老,已不安全</p></li></ol><p>2、TLS v1.2与v1.3目前均无已知的安全缺陷</p><p><strong>推荐使用TLS v1.2与v1.3.</strong></p><h3 id="3-2-密码套件的选择"><a href="#3-2-密码套件的选择" class="headerlink" title="3.2 密码套件的选择"></a>3.2 密码套件的选择</h3><p>从密码套件的各个部分去分析其安全性,具体如下:</p><p>(1)密钥交换：ECDHE，DHE，ECDH，DHE，ADH, RSA, PSK</p><p>其中RSA，ECDH，DH，PSK均不具有前向安全性，一旦私钥丢失，则以往所有的通信内容将会泄露，使用前向安全性算法（ECDHE，DHE），可以避免这种问题。</p><p>ADH为Anonymous DH，匿名DH算法，不提供身份验证，禁用。</p><p>PSK算法是预存key在客户端和服务端，因为PSK必须要预置密钥，这个预置的过程就代表了服务端已经知道有哪些客户端需要访问了，所以基于PSK的TLS适合在内部系统中使用，而不适合在公网环境用来提供Web服务。</p><p><strong>综上,推荐使用的密钥交换算法为:ECDHE，DHE</strong></p><p>(2)数字签名：ECDSA, RSA(2048位以上), DSS (又称DSA)</p><p>其中DSA只支持1024bits，不安全算法,RSA要2048位以上才安全.ECDSA速度较快,安全性也较高.</p><p><strong>推荐使用数字签名算法ECDSA和RSA.</strong></p><p>(3) 加密算法：<strong>DES，3DES ,**AES(256),ChaCha20</strong>,RC4, **ChaCha20</p><p>3DES运行缓慢且易被攻击。RC4已不安全</p><p>ChaCha20是一种流加密算法，实现较为简单，并且比纯软件实现的AES性能更好。</p><p>在支持AES指令的硬件平台上，推荐优先选择AES-GCM算法,不支持AES指令的硬件平台，ChaCha20性能优于AES</p><p>Camellia算法支持128比特的分组长度,128、192和256比特的密钥与AES的接口相同，Camellia算法128比特密钥的加、解密过程共有18轮,采用Feistel结构,加、解密过程完全相同,只是子密钥注入顺序相反</p><p>Camellia算法由NTT和Mitsubishi Electric Corporation于2000年联合开发，作为欧洲新一代的加密标准。与AES算法相比,Camellia算法在各种软硬件平台上表现出与之相当的加密速度。除了在各种软件和硬件平台上的高效性这一显著特点,它的另外一个特点是针对小规模硬件平台的设计.</p><p><strong>推荐使用AES(256),ChaCha20ChaCha20</strong></p><p>(4)<strong>工作模式：</strong>CBC，GCM</p><p>CBC 模式密码 —— 易受 BEAST 和 Lucky 13 攻击,禁用</p><p><strong>推荐使用:GCM</strong></p><p>(5)MAC：md5，SHA-1（又名SHA），SHA-2（又名SHA128，SHA256和SHA384）</p><p>​ SHA1存在碰攻击，如果HTTPS证书使用sha1，扩展存在中间人攻击； Md5也被破解</p><p><strong>推荐使用SHA256和SHA384</strong></p><h3 id="3-3-优先使用的密码套件"><a href="#3-3-优先使用的密码套件" class="headerlink" title="3.3 优先使用的密码套件"></a>3.3 优先使用的密码套件</h3><p>TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256<br>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384<br>TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256<br>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384<br>TLS_DHE_RSA_WITH_AES_128_GCM_SHA256<br>TLS_DHE_RSA_WITH_AES_256_GCM_SHA384</p><h2 id="REF"><a href="#REF" class="headerlink" title="REF:"></a>REF:</h2><p><a target="_blank" rel="noopener" href="https://cshihong.github.io/2019/05/09/SSL%E5%8D%8F%E8%AE%AE%E8%AF%A6%E8%A7%A3/">https://cshihong.github.io/2019/05/09/SSL%E5%8D%8F%E8%AE%AE%E8%AF%A6%E8%A7%A3/</a></p><p><a target="_blank" rel="noopener" href="https://juejin.im/post/6844903667577929742#heading-12">https://juejin.im/post/6844903667577929742#heading-12</a></p><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/cf8c2f2cd18a">https://www.jianshu.com/p/cf8c2f2cd18a</a></p><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zhuqil/archive/2012/10/06/ssl_detail.html">https://www.cnblogs.com/zhuqil/archive/2012/10/06/ssl_detail.html</a></p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/mrpre/article/details/77868570">https://blog.csdn.net/mrpre/article/details/77868570</a></p><link href="//src.wangriyu.wang/lib/Aplayer/APlayer.min.css" rel="stylesheet"><script src="//src.wangriyu.wang/lib/Aplayer/APlayer.min.js"></script><div id="aplayer"></div><script src="/js/player.js"></script></div><div class="article-info article-info-index"><div class="article-count"><div class="article-category tagcloud"><a class="article-category-link" href="/categories/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/">网络编程</a></div><div class="article-tag tagcloud"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/TLS/" rel="tag">TLS</a></li></ul></div><span class="post-count">总字数4.8k</span> <span class="post-count">预计阅读17分钟</span></div><div class="clearfix"></div></div></div></article><nav id="page-nav"><a class="extend prev" rel="prev" href="/page/2/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span></nav></div><footer id="footer"><div class="outer"><div id="footer-info"><div class="footer-left"><i class="fa fa-copyright"></i> 2017-2021 冀-18010769-1</div><div class="visit"><span id="busuanzi_container_site_pv" style="display:none"><span id="site-visit" title="本站到访人数"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span> </span></span><span>| </span><span id="busuanzi_container_page_pv" style="display:none"><span id="page-visit" title="本站总访问量"><i class="fa fa-eye" aria-hidden="true"></i><span id="busuanzi_value_site_pv"></span></span></span></div><div class="footer-right"><i class="fa fa-heart"></i><a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架"> Hexo</a> Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a></div></div></div></footer></div><script type="application/javascript">var leftWidth,hide=!1;$(".hide-left-col").click(function(){hide=hide?($(".left-col").css("width",leftWidth),$(".left-col .intrude-less").fadeIn(200),$("#tocButton").fadeIn(200),"block"===$("#switch-btn").css("display")&&"block"===$("#switch-area").css("display")||$("#toc").fadeIn(200),$(".hide-left-col").css("left",leftWidth).html('<i class="fa fa-angle-double-left"></i>'),$(".mid-col").css("left",leftWidth),$("#post-nav-button").css("left",leftWidth),$("#post-nav-button > a:nth-child(2)").css("display","block"),!1):(leftWidth=$(".left-col")[0].style.width,$(".left-col").css("width",0),$(".left-col .intrude-less").fadeOut(200),$("#toc").fadeOut(100),$("#tocButton").fadeOut(100),$(".hide-left-col").css("left",0).html('<i class="fa fa-angle-double-right"></i>'),$(".mid-col").css("left",0),$("#post-nav-button").css("left",0),$("#post-nav-button > a:nth-child(2)").css("display","none"),$(".post-list").is(":visible")&&($("#post-nav-button .fa-bars,#post-nav-button .fa-times").toggle(),$(".post-list").toggle()),!0)})</script><script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.3.5/require.min.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax:{inlineMath:[["$$","$$"],["$","$"],["\\(","\\)"]],processEscapes:!0,skipTags:["script","noscript","style","textarea","pre","code"]}}),MathJax.Hub.Queue(function(){var a,e=MathJax.Hub.getAllJax();for(a=0;a<e.length;a+=1)e[a].SourceElement().parentNode.className+=" has-jax"})</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" async></script><div class="scroll" id="scroll"><a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a> <a href="#comments" title="查看评论"><i class="fa fa-comments-o"></i></a> <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a></div><script>var oOpenInNew={post:".copyright a[href]",friends:"#js-friends a",socail:".social a"};for(var x in oOpenInNew)$(oOpenInNew[x]).attr("target","_blank")</script><script>var titleTime,originTitle=document.title;document.addEventListener("visibilitychange",function(){document.hidden?(document.title="(つェ⊂)"+originTitle,clearTimeout(titleTime)):(document.title="(*´∇｀*)~ "+originTitle,titleTime=setTimeout(function(){document.title=originTitle},2e3))})</script><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><link href="//cdn.bootcss.com/aos/2.2.0/aos.css" rel="stylesheet"><script type="text/javascript">AOS.init({easing:"ease-out-back",once:!0})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"live2d_models/live2d-widget-model-izumi"},"display":{"position":"right","width":100,"height":200,"hOffset":-50,"vOffset":-85},"mobile":{"show":false},"react":{"opacityDefault":0.9,"opacityOnHover":0.3},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false});</script></body></html>